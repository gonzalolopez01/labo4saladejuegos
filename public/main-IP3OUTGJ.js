import{$ as od,A as oa,B as Xh,C as Zh,D as aa,E as Wt,F as Gi,G as bt,H as ca,I as ed,J as ce,K as ee,L as ua,M as zi,N as wn,O as Tn,P as td,Q as We,R as nd,S as la,T as M,U as F,V as fe,W as rd,X as id,Y as sd,Z as ot,_ as An,a as Pe,aa as G,b as Oe,ba as ad,c as Tt,ca as Wi,d as y,da as bn,e as kr,ea as Sn,f as Wh,fa as Cn,g as Hh,ga as Hi,h as Kh,ha as He,i as Qh,ia as cd,j as ea,ja as ha,k as ta,ka as ud,l as na,la as ld,m as ra,ma as hd,n as Nr,na as dd,o as Jh,oa as da,p as Yh,pa as Ki,q as ji,qa as Ht,r as zt,ra as fa,s as ia,sa as fd,t as Me,ta as Qi,u as $i,ua as pd,v as Fe,va as md,w as ze,wa as Ji,x as sa,xa as St,y as At,ya as gd,z as En,za as _d}from"./chunk-FAFMBXJZ.js";var vd=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},t_=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Id={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,I=(o&3)<<4|u>>4,S=(u&15)<<2|d>>6,R=d&63;h||(R=64,a||(S=64)),r.push(t[p],t[I],t[S],t[R])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(vd(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):t_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let I=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||I==null)throw new ma;let S=o<<2|u>>4;if(r.push(S),d!==64){let R=u<<4&240|d>>2;if(r.push(R),I!==64){let N=d<<6&192|I;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},ma=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},n_=function(n){let e=vd(n);return Id.encodeByteArray(e,!0)},Vr=function(n){return n_(n).replace(/\./g,"")},_a=function(n){try{return Id.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function r_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var i_=()=>r_().__FIREBASE_DEFAULTS__,s_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},o_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&_a(n[1]);return e&&JSON.parse(e)},Xi=()=>{try{return i_()||s_()||o_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ya=n=>{var e,t;return(t=(e=Xi())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Ed=n=>{let e=ya(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},va=()=>{var n;return(n=Xi())===null||n===void 0?void 0:n.config},Ia=n=>{var e;return(e=Xi())===null||e===void 0?void 0:e[`_${n}`]};var Yi=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function wd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Vr(JSON.stringify(t)),Vr(JSON.stringify(a)),""].join(".")}function pe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Td(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pe())}function a_(){var n;let e=(n=Xi())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Ad(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function bd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Sd(){let n=pe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Cd(){return!a_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ea(){try{return typeof indexedDB=="object"}catch{return!1}}function Rd(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var c_="FirebaseError",ke=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=c_,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,at.prototype.create)}},at=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?u_(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new ke(i,u,r)}};function u_(n,e){return n.replace(l_,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var l_=/\{\$([^}]+)}/g;function Pd(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Kt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(yd(o)&&yd(a)){if(!Kt(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function yd(n){return n!==null&&typeof n=="object"}function xr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Rn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Pn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Dd(n,e){let t=new ga(n,e);return t.subscribe.bind(t)}var ga=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");h_(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=pa),i.error===void 0&&(i.error=pa),i.complete===void 0&&(i.complete=pa);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function h_(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function pa(){}var qT=4*60*60*1e3;function _e(n){return n&&n._delegate?n._delegate:n}var Le=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Qt="[DEFAULT]";var wa=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Yi;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(f_(e))try{this.getOrInitializeService({instanceIdentifier:Qt})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Qt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Qt){return this.instances.has(e)}getOptions(e=Qt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:d_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Qt){return this.component?this.component.multipleInstances?e:Qt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function d_(n){return n===Qt?void 0:n}function f_(n){return n.instantiationMode==="EAGER"}var Zi=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new wa(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var p_=[],z=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(z||{}),m_={debug:z.DEBUG,verbose:z.VERBOSE,info:z.INFO,warn:z.WARN,error:z.ERROR,silent:z.SILENT},g_=z.INFO,__={[z.DEBUG]:"log",[z.VERBOSE]:"log",[z.INFO]:"info",[z.WARN]:"warn",[z.ERROR]:"error"},y_=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=__[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ct=class{constructor(e){this.name=e,this._logLevel=g_,this._logHandler=y_,this._userLogHandler=null,p_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in z))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?m_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,z.DEBUG,...e),this._logHandler(this,z.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,z.VERBOSE,...e),this._logHandler(this,z.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,z.INFO,...e),this._logHandler(this,z.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,z.WARN,...e),this._logHandler(this,z.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,z.ERROR,...e),this._logHandler(this,z.ERROR,...e)}};var v_=(n,e)=>e.some(t=>n instanceof t),kd,Nd;function I_(){return kd||(kd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function E_(){return Nd||(Nd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Vd=new WeakMap,Aa=new WeakMap,xd=new WeakMap,Ta=new WeakMap,Sa=new WeakMap;function w_(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(Ke(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Vd.set(t,n)}).catch(()=>{}),Sa.set(e,n),e}function T_(n){if(Aa.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Aa.set(n,e)}var ba={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Aa.get(n);if(e==="objectStoreNames")return n.objectStoreNames||xd.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ke(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Od(n){ba=n(ba)}function A_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(es(this),e,...t);return xd.set(r,e.sort?e.sort():[e]),Ke(r)}:E_().includes(n)?function(...e){return n.apply(es(this),e),Ke(Vd.get(this))}:function(...e){return Ke(n.apply(es(this),e))}}function b_(n){return typeof n=="function"?A_(n):(n instanceof IDBTransaction&&T_(n),v_(n,I_())?new Proxy(n,ba):n)}function Ke(n){if(n instanceof IDBRequest)return w_(n);if(Ta.has(n))return Ta.get(n);let e=b_(n);return e!==n&&(Ta.set(n,e),Sa.set(e,n)),e}var es=n=>Sa.get(n);function Fd(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=Ke(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Ke(a.result),h.oldVersion,h.newVersion,Ke(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var S_=["get","getKey","getAll","getAllKeys","count"],C_=["put","add","delete","clear"],Ca=new Map;function Md(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ca.get(e))return Ca.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=C_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||S_.includes(t)))return;let o=function(a,...u){return y(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return Ca.set(e,o),o}Od(n=>Oe(Pe({},n),{get:(e,t,r)=>Md(e,t)||n.get(e,t,r),has:(e,t)=>!!Md(e,t)||n.has(e,t)}));var Pa=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(R_(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function R_(n){let e=n.getComponent();return e?.type==="VERSION"}var Da="@firebase/app",Ld="0.10.10";var ct=new Ct("@firebase/app"),P_="@firebase/app-compat",D_="@firebase/analytics-compat",k_="@firebase/analytics",N_="@firebase/app-check-compat",V_="@firebase/app-check",x_="@firebase/auth",O_="@firebase/auth-compat",M_="@firebase/database",F_="@firebase/database-compat",L_="@firebase/functions",U_="@firebase/functions-compat",B_="@firebase/installations",q_="@firebase/installations-compat",j_="@firebase/messaging",$_="@firebase/messaging-compat",G_="@firebase/performance",z_="@firebase/performance-compat",W_="@firebase/remote-config",H_="@firebase/remote-config-compat",K_="@firebase/storage",Q_="@firebase/storage-compat",J_="@firebase/firestore",Y_="@firebase/vertexai-preview",X_="@firebase/firestore-compat",Z_="firebase",ey="10.13.1";var ka="[DEFAULT]",ty={[Da]:"fire-core",[P_]:"fire-core-compat",[k_]:"fire-analytics",[D_]:"fire-analytics-compat",[V_]:"fire-app-check",[N_]:"fire-app-check-compat",[x_]:"fire-auth",[O_]:"fire-auth-compat",[M_]:"fire-rtdb",[F_]:"fire-rtdb-compat",[L_]:"fire-fn",[U_]:"fire-fn-compat",[B_]:"fire-iid",[q_]:"fire-iid-compat",[j_]:"fire-fcm",[$_]:"fire-fcm-compat",[G_]:"fire-perf",[z_]:"fire-perf-compat",[W_]:"fire-rc",[H_]:"fire-rc-compat",[K_]:"fire-gcs",[Q_]:"fire-gcs-compat",[J_]:"fire-fst",[X_]:"fire-fst-compat",[Y_]:"fire-vertex","fire-js":"fire-js",[Z_]:"fire-js-all"};var Or=new Map,ny=new Map,Na=new Map;function Ud(n,e){try{n.container.addComponent(e)}catch(t){ct.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Pt(n){let e=n.name;if(Na.has(e))return ct.debug(`There were multiple attempts to register component ${e}.`),!1;Na.set(e,n);for(let t of Or.values())Ud(t,n);for(let t of ny.values())Ud(t,n);return!0}function Fr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Be(n){return n.settings!==void 0}var ry={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rt=new at("app","Firebase",ry);var Va=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Le("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rt.create("app-deleted",{appName:this._name})}};var Dt=ey;function Ma(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:ka,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Rt.create("bad-app-name",{appName:String(i)});if(t||(t=va()),!t)throw Rt.create("no-options");let o=Or.get(i);if(o){if(Kt(t,o.options)&&Kt(r,o.config))return o;throw Rt.create("duplicate-app",{appName:i})}let a=new Zi(i);for(let h of Na.values())a.addComponent(h);let u=new Va(t,r,a);return Or.set(i,u),u}function Dn(n=ka){let e=Or.get(n);if(!e&&n===ka&&va())return Ma();if(!e)throw Rt.create("no-app",{appName:n});return e}function ts(){return Array.from(Or.values())}function de(n,e,t){var r;let i=(r=ty[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ct.warn(u.join(" "));return}Pt(new Le(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var iy="firebase-heartbeat-database",sy=1,Mr="firebase-heartbeat-store",Ra=null;function $d(){return Ra||(Ra=Fd(iy,sy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Mr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Rt.create("idb-open",{originalErrorMessage:n.message})})),Ra}function oy(n){return y(this,null,function*(){try{let t=(yield $d()).transaction(Mr),r=yield t.objectStore(Mr).get(Gd(n));return yield t.done,r}catch(e){if(e instanceof ke)ct.warn(e.message);else{let t=Rt.create("idb-get",{originalErrorMessage:e?.message});ct.warn(t.message)}}})}function Bd(n,e){return y(this,null,function*(){try{let r=(yield $d()).transaction(Mr,"readwrite");yield r.objectStore(Mr).put(e,Gd(n)),yield r.done}catch(t){if(t instanceof ke)ct.warn(t.message);else{let r=Rt.create("idb-set",{originalErrorMessage:t?.message});ct.warn(r.message)}}})}function Gd(n){return`${n.name}!${n.options.appId}`}var ay=1024,cy=30*24*60*60*1e3,xa=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Oa(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=qd();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=cy}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ct.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=qd(),{heartbeatsToSend:r,unsentEntries:i}=uy(this._heartbeatsCache.heartbeats),o=Vr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ct.warn(t),""}})}};function qd(){return new Date().toISOString().substring(0,10)}function uy(n,e=ay){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),jd(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),jd(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Oa=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return Ea()?Rd().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield oy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Bd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Bd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function jd(n){return Vr(JSON.stringify({version:2,heartbeats:n})).length}function ly(n){Pt(new Le("platform-logger",e=>new Pa(e),"PRIVATE")),Pt(new Le("heartbeat",e=>new xa(e),"PRIVATE")),de(Da,Ld,n),de(Da,Ld,"esm2017"),de("fire-js","")}ly("");var hy="firebase",dy="10.13.1";de(hy,dy,"app");var Yt=new ha("ANGULARFIRE2_VERSION");function rs(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Lr=(n,e)=>{let t=e?[e]:ts(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Nn=class{constructor(){return Lr(fy)}},fy="app-check";function kn(){}var ns=class{zone;delegate;constructor(e,t=Qh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(o,t,r)}},Fa=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",kn,{},kn,kn)),t.pipe(Yh({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Vn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new ns(Zone.current)),this.insideAngular=t.run(()=>new ns(Zone.current,Kh)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)($i(bt))};static \u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function is(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function py(n){return is().ngZone.runOutsideAngular(()=>n())}function Jt(n){return is().ngZone.run(()=>n())}function my(n){return gy(is())(n)}function gy(n){return function(t){return t=t.lift(new Fa(n.ngZone)),t.pipe(na(n.outsideAngular),ta(n.insideAngular))}}var _y=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Jt(()=>n.apply(void 0,r))},Ne=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=Jt(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",kn,{},kn,kn))),r[o]=_y(r[o],t));let i=py(()=>n.apply(this,r));if(!e)if(i instanceof kr){let o=is();return i.pipe(na(o.outsideAngular),ta(o.insideAngular))}else return Jt(()=>i);return i instanceof kr?i.pipe(my):i instanceof Promise?Jt(()=>new Promise((o,a)=>i.then(u=>Jt(()=>o(u)),u=>Jt(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Jt(()=>i)};var ut=class{constructor(e){return e}},Xt=class{constructor(){return ts()}};function yy(n){return n&&n.length===1?n[0]:new ut(Dn())}var La=new Me("angularfire2._apps"),vy={provide:ut,useFactory:yy,deps:[[new Fe,La]]},Iy={provide:Xt,deps:[[new Fe,La]]};function Ey(n){return(e,t)=>{let r=t.get(ed);de("angularfire",Yt.full,"core"),de("angularfire",Yt.full,"app"),de("angular",ud.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new ut(i)}}function zd(n,...e){return En([vy,Iy,{provide:La,useFactory:Ey(n),multi:!0,deps:[bt,Wt,Vn,...e]}])}var Wd=Ne(Ma,!0);function lf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var hf=lf,df=new at("auth","Firebase",lf());var ls=new Ct("@firebase/auth");function wy(n,...e){ls.logLevel<=z.WARN&&ls.warn(`Auth (${Dt}): ${n}`,...e)}function os(n,...e){ls.logLevel<=z.ERROR&&ls.error(`Auth (${Dt}): ${n}`,...e)}function Je(n,...e){throw ac(n,...e)}function Zt(n,...e){return ac(n,...e)}function ff(n,e,t){let r=Object.assign(Object.assign({},hf()),{[e]:t});return new at("auth","Firebase",r).create(e,{appName:n.name})}function dt(n){return ff(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ac(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return df.create(n,...e)}function U(n,e,...t){if(!n)throw ac(e,...t)}function lt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw os(e),new Error(e)}function Vt(n,e){n||lt(e)}function ja(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Ty(){return Hd()==="http:"||Hd()==="https:"}function Hd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Ay(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ty()||Ad()||"connection"in navigator)?navigator.onLine:!0}function by(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var en=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vt(t>e,"Short delay should be less than long delay!"),this.isMobile=Td()||bd()}get(){return Ay()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function cc(n,e){Vt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var hs=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;lt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;lt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;lt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Sy={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Cy=new en(3e4,6e4);function xt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Ot(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){return pf(n,i,()=>y(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let I=xr(Object.assign({key:n.config.apiKey},p)).slice(1),S=yield n._getAdditionalHeaders();return S["Content-Type"]="application/json",n.languageCode&&(S["X-Firebase-Locale"]=n.languageCode),hs.fetch()(mf(n,n.config.apiHost,t,I),Object.assign({method:e,headers:S,referrerPolicy:"no-referrer"},d))}))})}function pf(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},Sy),e);try{let i=new $a(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw ss(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw ss(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw ss(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw ss(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw ff(n,p,d);Je(n,p)}}catch(i){if(i instanceof ke)throw i;Je(n,"network-request-failed",{message:String(i)})}})}function Wr(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield Ot(n,e,t,r,i);return"mfaPendingCredential"in d&&Je(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function mf(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?cc(n.config,i):`${n.config.apiScheme}://${i}`}function Ry(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var $a=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Zt(this.auth,"network-request-failed")),Cy.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function ss(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Zt(n,e,r);return i.customData._tokenResponse=t,i}function Kd(n){return n!==void 0&&n.enterprise!==void 0}var Ga=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ry(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function Py(n,e){return y(this,null,function*(){return Ot(n,"GET","/v2/recaptchaConfig",xt(n,e))})}function Dy(n,e){return y(this,null,function*(){return Ot(n,"POST","/v1/accounts:delete",e)})}function gf(n,e){return y(this,null,function*(){return Ot(n,"POST","/v1/accounts:lookup",e)})}function Ur(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function uc(n,e=!1){return y(this,null,function*(){let t=_e(n),r=yield t.getIdToken(e),i=lc(r);U(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:Ur(Ua(i.auth_time)),issuedAtTime:Ur(Ua(i.iat)),expirationTime:Ur(Ua(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function Ua(n){return Number(n)*1e3}function lc(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return os("JWT malformed, contained fewer than 3 sections"),null;try{let i=_a(t);return i?JSON.parse(i):(os("Failed to decode base64 JWT payload"),null)}catch(i){return os("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Qd(n){let e=lc(n);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function qr(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof ke&&ky(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function ky({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var za=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var jr=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ur(this.lastLoginAt),this.creationTime=Ur(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function ds(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield qr(n,gf(t,{idToken:r}));U(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?_f(o.providerUserInfo):[],u=Ny(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,p=h?d:!1,I={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new jr(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,I)})}function hc(n){return y(this,null,function*(){let e=_e(n);yield ds(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Ny(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function _f(n){return n.map(e=>{var{providerId:t}=e,r=ea(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Vy(n,e){return y(this,null,function*(){let t=yield pf(n,{},()=>y(this,null,function*(){let r=xr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=mf(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",hs.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function xy(n,e){return y(this,null,function*(){return Ot(n,"POST","/v2/accounts:revokeToken",xt(n,e))})}var Br=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(e.length!==0,"internal-error");let t=Qd(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield Vy(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(U(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(U(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return lt("not implemented")}};function Nt(n,e){U(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var xn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=ea(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new za(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new jr(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield qr(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return uc(this,e)}reload(){return hc(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield ds(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(Be(this.auth.app))return Promise.reject(dt(this.auth));let e=yield this.getIdToken();return yield qr(this,Dy(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,p;let I=(r=t.displayName)!==null&&r!==void 0?r:void 0,S=(i=t.email)!==null&&i!==void 0?i:void 0,R=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,N=(a=t.photoURL)!==null&&a!==void 0?a:void 0,O=(u=t.tenantId)!==null&&u!==void 0?u:void 0,k=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,$=(d=t.createdAt)!==null&&d!==void 0?d:void 0,H=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:K,emailVerified:ne,isAnonymous:Se,providerData:X,stsTokenManager:E}=t;U(K&&E,e,"internal-error");let m=Br.fromJSON(this.name,E);U(typeof K=="string",e,"internal-error"),Nt(I,e.name),Nt(S,e.name),U(typeof ne=="boolean",e,"internal-error"),U(typeof Se=="boolean",e,"internal-error"),Nt(R,e.name),Nt(N,e.name),Nt(O,e.name),Nt(k,e.name),Nt($,e.name),Nt(H,e.name);let _=new n({uid:K,auth:e,email:S,emailVerified:ne,displayName:I,isAnonymous:Se,photoURL:N,phoneNumber:R,tenantId:O,stsTokenManager:m,createdAt:$,lastLoginAt:H});return X&&Array.isArray(X)&&(_.providerData=X.map(v=>Object.assign({},v))),k&&(_._redirectEventId=k),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new Br;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield ds(o),o})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];U(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?_f(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new Br;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new jr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var Jd=new Map;function ht(n){Vt(n instanceof Function,"Expected a class definition");let e=Jd.get(n);return e?(Vt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Jd.set(n,e),e)}var Oy=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Wa=Oy;function as(n,e,t){return`firebase:${n}:${e}:${t}`}var fs=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=as(this.userKey,i.apiKey,o),this.fullPersistenceKey=as("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?xn._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(ht(Wa),e,r);let i=(yield Promise.all(t.map(d=>y(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||ht(Wa),a=as(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let I=xn._fromJSON(e,p);d!==o&&(u=I),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(d=>y(this,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function Yd(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ef(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Tf(e))return"Blackberry";if(Af(e))return"Webos";if(vf(e))return"Safari";if((e.includes("chrome/")||If(e))&&!e.includes("edge/"))return"Chrome";if(wf(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function yf(n=pe()){return/firefox\//i.test(n)}function vf(n=pe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function If(n=pe()){return/crios\//i.test(n)}function Ef(n=pe()){return/iemobile/i.test(n)}function wf(n=pe()){return/android/i.test(n)}function Tf(n=pe()){return/blackberry/i.test(n)}function Af(n=pe()){return/webos/i.test(n)}function dc(n=pe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function My(n=pe()){var e;return dc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Fy(){return Sd()&&document.documentMode===10}function bf(n=pe()){return dc(n)||wf(n)||Af(n)||Tf(n)||/windows phone/i.test(n)||Ef(n)}function Sf(n,e=[]){let t;switch(n){case"Browser":t=Yd(pe());break;case"Worker":t=`${Yd(pe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Dt}/${r}`}var Ha=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function Ly(t){return y(this,arguments,function*(n,e={}){return Ot(n,"GET","/v2/passwordPolicy",xt(n,e))})}var Uy=6,Ka=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:Uy,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var Qa=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ps(this),this.idTokenSubscription=new ps(this),this.beforeStateQueue=new Ha(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=df,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ht(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield fs.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield gf(this,{idToken:e}),r=yield xn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(Be(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield ds(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=by()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(Be(this.app))return Promise.reject(dt(this));let t=e?_e(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return Be(this.app)?Promise.reject(dt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Be(this.app)?Promise.reject(dt(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(ht(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield Ly(this),t=new Ka(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new at("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield xy(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&ht(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=yield fs.create(this,[ht(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Sf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&wy(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function nn(n){return _e(n)}var ps=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Dd(t=>this.observer=t)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Es={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function By(n){Es=n}function Cf(n){return Es.loadJS(n)}function qy(){return Es.recaptchaEnterpriseScript}function jy(){return Es.gapiScript}function Rf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var $y="recaptcha-enterprise",Gy="NO_RECAPTCHA",Ja=class{constructor(e){this.type=$y,this.auth=nn(e)}verify(e="verify",t=!1){return y(this,null,function*(){function r(o){return y(this,null,function*(){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise((a,u)=>y(this,null,function*(){Py(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new Ga(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,a(d.siteKey)}}).catch(h=>{u(h)})}))})}function i(o,a,u){let h=window.grecaptcha;Kd(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{a(d)}).catch(()=>{a(Gy)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,a)=>{r(this.auth).then(u=>{if(!t&&Kd(window.grecaptcha))i(u,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=qy();h.length!==0&&(h+=u),Cf(h).then(()=>{i(u,o,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})})}};function Xd(n,e,t,r=!1){return y(this,null,function*(){let i=new Ja(n),o;try{o=yield i.verify(t)}catch{o=yield i.verify(t,!0)}let a=Object.assign({},e);return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function Ya(n,e,t,r){return y(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let o=yield Xd(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(o=>y(this,null,function*(){if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=yield Xd(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(o)}))})}function fc(n,e){let t=Fr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(Kt(o,e??{}))return i;Je(i,"already-initialized")}return t.initialize({options:e})}function zy(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(ht);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function pc(n,e,t){let r=nn(n);U(r._canInitEmulator,r,"emulator-config-failed"),U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=Pf(e),{host:a,port:u}=Wy(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${o}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||Hy()}function Pf(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Wy(n){let e=Pf(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:Zd(r.substr(o.length+1))}}else{let[o,a]=r.split(":");return{host:o,port:Zd(a)}}}function Zd(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Hy(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var $r=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return lt("not implemented")}_getIdTokenResponse(e){return lt("not implemented")}_linkToIdToken(e,t){return lt("not implemented")}_getReauthenticationResolver(e){return lt("not implemented")}};function Ky(n,e){return y(this,null,function*(){return Ot(n,"POST","/v1/accounts:signUp",e)})}function Qy(n,e){return y(this,null,function*(){return Wr(n,"POST","/v1/accounts:signInWithPassword",xt(n,e))})}function Jy(n,e){return y(this,null,function*(){return Wr(n,"POST","/v1/accounts:signInWithEmailLink",xt(n,e))})}function Yy(n,e){return y(this,null,function*(){return Wr(n,"POST","/v1/accounts:signInWithEmailLink",xt(n,e))})}var Gr=class n extends $r{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ya(e,t,"signInWithPassword",Qy);case"emailLink":return Jy(e,{email:this._email,oobCode:this._password});default:Je(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ya(e,r,"signUpPassword",Ky);case"emailLink":return Yy(e,{idToken:t,email:this._email,oobCode:this._password});default:Je(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ba(n,e){return y(this,null,function*(){return Wr(n,"POST","/v1/accounts:signInWithIdp",xt(n,e))})}function Xy(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Zy(n){let e=Rn(Pn(n)).link,t=e?Rn(Pn(e)).deep_link_id:null,r=Rn(Pn(n)).deep_link_id;return(r?Rn(Pn(r)).link:null)||r||t||e||n}var ms=class n{constructor(e){var t,r,i,o,a,u;let h=Rn(Pn(e)),d=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,I=Xy((i=h.mode)!==null&&i!==void 0?i:null);U(d&&p&&I,"argument-error"),this.apiKey=d,this.operation=I,this.code=p,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=Zy(e);try{return new n(t)}catch{return null}}};var Df=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Gr._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=ms.parseLink(r);return U(i,"argument-error"),Gr._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),gs=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Xa=class extends gs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function ev(n,e){return y(this,null,function*(){return Wr(n,"POST","/v1/accounts:signUp",xt(n,e))})}var On=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let o=yield xn._fromIdTokenResponse(e,r,i),a=ef(r);return new n({user:o,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=ef(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function ef(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Za=class n extends ke{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function kf(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Za._fromErrorAndOperation(n,o,e,r):o})}function tv(n,e,t=!1){return y(this,null,function*(){let r=yield qr(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return On._forOperation(n,"link",r)})}function nv(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(Be(r.app))return Promise.reject(dt(r));let i="reauthenticate";try{let o=yield qr(n,kf(r,i,e,n),t);U(o.idToken,r,"internal-error");let a=lc(o.idToken);U(a,r,"internal-error");let{sub:u}=a;return U(n.uid===u,r,"user-mismatch"),On._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Je(r,"user-mismatch"),o}})}function Nf(n,e,t=!1){return y(this,null,function*(){if(Be(n.app))return Promise.reject(dt(n));let r="signIn",i=yield kf(n,r,e),o=yield On._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function mc(n,e){return y(this,null,function*(){return Nf(nn(n),e)})}function Vf(n){return y(this,null,function*(){let e=nn(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function gc(n,e,t){return y(this,null,function*(){if(Be(n.app))return Promise.reject(dt(n));let r=nn(n),a=yield Ya(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ev).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&Vf(n),h}),u=yield On._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(u.user),u})}function _c(n,e,t){return Be(n.app)?Promise.reject(dt(n)):mc(_e(n),Df.credential(e,t)).catch(r=>y(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Vf(n),r}))}function yc(n,e,t,r){return _e(n).onIdTokenChanged(e,t,r)}function vc(n,e,t){return _e(n).beforeAuthStateChanged(e,t)}function Ic(n){return _e(n).signOut()}var _s="__sak";var ys=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(_s,"1"),this.storage.removeItem(_s),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var rv=1e3,iv=10,sv=(()=>{class n extends ys{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=bf(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);Fy()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,iv):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},rv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Tt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Tt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Tt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),xf=sv;var ov=(()=>{class n extends ys{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Ec=ov;function av(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var cv=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:o,data:a}=r.data,u=this.handlersMap[o];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let h=Array.from(u).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield av(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Of(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var ec=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,h)=>{let d=Of("",20);i.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(I){let S=I;if(S.data.eventId===d)switch(S.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(S.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function Qe(){return window}function uv(n){Qe().location.href=n}function Mf(){return typeof Qe().WorkerGlobalScope<"u"&&typeof Qe().importScripts=="function"}function lv(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function hv(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function dv(){return Mf()?self:null}var Ff="firebaseLocalStorageDb",fv=1,vs="firebaseLocalStorage",Lf="fbase_key",tn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function ws(n,e){return n.transaction([vs],e?"readwrite":"readonly").objectStore(vs)}function pv(){let n=indexedDB.deleteDatabase(Ff);return new tn(n).toPromise()}function tc(){let n=indexedDB.open(Ff,fv);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(vs,{keyPath:Lf})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(vs)?e(r):(r.close(),yield pv(),e(yield tc()))}))})}function tf(n,e,t){return y(this,null,function*(){let r=ws(n,!0).put({[Lf]:e,value:t});return new tn(r).toPromise()})}function mv(n,e){return y(this,null,function*(){let t=ws(n,!1).get(e),r=yield new tn(t).toPromise();return r===void 0?null:r.value})}function nf(n,e){let t=ws(n,!0).delete(e);return new tn(t).toPromise()}var gv=800,_v=3,yv=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield tc(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>_v)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return Mf()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=cv._getInstance(dv()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield lv(),!this.activeServiceWorker)return;this.sender=new ec(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||hv()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield tc();return yield tf(t,_s,"1"),yield nf(t,_s),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>tf(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>mv(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>nf(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(o=>{let a=ws(o,!1).getAll();return new tn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:a}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),gv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Uf=yv;var x0=Rf("rcb"),O0=new en(3e4,6e4);function vv(n,e){return e?ht(e):(U(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var zr=class extends $r{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ba(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ba(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ba(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Iv(n){return Nf(n.auth,new zr(n),n.bypassAuthState)}function Ev(n){let{auth:e,user:t}=n;return U(t,e,"internal-error"),nv(t,new zr(n),n.bypassAuthState)}function wv(n){return y(this,null,function*(){let{auth:e,user:t}=n;return U(t,e,"internal-error"),tv(t,new zr(n),n.bypassAuthState)})}var nc=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Iv;case"linkViaPopup":case"linkViaRedirect":return wv;case"reauthViaPopup":case"reauthViaRedirect":return Ev;default:Je(this.auth,"internal-error")}}resolve(e){Vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var M0=new en(2e3,1e4);var Tv="pendingRedirect",cs=new Map,rc=class n extends nc{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=cs.get(this.auth._key());if(!e){try{let r=(yield Av(this.resolver,this.auth))?yield Tt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}cs.set(this.auth._key(),e)}return this.bypassAuthState||cs.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Tt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Tt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function Av(n,e){return y(this,null,function*(){let t=Cv(e),r=Sv(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function bv(n,e){cs.set(n._key(),e)}function Sv(n){return ht(n._redirectPersistence)}function Cv(n){return as(Tv,n.config.apiKey,n.name)}function Rv(n,e,t=!1){return y(this,null,function*(){if(Be(n.app))return Promise.reject(dt(n));let r=nn(n),i=vv(r,e),a=yield new rc(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var Pv=10*60*1e3,ic=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Dv(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Bf(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Zt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Pv&&this.cachedEventUids.clear(),this.cachedEventUids.has(rf(e))}saveEventToCache(e){this.cachedEventUids.add(rf(e)),this.lastProcessedEventTime=Date.now()}};function rf(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Bf({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Dv(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Bf(n);default:return!1}}function kv(t){return y(this,arguments,function*(n,e={}){return Ot(n,"GET","/v1/projects",e)})}var Nv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Vv=/^https?/;function xv(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield kv(n);for(let t of e)try{if(Ov(t))return}catch{}Je(n,"unauthorized-domain")})}function Ov(n){let e=ja(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!Vv.test(t))return!1;if(Nv.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Mv=new en(3e4,6e4);function sf(){let n=Qe().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Fv(n){return new Promise((e,t)=>{var r,i,o;function a(){sf(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sf(),t(Zt(n,"network-request-failed"))},timeout:Mv.get()})}if(!((i=(r=Qe().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=Qe().gapi)===null||o===void 0)&&o.load)a();else{let u=Rf("iframefcb");return Qe()[u]=()=>{gapi.load?a():t(Zt(n,"network-request-failed"))},Cf(`${jy()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw us=null,e})}var us=null;function Lv(n){return us=us||Fv(n),us}var Uv=new en(5e3,15e3),Bv="__/auth/iframe",qv="emulator/auth/iframe",jv={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$v=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Gv(n){let e=n.config;U(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?cc(e,qv):`https://${n.config.authDomain}/${Bv}`,r={apiKey:e.apiKey,appName:n.name,v:Dt},i=$v.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${xr(r).slice(1)}`}function zv(n){return y(this,null,function*(){let e=yield Lv(n),t=Qe().gapi;return U(t,n,"internal-error"),e.open({where:document.body,url:Gv(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jv,dontclear:!0},r=>new Promise((i,o)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=Zt(n,"network-request-failed"),u=Qe().setTimeout(()=>{o(a)},Uv.get());function h(){Qe().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(a)})})))})}var Wv={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Hv=500,Kv=600,Qv="_blank",Jv="http://localhost",Is=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Yv(n,e,t,r=Hv,i=Kv){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",h=Object.assign(Object.assign({},Wv),{width:r.toString(),height:i.toString(),top:o,left:a}),d=pe().toLowerCase();t&&(u=If(d)?Qv:t),yf(d)&&(e=e||Jv,h.scrollbars="yes");let p=Object.entries(h).reduce((S,[R,N])=>`${S}${R}=${N},`,"");if(My(d)&&u!=="_self")return Xv(e||"",u),new Is(null);let I=window.open(e||"",u,p);U(I,n,"popup-blocked");try{I.focus()}catch{}return new Is(I)}function Xv(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var Zv="__/auth/handler",eI="emulator/auth/handler",tI=encodeURIComponent("fac");function of(n,e,t,r,i,o){return y(this,null,function*(){U(n.config.authDomain,n,"auth-domain-config-required"),U(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Dt,eventId:i};if(e instanceof gs){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Pd(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,I]of Object.entries(o||{}))a[p]=I}if(e instanceof Xa){let p=e.getScopes().filter(I=>I!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let h=yield n._getAppCheckToken(),d=h?`#${tI}=${encodeURIComponent(h)}`:"";return`${nI(n)}?${xr(u).slice(1)}${d}`})}function nI({config:n}){return n.emulator?cc(n,eI):`https://${n.authDomain}/${Zv}`}var qa="webStorageSupport",sc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ec,this._completeRedirectFn=Rv,this._overrideRedirectResult=bv}_openPopup(e,t,r,i){return y(this,null,function*(){var o;Vt((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let a=yield of(e,t,r,ja(),i);return Yv(e,a,Of())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let o=yield of(e,t,r,ja(),i);return uv(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Vt(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield zv(e),r=new ic(e);return t.register("authEvent",i=>(U(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(qa,{type:qa},i=>{var o;let a=(o=i?.[0])===null||o===void 0?void 0:o[qa];a!==void 0&&t(!!a),Je(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=xv(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return bf()||vf()||dc()}},qf=sc;var af="@firebase/auth",cf="1.7.8";var oc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function rI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function iI(n){Pt(new Le("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;U(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Sf(n)},d=new Qa(r,i,o,h);return zy(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Pt(new Le("auth-internal",e=>{let t=nn(e.getProvider("auth").getImmediate());return(r=>new oc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),de(af,cf,rI(n)),de(af,cf,"esm2017")}var sI=5*60,oI=Ia("authIdTokenMaxAge")||sI,uf=null,aI=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>oI)return;let i=t?.token;uf!==i&&(uf=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function wc(n=Dn()){let e=Fr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=fc(n,{popupRedirectResolver:qf,persistence:[Uf,xf,Ec]}),r=Ia("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let a=aI(o.toString());vc(t,a,()=>a(t.currentUser)),yc(t,u=>a(u))}}let i=ya("auth");return i&&pc(t,`http://${i}`),t}function cI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}By({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=Zt("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",cI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});iI("Browser");var jf="auth",qe=class{constructor(e){return e}},Hr=class{constructor(){return Lr(jf)}};var Tc=new Me("angularfire2.auth-instances");function XI(n,e){let t=rs(jf,n,e);return t&&new qe(t)}function ZI(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new qe(r)}}var eE={provide:Hr,deps:[[new Fe,Tc]]},tE={provide:qe,useFactory:XI,deps:[[new Fe,Tc],ut]};function $f(n,...e){return de("angularfire",Yt.full,"auth"),En([tE,eE,{provide:Tc,useFactory:ZI(n),multi:!0,deps:[bt,Wt,Vn,Xt,[new Fe,Nn],...e]}])}var Gf=Ne(gc,!0);var zf=Ne(wc,!0);var Wf=Ne(_c,!0);var Ts=Ne(Ic,!0);var As=class n{miDataSubject=new Hh("");miData$=this.miDataSubject.asObservable();setMiData(e){this.miDataSubject.next(e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})};function rE(n,e){n&1&&(rd(0),M(1,"div",9)(2,"div")(3,"button",10),G(4,"Login"),F()(),M(5,"div")(6,"button",10),G(7,"Resgistrarse"),F()()(),id()),n&2&&(ce(3),We("routerLink","./login"),ce(3),We("routerLink","./registro"))}function iE(n,e){if(n&1){let t=sd();M(0,"div",9)(1,"p",11),G(2),F(),M(3,"button",12),ot("click",function(){Xh(t);let i=An();return Zh(i.CloseSession())}),G(4,"Logout"),F()()}if(n&2){let t=An();ce(2),Wi("Usuario: ",t.auth.currentUser==null?null:t.auth.currentUser.email,"")}}function sE(n,e){n&1&&(M(0,"div")(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17),fe(6,"img",18),M(7,"div",19)(8,"h5",20),G(9,"El Ahorcado"),F(),M(10,"p",21),G(11,"Some quick example text to build on the card title and make up the bulk of the card's content."),F(),M(12,"button",10),G(13,"Cargar"),F()()()(),M(14,"div",16)(15,"div",17),fe(16,"img",22),M(17,"div",19)(18,"h5",20),G(19,"Mayor o Menor"),F(),M(20,"p",21),G(21,"Some quick example text to build on the card title and make up the bulk of the card's content."),F(),M(22,"button",10),G(23,"Cargar"),F()()()(),M(24,"div",16)(25,"div",17),fe(26,"img",23),M(27,"div",19)(28,"h5",20),G(29,"Preguntados"),F(),M(30,"p",21),G(31,"Some quick example text to build on the card title and make up the bulk of the card's content."),F(),M(32,"button",10),G(33,"Cargar"),F()()()(),M(34,"div",16)(35,"div",17),fe(36,"img",24),M(37,"div",19)(38,"h5",20),G(39,"Chat-Room"),F(),M(40,"p",21),G(41,"Some quick example text to build on the card title and make up the bulk of the card's content."),F(),M(42,"button",10),G(43,"Cargar"),F()()()(),M(44,"div",16)(45,"div",17),fe(46,"img",25),M(47,"div",19)(48,"h5",20),G(49,"Quien soy"),F(),M(50,"p",21),G(51,"Some quick example text to build on the card title and make up the bulk of the card's content."),F(),M(52,"button",10),G(53,"Cargar"),F()()()()()()()()),n&2&&(ce(12),We("routerLink","./juegos/ahorcado"),ce(10),We("routerLink","./juegos/mayoromenor"),ce(10),We("routerLink","./juegos/preguntados"),ce(10),We("routerLink","./juegos/chat"),ce(10),We("routerLink","./juegos/quiensoy"))}var bs=class n{constructor(e,t,r){this.dataService=e;this.auth=t;this.router=r}isUserLoggedIn=!0;usuario="";login="login";logout="logout";isChildActive=!1;ngOnInit(){this.dataService.miData$.subscribe(e=>{this.usuario=e}),this.router.events.subscribe(e=>{e instanceof md&&(this.isChildActive=e.url!=="/home")})}CloseSession(){Ts(this.auth).then(()=>{this.router.navigate(["/home"])})}static \u0275fac=function(t){return new(t||n)(ee(As),ee(qe),ee(St))};static \u0275cmp=ze({type:n,selectors:[["app-home"]],standalone:!0,features:[He],decls:17,vars:3,consts:[["elseBlock",""],[1,"navbar"],[1,"container"],[1,"d-flex"],["href","#",1,"navbar-brand"],["src","../../../assets/img/logo.png","alt","sala de juegos","width","30","height","24",1,"mt-2"],[1,"texto-blanco","silkscreen-regular"],[4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"div-botones","d-flex"],["type","button",1,"btn","btn-primary","texto-blanco","silkscreen-regular",3,"routerLink"],[1,"mt-2","text-center","texto-blanco"],[1,"btn","texto-blanco",3,"click"],[1,"container-fluid"],[1,"contenedor"],[1,"row"],[1,"col","div-card"],[1,"card","contenedor-fijo"],["src","../../../assets/img/elahorcado.png","alt","...",1,"card-img-top"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["src","../../../assets/img/mayoromenor.jpg","alt","...",1,"card-img-top"],["src","../../../assets/img/preguntados.png","alt","...",1,"card-img-top"],["src","../../../assets/img/chatroom.jpg","alt","...",1,"card-img-top"],["src","../../../assets/img/usericon.jpg","alt","...",1,"card-img-top"]],template:function(t,r){if(t&1&&(M(0,"div")(1,"nav",1)(2,"div",2)(3,"div",3)(4,"a",4),fe(5,"img",5),F(),M(6,"h1",6),G(7,"Sala de Juegos"),F()(),M(8,"div")(9,"div"),Tn(10,rE,8,2,"ng-container",7),F(),M(11,"div"),Tn(12,iE,5,1,"ng-template",null,0,cd),F()()()(),M(14,"div"),fe(15,"router-outlet"),F(),Tn(16,sE,54,5,"div",8),F()),t&2){let i=od(13);ce(10),We("ngIf",!(r.auth.currentUser!=null&&r.auth.currentUser.email))("ngIfElse",i),ce(6),We("ngIf",!r.isChildActive)}},dependencies:[Qi,fd,Ji,gd],styles:["div[_ngcontent-%COMP%]{--fondo: #3F3F43;--colorBoton: rgb(112, 230, 112);--colorBotonHover:green}nav[_ngcontent-%COMP%]{background-color:var(--fondo)}.div-botones[_ngcontent-%COMP%]{width:250px;justify-content:space-between}.btn[_ngcontent-%COMP%]{background:var(--colorBoton);border:none;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus{background:var(--colorBotonHover)}.texto-blanco[_ngcontent-%COMP%]{color:#fff}.silkscreen-regular[_ngcontent-%COMP%]{font-family:Silkscreen,sans-serif;font-weight:400;font-style:normal}.div-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.card[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}.card-body[_ngcontent-%COMP%]{padding-bottom:50px}.contenedor-fijo[_ngcontent-%COMP%]{width:220px;height:450px;overflow:hidden;border:1px solid #ddd;position:relative}.contenedor-fijo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:60%}"]})};var tp=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(ee(ua),ee(ca))},e.\u0275dir=At({type:e});let n=e;return n})(),oE=(()=>{let e=class e extends tp{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=aa(e)))(o||e)}})(),e.\u0275dir=At({type:e,features:[wn]});let n=e;return n})(),np=new Me("");var aE={provide:np,useExisting:ji(()=>Un),multi:!0};function cE(){let n=fa()?fa().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var uE=new Me(""),Un=(()=>{let e=class e extends tp{constructor(r,i,o){super(r,i),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!cE())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(ee(ua),ee(ca),ee(uE,8))},e.\u0275dir=At({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&ot("input",function(u){return o._handleInput(u.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(u){return o._compositionEnd(u.target.value)})},features:[Hi([aE]),wn]});let n=e;return n})();function lE(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var rp=new Me(""),hE=new Me("");function dE(n){return lE(n.value)?{required:!0}:null}function Hf(n){return null}function ip(n){return n!=null}function sp(n){return ld(n)?ra(n):n}function op(n){let e={};return n.forEach(t=>{e=t!=null?Pe(Pe({},e),t):e}),Object.keys(e).length===0?null:e}function ap(n,e){return e.map(t=>t(n))}function fE(n){return!n.validate}function cp(n){return n.map(e=>fE(e)?e:t=>e.validate(t))}function pE(n){if(!n)return null;let e=n.filter(ip);return e.length==0?null:function(t){return op(ap(t,e))}}function up(n){return n!=null?pE(cp(n)):null}function mE(n){if(!n)return null;let e=n.filter(ip);return e.length==0?null:function(t){let r=ap(t,e).map(sp);return Jh(r).pipe(Nr(op))}}function lp(n){return n!=null?mE(cp(n)):null}function Kf(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function gE(n){return n._rawValidators}function _E(n){return n._rawAsyncValidators}function Sc(n){return n?Array.isArray(n)?n:[n]:[]}function Rs(n,e){return Array.isArray(n)?n.includes(e):n===e}function Qf(n,e){let t=Sc(e);return Sc(n).forEach(i=>{Rs(t,i)||t.push(i)}),t}function Jf(n,e){return Sc(e).filter(t=>!Rs(n,t))}var Ps=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=up(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=lp(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Cc=class extends Ps{get formDirective(){return null}get path(){return null}},Xr=class extends Ps{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Rc=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},yE={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},HA=Oe(Pe({},yE),{"[class.ng-submitted]":"isSubmitted"}),ks=(()=>{let e=class e extends Rc{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(ee(Xr,2))},e.\u0275dir=At({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&nd("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[wn]});let n=e;return n})();var Kr="VALID",Cs="INVALID",Mn="PENDING",Qr="DISABLED",Ln=class{},Ds=class extends Ln{constructor(e,t){super(),this.value=e,this.source=t}},Jr=class extends Ln{constructor(e,t){super(),this.pristine=e,this.source=t}},Yr=class extends Ln{constructor(e,t){super(),this.touched=e,this.source=t}},Fn=class extends Ln{constructor(e,t){super(),this.status=e,this.source=t}};function vE(n){return(Ns(n)?n.validators:n)||null}function IE(n){return Array.isArray(n)?up(n):n||null}function EE(n,e){return(Ns(e)?e.asyncValidators:n)||null}function wE(n){return Array.isArray(n)?lp(n):n||null}function Ns(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var Pc=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Ki(()=>this.statusReactive()),this.statusReactive=zi(void 0),this._pristine=Ki(()=>this.pristineReactive()),this.pristineReactive=zi(!0),this._touched=Ki(()=>this.touchedReactive()),this.touchedReactive=zi(!1),this._events=new Wh,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Ht(this.statusReactive)}set status(e){Ht(()=>this.statusReactive.set(e))}get valid(){return this.status===Kr}get invalid(){return this.status===Cs}get pending(){return this.status==Mn}get disabled(){return this.status===Qr}get enabled(){return this.status!==Qr}get pristine(){return Ht(this.pristineReactive)}set pristine(e){Ht(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return Ht(this.touchedReactive)}set touched(e){Ht(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Qf(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Qf(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Jf(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Jf(e,this._rawAsyncValidators))}hasValidator(e){return Rs(this._rawValidators,e)}hasAsyncValidator(e){return Rs(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Oe(Pe({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Yr(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Yr(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Oe(Pe({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Jr(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Jr(!0,r))}markAsPending(e={}){this.status=Mn;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Fn(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Oe(Pe({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Qr,this.errors=null,this._forEachChild(i=>{i.disable(Oe(Pe({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ds(this.value,r)),this._events.next(new Fn(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Oe(Pe({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Kr,this._forEachChild(r=>{r.enable(Oe(Pe({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Oe(Pe({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Kr||this.status===Mn)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ds(this.value,t)),this._events.next(new Fn(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Oe(Pe({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Qr:Kr}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Mn,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=sp(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Fn(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Gi,this.statusChanges=new Gi}_calculateStatus(){return this._allControlsDisabled()?Qr:this.errors?Cs:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Mn)?Mn:this._anyControlsHaveStatus(Cs)?Cs:Kr}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Jr(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Yr(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ns(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=IE(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=wE(this._rawAsyncValidators)}};var hp=new Me("CallSetDisabledState",{providedIn:"root",factory:()=>Dc}),Dc="always";function TE(n,e){return[...e.path,n]}function AE(n,e,t=Dc){SE(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),CE(n,e),PE(n,e),RE(n,e),bE(n,e)}function Yf(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function bE(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function SE(n,e){let t=gE(n);e.validator!==null?n.setValidators(Kf(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=_E(n);e.asyncValidator!==null?n.setAsyncValidators(Kf(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Yf(e._rawValidators,i),Yf(e._rawAsyncValidators,i)}function CE(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&dp(n,e)})}function RE(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&dp(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function dp(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function PE(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function DE(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function kE(n){return Object.getPrototypeOf(n.constructor)===oE}function NE(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===Un?t=o:kE(o)?r=o:i=o}),i||r||t||null}function Xf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Zf(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var VE=class extends Pc{constructor(e=null,t,r){super(vE(t),EE(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ns(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Zf(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Xf(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Xf(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Zf(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var xE={provide:Xr,useExisting:ji(()=>Zr)},ep=Promise.resolve(),Zr=(()=>{let e=class e extends Xr{constructor(r,i,o,a,u,h){super(),this._changeDetectorRef=u,this.callSetDisabledState=h,this.control=new VE,this._registered=!1,this.name="",this.update=new Gi,this._parent=r,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=NE(this,a)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),DE(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){AE(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){ep.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,o=i!==0&&da(i);ep.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?TE(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(ee(Cc,9),ee(rp,10),ee(hE,10),ee(np,10),ee(dd,8),ee(hp,8))},e.\u0275dir=At({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Hi([xE]),wn,oa]});let n=e;return n})();var OE=(()=>{let e=class e{constructor(){this._validator=Hf}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Hf,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=At({type:e,features:[oa]});let n=e;return n})();var ME={provide:rp,useExisting:ji(()=>ei),multi:!0};var ei=(()=>{let e=class e extends OE{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=da,this.createValidator=r=>dE}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=aa(e)))(o||e)}})(),e.\u0275dir=At({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,o){i&2&&td("required",o._enabled?"":null)},inputs:{required:"required"},features:[Hi([ME]),wn]});let n=e;return n})();var FE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=sa({type:e}),e.\u0275inj=ia({});let n=e;return n})();var Vs=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:hp,useValue:r.callSetDisabledState??Dc}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=sa({type:e}),e.\u0275inj=ia({imports:[FE]});let n=e;return n})();var pp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mp={};var Mt,kc;(function(){var n;function e(E,m){function _(){}_.prototype=m.prototype,E.D=m.prototype,E.prototype=new _,E.prototype.constructor=E,E.C=function(v,w,A){for(var g=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)g[rt-2]=arguments[rt];return m.prototype[w].apply(v,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,m,_){_||(_=0);var v=Array(16);if(typeof m=="string")for(var w=0;16>w;++w)v[w]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(w=0;16>w;++w)v[w]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=E.g[0],_=E.g[1],w=E.g[2];var A=E.g[3],g=m+(A^_&(w^A))+v[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=A+(w^m&(_^w))+v[1]+3905402710&4294967295,A=m+(g<<12&4294967295|g>>>20),g=w+(_^A&(m^_))+v[2]+606105819&4294967295,w=A+(g<<17&4294967295|g>>>15),g=_+(m^w&(A^m))+v[3]+3250441966&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(A^_&(w^A))+v[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(w^m&(_^w))+v[5]+1200080426&4294967295,A=m+(g<<12&4294967295|g>>>20),g=w+(_^A&(m^_))+v[6]+2821735955&4294967295,w=A+(g<<17&4294967295|g>>>15),g=_+(m^w&(A^m))+v[7]+4249261313&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(A^_&(w^A))+v[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(w^m&(_^w))+v[9]+2336552879&4294967295,A=m+(g<<12&4294967295|g>>>20),g=w+(_^A&(m^_))+v[10]+4294925233&4294967295,w=A+(g<<17&4294967295|g>>>15),g=_+(m^w&(A^m))+v[11]+2304563134&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(A^_&(w^A))+v[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(w^m&(_^w))+v[13]+4254626195&4294967295,A=m+(g<<12&4294967295|g>>>20),g=w+(_^A&(m^_))+v[14]+2792965006&4294967295,w=A+(g<<17&4294967295|g>>>15),g=_+(m^w&(A^m))+v[15]+1236535329&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(w^A&(_^w))+v[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^w&(m^_))+v[6]+3225465664&4294967295,A=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(A^m))+v[11]+643717713&4294967295,w=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(w^A))+v[0]+3921069994&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(w^A&(_^w))+v[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^w&(m^_))+v[10]+38016083&4294967295,A=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(A^m))+v[15]+3634488961&4294967295,w=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(w^A))+v[4]+3889429448&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(w^A&(_^w))+v[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^w&(m^_))+v[14]+3275163606&4294967295,A=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(A^m))+v[3]+4107603335&4294967295,w=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(w^A))+v[8]+1163531501&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(w^A&(_^w))+v[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^w&(m^_))+v[2]+4243563512&4294967295,A=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(A^m))+v[7]+1735328473&4294967295,w=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(w^A))+v[12]+2368359562&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(_^w^A)+v[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^w)+v[8]+2272392833&4294967295,A=m+(g<<11&4294967295|g>>>21),g=w+(A^m^_)+v[11]+1839030562&4294967295,w=A+(g<<16&4294967295|g>>>16),g=_+(w^A^m)+v[14]+4259657740&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(_^w^A)+v[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^w)+v[4]+1272893353&4294967295,A=m+(g<<11&4294967295|g>>>21),g=w+(A^m^_)+v[7]+4139469664&4294967295,w=A+(g<<16&4294967295|g>>>16),g=_+(w^A^m)+v[10]+3200236656&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(_^w^A)+v[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^w)+v[0]+3936430074&4294967295,A=m+(g<<11&4294967295|g>>>21),g=w+(A^m^_)+v[3]+3572445317&4294967295,w=A+(g<<16&4294967295|g>>>16),g=_+(w^A^m)+v[6]+76029189&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(_^w^A)+v[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^w)+v[12]+3873151461&4294967295,A=m+(g<<11&4294967295|g>>>21),g=w+(A^m^_)+v[15]+530742520&4294967295,w=A+(g<<16&4294967295|g>>>16),g=_+(w^A^m)+v[2]+3299628645&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(w^(_|~A))+v[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~w))+v[7]+1126891415&4294967295,A=m+(g<<10&4294967295|g>>>22),g=w+(m^(A|~_))+v[14]+2878612391&4294967295,w=A+(g<<15&4294967295|g>>>17),g=_+(A^(w|~m))+v[5]+4237533241&4294967295,_=w+(g<<21&4294967295|g>>>11),g=m+(w^(_|~A))+v[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~w))+v[3]+2399980690&4294967295,A=m+(g<<10&4294967295|g>>>22),g=w+(m^(A|~_))+v[10]+4293915773&4294967295,w=A+(g<<15&4294967295|g>>>17),g=_+(A^(w|~m))+v[1]+2240044497&4294967295,_=w+(g<<21&4294967295|g>>>11),g=m+(w^(_|~A))+v[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~w))+v[15]+4264355552&4294967295,A=m+(g<<10&4294967295|g>>>22),g=w+(m^(A|~_))+v[6]+2734768916&4294967295,w=A+(g<<15&4294967295|g>>>17),g=_+(A^(w|~m))+v[13]+1309151649&4294967295,_=w+(g<<21&4294967295|g>>>11),g=m+(w^(_|~A))+v[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~w))+v[11]+3174756917&4294967295,A=m+(g<<10&4294967295|g>>>22),g=w+(m^(A|~_))+v[2]+718787259&4294967295,w=A+(g<<15&4294967295|g>>>17),g=_+(A^(w|~m))+v[9]+3951481745&4294967295,E.g[0]=E.g[0]+m&4294967295,E.g[1]=E.g[1]+(w+(g<<21&4294967295|g>>>11))&4294967295,E.g[2]=E.g[2]+w&4294967295,E.g[3]=E.g[3]+A&4294967295}r.prototype.u=function(E,m){m===void 0&&(m=E.length);for(var _=m-this.blockSize,v=this.B,w=this.h,A=0;A<m;){if(w==0)for(;A<=_;)i(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<m;)if(v[w++]=E.charCodeAt(A++),w==this.blockSize){i(this,v),w=0;break}}else for(;A<m;)if(v[w++]=E[A++],w==this.blockSize){i(this,v),w=0;break}}this.h=w,this.o+=m},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var m=1;m<E.length-8;++m)E[m]=0;var _=8*this.o;for(m=E.length-8;m<E.length;++m)E[m]=_&255,_/=256;for(this.u(E),E=Array(16),m=_=0;4>m;++m)for(var v=0;32>v;v+=8)E[_++]=this.g[m]>>>v&255;return E};function o(E,m){var _=u;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=m(E)}function a(E,m){this.h=m;for(var _=[],v=!0,w=E.length-1;0<=w;w--){var A=E[w]|0;v&&A==m||(_[w]=A,v=!1)}this.g=_}var u={};function h(E){return-128<=E&&128>E?o(E,function(m){return new a([m|0],0>m?-1:0)}):new a([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return I;if(0>E)return k(d(-E));for(var m=[],_=1,v=0;E>=_;v++)m[v]=E/_|0,_*=4294967296;return new a(m,0)}function p(E,m){if(E.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(E.charAt(0)=="-")return k(p(E.substring(1),m));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),v=I,w=0;w<E.length;w+=8){var A=Math.min(8,E.length-w),g=parseInt(E.substring(w,w+A),m);8>A?(A=d(Math.pow(m,A)),v=v.j(A).add(d(g))):(v=v.j(_),v=v.add(d(g)))}return v}var I=h(0),S=h(1),R=h(16777216);n=a.prototype,n.m=function(){if(O(this))return-k(this).m();for(var E=0,m=1,_=0;_<this.g.length;_++){var v=this.i(_);E+=(0<=v?v:4294967296+v)*m,m*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(N(this))return"0";if(O(this))return"-"+k(this).toString(E);for(var m=d(Math.pow(E,6)),_=this,v="";;){var w=ne(_,m).g;_=$(_,w.j(m));var A=((0<_.g.length?_.g[0]:_.h)>>>0).toString(E);if(_=w,N(_))return A+v;for(;6>A.length;)A="0"+A;v=A+v}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function N(E){if(E.h!=0)return!1;for(var m=0;m<E.g.length;m++)if(E.g[m]!=0)return!1;return!0}function O(E){return E.h==-1}n.l=function(E){return E=$(this,E),O(E)?-1:N(E)?0:1};function k(E){for(var m=E.g.length,_=[],v=0;v<m;v++)_[v]=~E.g[v];return new a(_,~E.h).add(S)}n.abs=function(){return O(this)?k(this):this},n.add=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],v=0,w=0;w<=m;w++){var A=v+(this.i(w)&65535)+(E.i(w)&65535),g=(A>>>16)+(this.i(w)>>>16)+(E.i(w)>>>16);v=g>>>16,A&=65535,g&=65535,_[w]=g<<16|A}return new a(_,_[_.length-1]&-2147483648?-1:0)};function $(E,m){return E.add(k(m))}n.j=function(E){if(N(this)||N(E))return I;if(O(this))return O(E)?k(this).j(k(E)):k(k(this).j(E));if(O(E))return k(this.j(k(E)));if(0>this.l(R)&&0>E.l(R))return d(this.m()*E.m());for(var m=this.g.length+E.g.length,_=[],v=0;v<2*m;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(var w=0;w<E.g.length;w++){var A=this.i(v)>>>16,g=this.i(v)&65535,rt=E.i(w)>>>16,dr=E.i(w)&65535;_[2*v+2*w]+=g*dr,H(_,2*v+2*w),_[2*v+2*w+1]+=A*dr,H(_,2*v+2*w+1),_[2*v+2*w+1]+=g*rt,H(_,2*v+2*w+1),_[2*v+2*w+2]+=A*rt,H(_,2*v+2*w+2)}for(v=0;v<m;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=m;v<2*m;v++)_[v]=0;return new a(_,0)};function H(E,m){for(;(E[m]&65535)!=E[m];)E[m+1]+=E[m]>>>16,E[m]&=65535,m++}function K(E,m){this.g=E,this.h=m}function ne(E,m){if(N(m))throw Error("division by zero");if(N(E))return new K(I,I);if(O(E))return m=ne(k(E),m),new K(k(m.g),k(m.h));if(O(m))return m=ne(E,k(m)),new K(k(m.g),m.h);if(30<E.g.length){if(O(E)||O(m))throw Error("slowDivide_ only works with positive integers.");for(var _=S,v=m;0>=v.l(E);)_=Se(_),v=Se(v);var w=X(_,1),A=X(v,1);for(v=X(v,2),_=X(_,2);!N(v);){var g=A.add(v);0>=g.l(E)&&(w=w.add(_),A=g),v=X(v,1),_=X(_,1)}return m=$(E,w.j(m)),new K(w,m)}for(w=I;0<=E.l(m);){for(_=Math.max(1,Math.floor(E.m()/m.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),A=d(_),g=A.j(m);O(g)||0<g.l(E);)_-=v,A=d(_),g=A.j(m);N(A)&&(A=S),w=w.add(A),E=$(E,g)}return new K(w,E)}n.A=function(E){return ne(this,E).h},n.and=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)&E.i(v);return new a(_,this.h&E.h)},n.or=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)|E.i(v);return new a(_,this.h|E.h)},n.xor=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)^E.i(v);return new a(_,this.h^E.h)};function Se(E){for(var m=E.g.length+1,_=[],v=0;v<m;v++)_[v]=E.i(v)<<1|E.i(v-1)>>>31;return new a(_,E.h)}function X(E,m){var _=m>>5;m%=32;for(var v=E.g.length-_,w=[],A=0;A<v;A++)w[A]=0<m?E.i(A+_)>>>m|E.i(A+_+1)<<32-m:E.i(A+_);return new a(w,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,kc=mp.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Mt=mp.Integer=a}).apply(typeof pp<"u"?pp:typeof self<"u"?self:typeof window<"u"?window:{});var xs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ft={};var Nc,Vc,Bn,xc,ti,Os,Oc,Mc,Fc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof xs=="object"&&xs];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var T=s[f];if(!(T in l))break e;l=l[T]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,T={next:function(){if(!f&&l<s.length){var b=l++;return{value:c(b,s[b]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function p(s,c,l){return s.call.apply(s.bind,arguments)}function I(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),s.apply(c,T)}}return function(){return s.apply(c,arguments)}}function S(s,c,l){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:I,S.apply(null,arguments)}function R(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function N(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,T,b){for(var D=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)D[Z-2]=arguments[Z];return c.prototype[T].apply(f,D)}}function O(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function k(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let T=s.length||0,b=f.length||0;s.length=T+b;for(let D=0;D<b;D++)s[T+D]=f[D]}else s.push(f)}}class ${constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function H(s){return/^[\s\xa0]*$/.test(s)}function K(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function ne(s){return ne[" "](s),s}ne[" "]=function(){};var Se=K().indexOf("Gecko")!=-1&&!(K().toLowerCase().indexOf("webkit")!=-1&&K().indexOf("Edge")==-1)&&!(K().indexOf("Trident")!=-1||K().indexOf("MSIE")!=-1)&&K().indexOf("Edge")==-1;function X(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function E(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function m(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(s,c){let l,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(l in f)s[l]=f[l];for(let b=0;b<_.length;b++)l=_[b],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function w(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function A(s){u.setTimeout(()=>{throw s},0)}function g(){var s=Po;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class rt{constructor(){this.h=this.g=null}add(c,l){let f=dr.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var dr=new $(()=>new Eg,s=>s.reset());class Eg{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let fr,pr=!1,Po=new rt,zl=()=>{let s=u.Promise.resolve(void 0);fr=()=>{s.then(wg)}};var wg=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){A(l)}var c=dr;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}pr=!1};function vt(){this.s=this.s,this.C=this.C}vt.prototype.s=!1,vt.prototype.ma=function(){this.s||(this.s=!0,this.N())},vt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var Tg=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s}();function mr(s,c){if(ve.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(Se){e:{try{ne(c.nodeName);var T=!0;break e}catch{}T=!1}T||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:Ag[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&mr.aa.h.call(this)}}N(mr,ve);var Ag={2:"touch",3:"pen",4:"mouse"};mr.prototype.h=function(){mr.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var gr="closure_listenable_"+(1e6*Math.random()|0),bg=0;function Sg(s,c,l,f,T){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=T,this.key=++bg,this.da=this.fa=!1}function bi(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Si(s){this.src=s,this.g={},this.h=0}Si.prototype.add=function(s,c,l,f,T){var b=s.toString();s=this.g[b],s||(s=this.g[b]=[],this.h++);var D=ko(s,c,f,T);return-1<D?(c=s[D],l||(c.fa=!1)):(c=new Sg(c,this.src,b,!!f,T),c.fa=l,s.push(c)),c};function Do(s,c){var l=c.type;if(l in s.g){var f=s.g[l],T=Array.prototype.indexOf.call(f,c,void 0),b;(b=0<=T)&&Array.prototype.splice.call(f,T,1),b&&(bi(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function ko(s,c,l,f){for(var T=0;T<s.length;++T){var b=s[T];if(!b.da&&b.listener==c&&b.capture==!!l&&b.ha==f)return T}return-1}var No="closure_lm_"+(1e6*Math.random()|0),Vo={};function Wl(s,c,l,f,T){if(f&&f.once)return Kl(s,c,l,f,T);if(Array.isArray(c)){for(var b=0;b<c.length;b++)Wl(s,c[b],l,f,T);return null}return l=Fo(l),s&&s[gr]?s.K(c,l,d(f)?!!f.capture:!!f,T):Hl(s,c,l,!1,f,T)}function Hl(s,c,l,f,T,b){if(!c)throw Error("Invalid event type");var D=d(T)?!!T.capture:!!T,Z=Oo(s);if(Z||(s[No]=Z=new Si(s)),l=Z.add(c,l,f,D,b),l.proxy)return l;if(f=Cg(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)Tg||(T=D),T===void 0&&(T=!1),s.addEventListener(c.toString(),f,T);else if(s.attachEvent)s.attachEvent(Jl(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function Cg(){function s(l){return c.call(s.src,s.listener,l)}let c=Rg;return s}function Kl(s,c,l,f,T){if(Array.isArray(c)){for(var b=0;b<c.length;b++)Kl(s,c[b],l,f,T);return null}return l=Fo(l),s&&s[gr]?s.L(c,l,d(f)?!!f.capture:!!f,T):Hl(s,c,l,!0,f,T)}function Ql(s,c,l,f,T){if(Array.isArray(c))for(var b=0;b<c.length;b++)Ql(s,c[b],l,f,T);else f=d(f)?!!f.capture:!!f,l=Fo(l),s&&s[gr]?(s=s.i,c=String(c).toString(),c in s.g&&(b=s.g[c],l=ko(b,l,f,T),-1<l&&(bi(b[l]),Array.prototype.splice.call(b,l,1),b.length==0&&(delete s.g[c],s.h--)))):s&&(s=Oo(s))&&(c=s.g[c.toString()],s=-1,c&&(s=ko(c,l,f,T)),(l=-1<s?c[s]:null)&&xo(l))}function xo(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[gr])Do(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(Jl(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=Oo(c))?(Do(l,s),l.h==0&&(l.src=null,c[No]=null)):bi(s)}}}function Jl(s){return s in Vo?Vo[s]:Vo[s]="on"+s}function Rg(s,c){if(s.da)s=!0;else{c=new mr(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&xo(s),s=l.call(f,c)}return s}function Oo(s){return s=s[No],s instanceof Si?s:null}var Mo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fo(s){return typeof s=="function"?s:(s[Mo]||(s[Mo]=function(c){return s.handleEvent(c)}),s[Mo])}function Ie(){vt.call(this),this.i=new Si(this),this.M=this,this.F=null}N(Ie,vt),Ie.prototype[gr]=!0,Ie.prototype.removeEventListener=function(s,c,l,f){Ql(this,s,c,l,f)};function Ce(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new ve(c,s);else if(c instanceof ve)c.target=c.target||s;else{var T=c;c=new ve(f,s),v(c,T)}if(T=!0,l)for(var b=l.length-1;0<=b;b--){var D=c.g=l[b];T=Ci(D,f,!0,c)&&T}if(D=c.g=s,T=Ci(D,f,!0,c)&&T,T=Ci(D,f,!1,c)&&T,l)for(b=0;b<l.length;b++)D=c.g=l[b],T=Ci(D,f,!1,c)&&T}Ie.prototype.N=function(){if(Ie.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)bi(l[f]);delete s.g[c],s.h--}}this.F=null},Ie.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},Ie.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function Ci(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var T=!0,b=0;b<c.length;++b){var D=c[b];if(D&&!D.da&&D.capture==l){var Z=D.listener,ge=D.ha||D.src;D.fa&&Do(s.i,D),T=Z.call(ge,f)!==!1&&T}}return T&&!f.defaultPrevented}function Yl(s,c,l){if(typeof s=="function")l&&(s=S(s,l));else if(s&&typeof s.handleEvent=="function")s=S(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function Xl(s){s.g=Yl(()=>{s.g=null,s.i&&(s.i=!1,Xl(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Pg extends vt{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Xl(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _r(s){vt.call(this),this.h=s,this.g={}}N(_r,vt);var Zl=[];function eh(s){X(s.g,function(c,l){this.g.hasOwnProperty(l)&&xo(c)},s),s.g={}}_r.prototype.N=function(){_r.aa.N.call(this),eh(this)},_r.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Lo=u.JSON.stringify,Dg=u.JSON.parse,kg=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function Uo(){}Uo.prototype.h=null;function th(s){return s.h||(s.h=s.i())}function nh(){}var yr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Bo(){ve.call(this,"d")}N(Bo,ve);function qo(){ve.call(this,"c")}N(qo,ve);var qt={},rh=null;function Ri(){return rh=rh||new Ie}qt.La="serverreachability";function ih(s){ve.call(this,qt.La,s)}N(ih,ve);function vr(s){let c=Ri();Ce(c,new ih(c))}qt.STAT_EVENT="statevent";function sh(s,c){ve.call(this,qt.STAT_EVENT,s),this.stat=c}N(sh,ve);function Re(s){let c=Ri();Ce(c,new sh(c,s))}qt.Ma="timingevent";function oh(s,c){ve.call(this,qt.Ma,s),this.size=c}N(oh,ve);function Ir(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function Er(){this.g=!0}Er.prototype.xa=function(){this.g=!1};function Ng(s,c,l,f,T,b){s.info(function(){if(s.g)if(b)for(var D="",Z=b.split("&"),ge=0;ge<Z.length;ge++){var J=Z[ge].split("=");if(1<J.length){var Ee=J[0];J=J[1];var we=Ee.split("_");D=2<=we.length&&we[1]=="type"?D+(Ee+"="+J+"&"):D+(Ee+"=redacted&")}}else D=null;else D=b;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+c+`
`+l+`
`+D})}function Vg(s,c,l,f,T,b,D){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+c+`
`+l+`
`+b+" "+D})}function _n(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+Og(s,l)+(f?" "+f:"")})}function xg(s,c){s.info(function(){return"TIMEOUT: "+c})}Er.prototype.info=function(){};function Og(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var b=T[0];if(b!="noop"&&b!="stop"&&b!="close")for(var D=1;D<T.length;D++)T[D]=""}}}}return Lo(l)}catch{return c}}var Pi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ah={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},jo;function Di(){}N(Di,Uo),Di.prototype.g=function(){return new XMLHttpRequest},Di.prototype.i=function(){return{}},jo=new Di;function It(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new _r(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ch}function ch(){this.i=null,this.g="",this.h=!1}var uh={},$o={};function Go(s,c,l){s.L=1,s.v=xi(it(c)),s.m=l,s.P=!0,lh(s,null)}function lh(s,c){s.F=Date.now(),ki(s),s.A=it(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),Ah(l.i,"t",f),s.C=0,l=s.j.J,s.h=new ch,s.g=jh(s.j,l?c:null,!s.m),0<s.O&&(s.M=new Pg(S(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var T="readystatechange";Array.isArray(T)||(T&&(Zl[0]=T.toString()),T=Zl);for(var b=0;b<T.length;b++){var D=Wl(l,T[b],f||c.handleEvent,!1,c.h||c);if(!D)break;c.g[D.key]=D}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),vr(),Ng(s.i,s.u,s.A,s.l,s.R,s.m)}It.prototype.ca=function(s){s=s.target;let c=this.M;c&&st(s)==3?c.j():this.Y(s)},It.prototype.Y=function(s){try{if(s==this.g)e:{let we=st(this.g);var c=this.g.Ba();let In=this.g.Z();if(!(3>we)&&(we!=3||this.g&&(this.h.h||this.g.oa()||kh(this.g)))){this.J||we!=4||c==7||(c==8||0>=In?vr(3):vr(2)),zo(this);var l=this.g.Z();this.X=l;t:if(hh(this)){var f=kh(this.g);s="";var T=f.length,b=st(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){jt(this),wr(this);var D="";break t}this.h.i=new u.TextDecoder}for(c=0;c<T;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(b&&c==T-1)});f.length=0,this.h.g+=s,this.C=0,D=this.h.g}else D=this.g.oa();if(this.o=l==200,Vg(this.i,this.u,this.A,this.l,this.R,we,l),this.o){if(this.T&&!this.K){t:{if(this.g){var Z,ge=this.g;if((Z=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Z)){var J=Z;break t}}J=null}if(l=J)_n(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wo(this,l);else{this.o=!1,this.s=3,Re(12),jt(this),wr(this);break e}}if(this.P){l=!0;let Ue;for(;!this.J&&this.C<D.length;)if(Ue=Mg(this,D),Ue==$o){we==4&&(this.s=4,Re(14),l=!1),_n(this.i,this.l,null,"[Incomplete Response]");break}else if(Ue==uh){this.s=4,Re(15),_n(this.i,this.l,D,"[Invalid Chunk]"),l=!1;break}else _n(this.i,this.l,Ue,null),Wo(this,Ue);if(hh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),we!=4||D.length!=0||this.h.h||(this.s=1,Re(16),l=!1),this.o=this.o&&l,!l)_n(this.i,this.l,D,"[Invalid Chunked Response]"),jt(this),wr(this);else if(0<D.length&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.ba&&!Ee.M&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),Xo(Ee),Ee.M=!0,Re(11))}}else _n(this.i,this.l,D,null),Wo(this,D);we==4&&jt(this),this.o&&!this.J&&(we==4?Lh(this.j,this):(this.o=!1,ki(this)))}else Zg(this.g),l==400&&0<D.indexOf("Unknown SID")?(this.s=3,Re(12)):(this.s=0,Re(13)),jt(this),wr(this)}}}catch{}finally{}};function hh(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function Mg(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?$o:(l=Number(c.substring(l,f)),isNaN(l)?uh:(f+=1,f+l>c.length?$o:(c=c.slice(f,f+l),s.C=f+l,c)))}It.prototype.cancel=function(){this.J=!0,jt(this)};function ki(s){s.S=Date.now()+s.I,dh(s,s.I)}function dh(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=Ir(S(s.ba,s),c)}function zo(s){s.B&&(u.clearTimeout(s.B),s.B=null)}It.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(xg(this.i,this.A),this.L!=2&&(vr(),Re(17)),jt(this),this.s=2,wr(this)):dh(this,this.S-s)};function wr(s){s.j.G==0||s.J||Lh(s.j,s)}function jt(s){zo(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,eh(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function Wo(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||Ho(l.h,s))){if(!s.K&&Ho(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)Ui(l),Fi(l);else break e;Yo(l),Re(18)}}else l.za=T[1],0<l.za-l.T&&37500>T[2]&&l.F&&l.v==0&&!l.C&&(l.C=Ir(S(l.Za,l),6e3));if(1>=mh(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else Gt(l,11)}else if((s.K||l.g==s)&&Ui(l),!H(c))for(T=l.Da.g.parse(c),c=0;c<T.length;c++){let J=T[c];if(l.T=J[0],J=J[1],l.G==2)if(J[0]=="c"){l.K=J[1],l.ia=J[2];let Ee=J[3];Ee!=null&&(l.la=Ee,l.j.info("VER="+l.la));let we=J[4];we!=null&&(l.Aa=we,l.j.info("SVER="+l.Aa));let In=J[5];In!=null&&typeof In=="number"&&0<In&&(f=1.5*In,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let Ue=s.g;if(Ue){let qi=Ue.g?Ue.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qi){var b=f.h;b.g||qi.indexOf("spdy")==-1&&qi.indexOf("quic")==-1&&qi.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(Ko(b,b.h),b.h=null))}if(f.D){let Zo=Ue.g?Ue.g.getResponseHeader("X-HTTP-Session-Id"):null;Zo&&(f.ya=Zo,re(f.I,f.D,Zo))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var D=s;if(f.qa=qh(f,f.J?f.ia:null,f.W),D.K){gh(f.h,D);var Z=D,ge=f.L;ge&&(Z.I=ge),Z.B&&(zo(Z),ki(Z)),f.g=D}else Mh(f);0<l.i.length&&Li(l)}else J[0]!="stop"&&J[0]!="close"||Gt(l,7);else l.G==3&&(J[0]=="stop"||J[0]=="close"?J[0]=="stop"?Gt(l,7):Jo(l):J[0]!="noop"&&l.l&&l.l.ta(J),l.v=0)}}vr(4)}catch{}}var Fg=class{constructor(s,c){this.g=s,this.map=c}};function fh(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ph(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function mh(s){return s.h?1:s.g?s.g.size:0}function Ho(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function Ko(s,c){s.g?s.g.add(c):s.h=c}function gh(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}fh.prototype.cancel=function(){if(this.i=_h(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function _h(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return O(s.i)}function Lg(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function Ug(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function yh(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=Ug(s),f=Lg(s),T=f.length,b=0;b<T;b++)c.call(void 0,f[b],l&&l[b],s)}var vh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bg(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),T=null;if(0<=f){var b=s[l].substring(0,f);T=s[l].substring(f+1)}else b=s[l];c(b,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function $t(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof $t){this.h=s.h,Ni(this,s.j),this.o=s.o,this.g=s.g,Vi(this,s.s),this.l=s.l;var c=s.i,l=new br;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),Ih(this,l),this.m=s.m}else s&&(c=String(s).match(vh))?(this.h=!1,Ni(this,c[1]||"",!0),this.o=Tr(c[2]||""),this.g=Tr(c[3]||"",!0),Vi(this,c[4]),this.l=Tr(c[5]||"",!0),Ih(this,c[6]||"",!0),this.m=Tr(c[7]||"")):(this.h=!1,this.i=new br(null,this.h))}$t.prototype.toString=function(){var s=[],c=this.j;c&&s.push(Ar(c,Eh,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(Ar(c,Eh,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(Ar(l,l.charAt(0)=="/"?$g:jg,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",Ar(l,zg)),s.join("")};function it(s){return new $t(s)}function Ni(s,c,l){s.j=l?Tr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Vi(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function Ih(s,c,l){c instanceof br?(s.i=c,Wg(s.i,s.h)):(l||(c=Ar(c,Gg)),s.i=new br(c,s.h))}function re(s,c,l){s.i.set(c,l)}function xi(s){return re(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function Tr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function Ar(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,qg),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function qg(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Eh=/[#\/\?@]/g,jg=/[#\?:]/g,$g=/[#\?]/g,Gg=/[#\?@]/g,zg=/#/g;function br(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function Et(s){s.g||(s.g=new Map,s.h=0,s.i&&Bg(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=br.prototype,n.add=function(s,c){Et(this),this.i=null,s=yn(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function wh(s,c){Et(s),c=yn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function Th(s,c){return Et(s),c=yn(s,c),s.g.has(c)}n.forEach=function(s,c){Et(this),this.g.forEach(function(l,f){l.forEach(function(T){s.call(c,T,f,this)},this)},this)},n.na=function(){Et(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let T=s[f];for(let b=0;b<T.length;b++)l.push(c[f])}return l},n.V=function(s){Et(this);let c=[];if(typeof s=="string")Th(this,s)&&(c=c.concat(this.g.get(yn(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return Et(this),this.i=null,s=yn(this,s),Th(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function Ah(s,c,l){wh(s,c),0<l.length&&(s.i=null,s.g.set(yn(s,c),O(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let b=encodeURIComponent(String(f)),D=this.V(f);for(f=0;f<D.length;f++){var T=b;D[f]!==""&&(T+="="+encodeURIComponent(String(D[f]))),s.push(T)}}return this.i=s.join("&")};function yn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function Wg(s,c){c&&!s.j&&(Et(s),s.i=null,s.g.forEach(function(l,f){var T=f.toLowerCase();f!=T&&(wh(this,f),Ah(this,T,l))},s)),s.j=c}function Hg(s,c){let l=new Er;if(u.Image){let f=new Image;f.onload=R(wt,l,"TestLoadImage: loaded",!0,c,f),f.onerror=R(wt,l,"TestLoadImage: error",!1,c,f),f.onabort=R(wt,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=R(wt,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function Kg(s,c){let l=new Er,f=new AbortController,T=setTimeout(()=>{f.abort(),wt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(b=>{clearTimeout(T),b.ok?wt(l,"TestPingServer: ok",!0,c):wt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),wt(l,"TestPingServer: error",!1,c)})}function wt(s,c,l,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(l)}catch{}}function Qg(){this.g=new kg}function Jg(s,c,l){let f=l||"";try{yh(s,function(T,b){let D=T;d(T)&&(D=Lo(T)),c.push(f+b+"="+encodeURIComponent(D))})}catch(T){throw c.push(f+"type="+encodeURIComponent("_badmap")),T}}function Sr(s){this.l=s.Ub||null,this.j=s.eb||!1}N(Sr,Uo),Sr.prototype.g=function(){return new Oi(this.l,this.j)},Sr.prototype.i=function(s){return function(){return s}}({});function Oi(s,c){Ie.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(Oi,Ie),n=Oi.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,Rr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Cr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Rr(this)),this.g&&(this.readyState=3,Rr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;bh(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function bh(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?Cr(this):Rr(this),this.readyState==3&&bh(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,Cr(this))},n.Qa=function(s){this.g&&(this.response=s,Cr(this))},n.ga=function(){this.g&&Cr(this)};function Cr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,Rr(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function Rr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(Oi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Sh(s){let c="";return X(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function Qo(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=Sh(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):re(s,c,l))}function oe(s){Ie.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(oe,Ie);var Yg=/^https?$/i,Xg=["POST","PUT"];n=oe.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():jo.g(),this.v=this.o?th(this.o):th(jo),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(b){Ch(this,b);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)l.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let b of f.keys())l.set(b,f.get(b));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(b=>b.toLowerCase()=="content-type"),T=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Xg,c,void 0))||f||T||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,D]of l)this.g.setRequestHeader(b,D);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Dh(this),this.u=!0,this.g.send(s),this.u=!1}catch(b){Ch(this,b)}};function Ch(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,Rh(s),Mi(s)}function Rh(s){s.A||(s.A=!0,Ce(s,"complete"),Ce(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,Ce(this,"complete"),Ce(this,"abort"),Mi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mi(this,!0)),oe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ph(this):this.bb())},n.bb=function(){Ph(this)};function Ph(s){if(s.h&&typeof a<"u"&&(!s.v[1]||st(s)!=4||s.Z()!=2)){if(s.u&&st(s)==4)Yl(s.Ea,0,s);else if(Ce(s,"readystatechange"),st(s)==4){s.h=!1;try{let D=s.Z();e:switch(D){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=D===0){var T=String(s.D).match(vh)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),f=!Yg.test(T?T.toLowerCase():"")}l=f}if(l)Ce(s,"complete"),Ce(s,"success");else{s.m=6;try{var b=2<st(s)?s.g.statusText:""}catch{b=""}s.l=b+" ["+s.Z()+"]",Rh(s)}}finally{Mi(s)}}}}function Mi(s,c){if(s.g){Dh(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||Ce(s,"ready");try{l.onreadystatechange=f}catch{}}}function Dh(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function st(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<st(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Dg(c)}};function kh(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function Zg(s){let c={};s=(s.g&&2<=st(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(H(s[f]))continue;var l=w(s[f]);let T=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let b=c[T]||[];c[T]=b,b.push(l)}E(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function Nh(s){this.Aa=0,this.i=[],this.j=new Er,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pr("baseRetryDelayMs",5e3,s),this.cb=Pr("retryDelaySeedMs",1e4,s),this.Wa=Pr("forwardChannelMaxRetries",2,s),this.wa=Pr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new fh(s&&s.concurrentRequestLimit),this.Da=new Qg,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Nh.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){Re(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=qh(this,null,this.W),Li(this)};function Jo(s){if(Vh(s),s.G==3){var c=s.U++,l=it(s.I);if(re(l,"SID",s.K),re(l,"RID",c),re(l,"TYPE","terminate"),Dr(s,l),c=new It(s,s.j,c),c.L=2,c.v=xi(it(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=jh(c.j,null),c.g.ea(c.v)),c.F=Date.now(),ki(c)}Bh(s)}function Fi(s){s.g&&(Xo(s),s.g.cancel(),s.g=null)}function Vh(s){Fi(s),s.u&&(u.clearTimeout(s.u),s.u=null),Ui(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function Li(s){if(!ph(s.h)&&!s.s){s.s=!0;var c=s.Ga;fr||zl(),pr||(fr(),pr=!0),Po.add(c,s),s.B=0}}function e_(s,c){return mh(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=Ir(S(s.Ga,s,c),Uh(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let T=new It(this,this.j,s),b=this.o;if(this.S&&(b?(b=m(b),v(b,this.S)):b=this.S),this.m!==null||this.O||(T.H=b,b=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=Oh(this,T,c),l=it(this.I),re(l,"RID",s),re(l,"CVER",22),this.D&&re(l,"X-HTTP-Session-Id",this.D),Dr(this,l),b&&(this.O?c="headers="+encodeURIComponent(String(Sh(b)))+"&"+c:this.m&&Qo(l,this.m,b)),Ko(this.h,T),this.Ua&&re(l,"TYPE","init"),this.P?(re(l,"$req",c),re(l,"SID","null"),T.T=!0,Go(T,l,null)):Go(T,l,c),this.G=2}}else this.G==3&&(s?xh(this,s):this.i.length==0||ph(this.h)||xh(this))};function xh(s,c){var l;c?l=c.l:l=s.U++;let f=it(s.I);re(f,"SID",s.K),re(f,"RID",l),re(f,"AID",s.T),Dr(s,f),s.m&&s.o&&Qo(f,s.m,s.o),l=new It(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=Oh(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),Ko(s.h,l),Go(l,f,c)}function Dr(s,c){s.H&&X(s.H,function(l,f){re(c,f,l)}),s.l&&yh({},function(l,f){re(c,f,l)})}function Oh(s,c,l){l=Math.min(s.i.length,l);var f=s.l?S(s.l.Na,s.l,s):null;e:{var T=s.i;let b=-1;for(;;){let D=["count="+l];b==-1?0<l?(b=T[0].g,D.push("ofs="+b)):b=0:D.push("ofs="+b);let Z=!0;for(let ge=0;ge<l;ge++){let J=T[ge].g,Ee=T[ge].map;if(J-=b,0>J)b=Math.max(0,T[ge].g-100),Z=!1;else try{Jg(Ee,D,"req"+J+"_")}catch{f&&f(Ee)}}if(Z){f=D.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function Mh(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;fr||zl(),pr||(fr(),pr=!0),Po.add(c,s),s.v=0}}function Yo(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=Ir(S(s.Fa,s),Uh(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,Fh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=Ir(S(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Re(10),Fi(this),Fh(this))};function Xo(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function Fh(s){s.g=new It(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=it(s.qa);re(c,"RID","rpc"),re(c,"SID",s.K),re(c,"AID",s.T),re(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&re(c,"TO",s.ja),re(c,"TYPE","xmlhttp"),Dr(s,c),s.m&&s.o&&Qo(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=xi(it(c)),l.m=null,l.P=!0,lh(l,s)}n.Za=function(){this.C!=null&&(this.C=null,Fi(this),Yo(this),Re(19))};function Ui(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function Lh(s,c){var l=null;if(s.g==c){Ui(s),Xo(s),s.g=null;var f=2}else if(Ho(s.h,c))l=c.D,gh(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var T=s.B;f=Ri(),Ce(f,new oh(f,l)),Li(s)}else Mh(s);else if(T=c.s,T==3||T==0&&0<c.X||!(f==1&&e_(s,c)||f==2&&Yo(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),T){case 1:Gt(s,5);break;case 4:Gt(s,10);break;case 3:Gt(s,6);break;default:Gt(s,2)}}}function Uh(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function Gt(s,c){if(s.j.info("Error code "+c),c==2){var l=S(s.fb,s),f=s.Xa;let T=!f;f=new $t(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ni(f,"https"),xi(f),T?Hg(f.toString(),l):Kg(f.toString(),l)}else Re(2);s.G=0,s.l&&s.l.sa(c),Bh(s),Vh(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function Bh(s){if(s.G=0,s.ka=[],s.l){let c=_h(s.h);(c.length!=0||s.i.length!=0)&&(k(s.ka,c),k(s.ka,s.i),s.h.i.length=0,O(s.i),s.i.length=0),s.l.ra()}}function qh(s,c,l){var f=l instanceof $t?it(l):new $t(l);if(f.g!="")c&&(f.g=c+"."+f.g),Vi(f,f.s);else{var T=u.location;f=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;var b=new $t(null);f&&Ni(b,f),c&&(b.g=c),T&&Vi(b,T),l&&(b.l=l),f=b}return l=s.D,c=s.ya,l&&c&&re(f,l,c),re(f,"VER",s.la),Dr(s,f),f}function jh(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new oe(new Sr({eb:l})):new oe(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function $h(){}n=$h.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Bi(){}Bi.prototype.g=function(s,c){return new De(s,c)};function De(s,c){Ie.call(this),this.g=new Nh(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!H(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!H(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new vn(this)}N(De,Ie),De.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},De.prototype.close=function(){Jo(this.g)},De.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=Lo(s),s=l);c.i.push(new Fg(c.Ya++,s)),c.G==3&&Li(c)},De.prototype.N=function(){this.g.l=null,delete this.j,Jo(this.g),delete this.g,De.aa.N.call(this)};function Gh(s){Bo.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}N(Gh,Bo);function zh(){qo.call(this),this.status=1}N(zh,qo);function vn(s){this.g=s}N(vn,$h),vn.prototype.ua=function(){Ce(this.g,"a")},vn.prototype.ta=function(s){Ce(this.g,new Gh(s))},vn.prototype.sa=function(s){Ce(this.g,new zh)},vn.prototype.ra=function(){Ce(this.g,"b")},Bi.prototype.createWebChannel=Bi.prototype.g,De.prototype.send=De.prototype.o,De.prototype.open=De.prototype.m,De.prototype.close=De.prototype.close,Fc=ft.createWebChannelTransport=function(){return new Bi},Mc=ft.getStatEventTarget=function(){return Ri()},Oc=ft.Event=qt,Os=ft.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pi.NO_ERROR=0,Pi.TIMEOUT=8,Pi.HTTP_ERROR=6,ti=ft.ErrorCode=Pi,ah.COMPLETE="complete",xc=ft.EventType=ah,nh.EventType=yr,yr.OPEN="a",yr.CLOSE="b",yr.ERROR="c",yr.MESSAGE="d",Ie.prototype.listen=Ie.prototype.K,Bn=ft.WebChannel=nh,Vc=ft.FetchXmlHttpFactory=Sr,oe.prototype.listenOnce=oe.prototype.L,oe.prototype.getLastError=oe.prototype.Ka,oe.prototype.getLastErrorCode=oe.prototype.Ba,oe.prototype.getStatus=oe.prototype.Z,oe.prototype.getResponseJson=oe.prototype.Oa,oe.prototype.getResponseText=oe.prototype.oa,oe.prototype.send=oe.prototype.ea,oe.prototype.setWithCredentials=oe.prototype.Ha,Nc=ft.XhrIo=oe}).apply(typeof xs<"u"?xs:typeof self<"u"?self:typeof window<"u"?window:{});var gp="@firebase/firestore";var me=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};me.UNAUTHENTICATED=new me(null),me.GOOGLE_CREDENTIALS=new me("google-credentials-uid"),me.FIRST_PARTY=new me("first-party-uid"),me.MOCK_USER=new me("mock-user");var ar="10.13.1";var cn=new Ct("@firebase/firestore");function ni(){return cn.logLevel}function x(n,...e){if(cn.logLevel<=z.DEBUG){let t=e.map(Al);cn.debug(`Firestore (${ar}): ${n}`,...t)}}function mt(n,...e){if(cn.logLevel<=z.ERROR){let t=e.map(Al);cn.error(`Firestore (${ar}): ${n}`,...t)}}function Hn(n,...e){if(cn.logLevel<=z.WARN){let t=e.map(Al);cn.warn(`Firestore (${ar}): ${n}`,...t)}}function Al(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function B(n="Unexpected state"){let e=`FIRESTORE (${ar}) INTERNAL ASSERTION FAILED: `+n;throw mt(e),new Error(e)}function te(n,e){n||B()}function q(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},V=class extends ke{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var pt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Bs=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},jc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(me.UNAUTHENTICATED))}shutdown(){}},$c=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Gc=class{constructor(e){this.t=e,this.currentUser=me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new pt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new pt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>y(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new pt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string"),new Bs(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string"),new me(e)}},zc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=me.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Wc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new zc(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(me.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Hc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Kc=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=o=>{o.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,x("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(te(typeof t.token=="string"),this.R=t.token,new Hc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function LE(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var qs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=LE(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function Y(n,e){return n<e?-1:n>e?1:0}function Kn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var ye=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new V(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var j=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ye(0,0))}static max(){return new n(new ye(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var js=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(),r===void 0?r=e.length-t:r>e.length-t&&B(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),a=t.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},se=class n extends js{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new V(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},UE=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ve=class n extends js{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return UE.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new V(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new V(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new V(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new V(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(se.fromString(e))}static fromName(e){return new n(se.fromString(e).popFirst(5))}static empty(){return new n(se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return se.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new se(e.slice()))}};var Qc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Qc.UNKNOWN_ID=-1;function BE(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=j.fromTimestamp(r===1e9?new ye(t+1,0):new ye(t,r));return new un(i,L.empty(),e)}function qE(n){return new un(n.readTime,n.key,-1)}var un=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(j.min(),L.empty(),-1)}static max(){return new n(j.max(),L.empty(),-1)}};function jE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:Y(n.largestBatchId,e.largestBatchId))}var $E="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Jc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ei(n){return y(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==$E)throw n;x("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function GE(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function wi(n){return n.name==="IndexedDbTransactionError"}var Yp=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function _o(n){return n==null}function ui(n){return n===0&&1/n==-1/0}function zE(n){return typeof n=="number"&&Number.isInteger(n)&&!ui(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var WE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ab=[...WE,"documentOverlays"],HE=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],KE=HE,QE=[...KE,"indexConfiguration","indexState","indexEntries"];var cb=[...QE,"globals"];function _p(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function cr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Xp(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ae=class n{constructor(e,t){this.comparator=e,this.root=t||Ze.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ze.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ze.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gn(this.root,e,this.comparator,!0)}},Gn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ze=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();let e=this.left.check();if(e!==this.right.check())throw B();return e+(this.isRed()?0:1)}};Ze.EMPTY=null,Ze.RED=!0,Ze.BLACK=!1;Ze.EMPTY=new class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Ze(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ae=class n{constructor(e){this.comparator=e,this.data=new ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new $s(this.data.getIterator())}getIteratorFrom(e){return new $s(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},$s=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Xe=class n{constructor(e){this.fields=e,e.sort(Ve.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ae(Ve.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Gs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var be=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Gs("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};be.EMPTY_BYTE_STRING=new be("");var JE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gt(n){if(te(!!n),typeof n=="string"){let e=0,t=JE.exec(n);if(te(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ie(n.seconds),nanos:ie(n.nanos)}}function ie(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Lt(n){return typeof n=="string"?be.fromBase64String(n):be.fromUint8Array(n)}function bl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Sl(n){let e=n.mapValue.fields.__previous_value__;return bl(e)?Sl(e):e}function li(n){let e=gt(n.mapValue.fields.__local_write_time__.timestampValue);return new ye(e.seconds,e.nanos)}var Yc=class{constructor(e,t,r,i,o,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d}},zs=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ms={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ln(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?bl(n)?4:em(n)?9007199254740991:Zp(n)?10:11:B()}function nt(n,e){if(n===e)return!0;let t=ln(n);if(t!==ln(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return li(n).isEqual(li(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=gt(i.timestampValue),u=gt(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Lt(i.bytesValue).isEqual(Lt(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return ie(i.geoPointValue.latitude)===ie(o.geoPointValue.latitude)&&ie(i.geoPointValue.longitude)===ie(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return ie(i.integerValue)===ie(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=ie(i.doubleValue),u=ie(o.doubleValue);return a===u?ui(a)===ui(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return Kn(n.arrayValue.values||[],e.arrayValue.values||[],nt);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(_p(a)!==_p(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!nt(a[h],u[h])))return!1;return!0}(n,e);default:return B()}}function hi(n,e){return(n.values||[]).find(t=>nt(t,e))!==void 0}function Qn(n,e){if(n===e)return 0;let t=ln(n),r=ln(e);if(t!==r)return Y(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Y(n.booleanValue,e.booleanValue);case 2:return function(o,a){let u=ie(o.integerValue||o.doubleValue),h=ie(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return yp(n.timestampValue,e.timestampValue);case 4:return yp(li(n),li(e));case 5:return Y(n.stringValue,e.stringValue);case 6:return function(o,a){let u=Lt(o),h=Lt(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=Y(u[d],h[d]);if(p!==0)return p}return Y(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let u=Y(ie(o.latitude),ie(a.latitude));return u!==0?u:Y(ie(o.longitude),ie(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return vp(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,h,d,p;let I=o.fields||{},S=a.fields||{},R=(u=I.value)===null||u===void 0?void 0:u.arrayValue,N=(h=S.value)===null||h===void 0?void 0:h.arrayValue,O=Y(((d=R?.values)===null||d===void 0?void 0:d.length)||0,((p=N?.values)===null||p===void 0?void 0:p.length)||0);return O!==0?O:vp(R,N)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===Ms.mapValue&&a===Ms.mapValue)return 0;if(o===Ms.mapValue)return 1;if(a===Ms.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let I=0;I<h.length&&I<p.length;++I){let S=Y(h[I],p[I]);if(S!==0)return S;let R=Qn(u[h[I]],d[p[I]]);if(R!==0)return R}return Y(h.length,p.length)}(n.mapValue,e.mapValue);default:throw B()}}function yp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Y(n,e);let t=gt(n),r=gt(e),i=Y(t.seconds,r.seconds);return i!==0?i:Y(t.nanos,r.nanos)}function vp(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Qn(t[i],r[i]);if(o)return o}return Y(t.length,r.length)}function Jn(n){return Xc(n)}function Xc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=gt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Lt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return L.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Xc(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${Xc(t.fields[a])}`;return i+"}"}(n.mapValue):B()}function Ip(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Zc(n){return!!n&&"integerValue"in n}function Cl(n){return!!n&&"arrayValue"in n}function Ep(n){return!!n&&"nullValue"in n}function wp(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ls(n){return!!n&&"mapValue"in n}function Zp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ii(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return cr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ii(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ii(n.arrayValue.values[t]);return e}return Object.assign({},n)}function em(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var je=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ls(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ii(t)}setAll(e){let t=Ve.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=ii(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Ls(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ls(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){cr(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(ii(this.value))}};function tm(n){let e=[];return cr(n.fields,(t,r)=>{let i=new Ve([t]);if(Ls(r)){let o=tm(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new Xe(e)}var $e=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,j.min(),j.min(),j.min(),je.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,j.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,j.min(),j.min(),je.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,j.min(),j.min(),je.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=je.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=je.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Yn=class{constructor(e,t){this.position=e,this.inclusive=t}};function Tp(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),t.key):r=Qn(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ap(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!nt(n.position[t],e.position[t]))return!1;return!0}var Xn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function YE(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ws=class{},he=class n extends Ws{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new tu(e,t,r):t==="array-contains"?new iu(e,r):t==="in"?new su(e,r):t==="not-in"?new ou(e,r):t==="array-contains-any"?new au(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new nu(e,r):new ru(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Qn(t,this.value)):t!==null&&ln(this.value)===ln(t)&&this.matchesComparison(Qn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ge=class n extends Ws{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return nm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function nm(n){return n.op==="and"}function rm(n){return XE(n)&&nm(n)}function XE(n){for(let e of n.filters)if(e instanceof Ge)return!1;return!0}function eu(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+Jn(n.value);if(rm(n))return n.filters.map(e=>eu(e)).join(",");{let e=n.filters.map(t=>eu(t)).join(",");return`${n.op}(${e})`}}function im(n,e){return n instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&nt(r.value,i.value)}(n,e):n instanceof Ge?function(r,i){return i instanceof Ge&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&im(a,i.filters[u]),!0):!1}(n,e):void B()}function sm(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${Jn(t.value)}`}(n):n instanceof Ge?function(t){return t.op.toString()+" {"+t.getFilters().map(sm).join(" ,")+"}"}(n):"Filter"}var tu=class extends he{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},nu=class extends he{constructor(e,t){super(e,"in",t),this.keys=om("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ru=class extends he{constructor(e,t){super(e,"not-in",t),this.keys=om("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function om(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var iu=class extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Cl(t)&&hi(t.arrayValue,this.value)}},su=class extends he{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&hi(this.value.arrayValue,t)}},ou=class extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(hi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!hi(this.value.arrayValue,t)}},au=class extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Cl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>hi(this.value.arrayValue,r))}};var cu=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}};function bp(n,e=null,t=[],r=[],i=null,o=null,a=null){return new cu(n,e,t,r,i,o,a)}function Rl(n){let e=q(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>eu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),_o(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Jn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Jn(r)).join(",")),e.ue=t}return e.ue}function Pl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!YE(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!im(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ap(n.startAt,e.startAt)&&Ap(n.endAt,e.endAt)}function uu(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var hn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function ZE(n,e,t,r,i,o,a,u){return new hn(n,e,t,r,i,o,a,u)}function Dl(n){return new hn(n)}function Sp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function am(n){return n.collectionGroup!==null}function si(n){let e=q(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Ae(Ve.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Xn(o,r))}),t.has(Ve.keyField().canonicalString())||e.ce.push(new Xn(Ve.keyField(),r))}return e.ce}function et(n){let e=q(n);return e.le||(e.le=ew(e,si(n))),e.le}function ew(n,e){if(n.limitType==="F")return bp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Xn(i.field,o)});let t=n.endAt?new Yn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Yn(n.startAt.position,n.startAt.inclusive):null;return bp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function lu(n,e){let t=n.filters.concat([e]);return new hn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function hu(n,e,t){return new hn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function yo(n,e){return Pl(et(n),et(e))&&n.limitType===e.limitType}function cm(n){return`${Rl(et(n))}|lt:${n.limitType}`}function qn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>sm(i)).join(", ")}]`),_o(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Jn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Jn(i)).join(",")),`Target(${r})`}(et(n))}; limitType=${n.limitType})`}function vo(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):L.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of si(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=Tp(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,si(r),i)||r.endAt&&!function(a,u,h){let d=Tp(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,si(r),i))}(n,e)}function tw(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function um(n){return(e,t)=>{let r=!1;for(let i of si(n)){let o=nw(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function nw(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Qn(h,d):B()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B()}}var Ut=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){cr(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return Xp(this.inner)}size(){return this.innerSize}};var rw=new ae(L.comparator);function _t(){return rw}var lm=new ae(L.comparator);function ri(...n){let e=lm;for(let t of n)e=e.insert(t.key,t);return e}function hm(n){let e=lm;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function rn(){return oi()}function dm(){return oi()}function oi(){return new Ut(n=>n.toString(),(n,e)=>n.isEqual(e))}var iw=new ae(L.comparator),sw=new Ae(L.comparator);function W(...n){let e=sw;for(let t of n)e=e.add(t);return e}var ow=new Ae(Y);function aw(){return ow}function kl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ui(e)?"-0":e}}function fm(n){return{integerValue:""+n}}function cw(n,e){return zE(e)?fm(e):kl(n,e)}var Zn=class{constructor(){this._=void 0}};function uw(n,e,t){return n instanceof er?function(i,o){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&bl(o)&&(o=Sl(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(t,e):n instanceof dn?mm(n,e):n instanceof fn?gm(n,e):function(i,o){let a=pm(i,o),u=Cp(a)+Cp(i.Pe);return Zc(a)&&Zc(i.Pe)?fm(u):kl(i.serializer,u)}(n,e)}function lw(n,e,t){return n instanceof dn?mm(n,e):n instanceof fn?gm(n,e):t}function pm(n,e){return n instanceof tr?function(r){return Zc(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var er=class extends Zn{},dn=class extends Zn{constructor(e){super(),this.elements=e}};function mm(n,e){let t=_m(e);for(let r of n.elements)t.some(i=>nt(i,r))||t.push(r);return{arrayValue:{values:t}}}var fn=class extends Zn{constructor(e){super(),this.elements=e}};function gm(n,e){let t=_m(e);for(let r of n.elements)t=t.filter(i=>!nt(i,r));return{arrayValue:{values:t}}}var tr=class extends Zn{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Cp(n){return ie(n.integerValue||n.doubleValue)}function _m(n){return Cl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function hw(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof dn&&i instanceof dn||r instanceof fn&&i instanceof fn?Kn(r.elements,i.elements,nt):r instanceof tr&&i instanceof tr?nt(r.Pe,i.Pe):r instanceof er&&i instanceof er}(n.transform,e.transform)}var du=class{constructor(e,t){this.version=e,this.transformResults=t}},an=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Us(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var nr=class{};function ym(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Hs(n.key,an.none()):new pn(n.key,n.data,an.none());{let t=n.data,r=je.empty(),i=new Ae(Ve.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new yt(n.key,r,new Xe(i.toArray()),an.none())}}function dw(n,e,t){n instanceof pn?function(i,o,a){let u=i.value.clone(),h=Pp(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof yt?function(i,o,a){if(!Us(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=Pp(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(vm(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function ai(n,e,t,r){return n instanceof pn?function(o,a,u,h){if(!Us(o.precondition,a))return u;let d=o.value.clone(),p=Dp(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof yt?function(o,a,u,h){if(!Us(o.precondition,a))return u;let d=Dp(o.fieldTransforms,h,a),p=a.data;return p.setAll(vm(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(I=>I.field))}(n,e,t,r):function(o,a,u){return Us(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function fw(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=pm(r.transform,i||null);o!=null&&(t===null&&(t=je.empty()),t.set(r.field,o))}return t||null}function Rp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Kn(r,i,(o,a)=>hw(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var pn=class extends nr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},yt=class extends nr{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function vm(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Pp(n,e,t){let r=new Map;te(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,lw(a,u,t[i]))}return r}function Dp(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,uw(o,a,e))}return r}var Hs=class extends nr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},fu=class extends nr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var pu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&dw(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ai(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ai(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=dm();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=ym(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(j.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),W())}isEqual(e){return this.batchId===e.batchId&&Kn(this.mutations,e.mutations,(t,r)=>Rp(t,r))&&Kn(this.baseMutations,e.baseMutations,(t,r)=>Rp(t,r))}},mu=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){te(e.mutations.length===r.length);let i=function(){return iw}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var gu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var _u=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ue,Q;function pw(n){switch(n){default:return B();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function Im(n){if(n===void 0)return mt("GRPC error has no .code"),C.UNKNOWN;switch(n){case ue.OK:return C.OK;case ue.CANCELLED:return C.CANCELLED;case ue.UNKNOWN:return C.UNKNOWN;case ue.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case ue.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case ue.INTERNAL:return C.INTERNAL;case ue.UNAVAILABLE:return C.UNAVAILABLE;case ue.UNAUTHENTICATED:return C.UNAUTHENTICATED;case ue.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case ue.NOT_FOUND:return C.NOT_FOUND;case ue.ALREADY_EXISTS:return C.ALREADY_EXISTS;case ue.PERMISSION_DENIED:return C.PERMISSION_DENIED;case ue.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case ue.ABORTED:return C.ABORTED;case ue.OUT_OF_RANGE:return C.OUT_OF_RANGE;case ue.UNIMPLEMENTED:return C.UNIMPLEMENTED;case ue.DATA_LOSS:return C.DATA_LOSS;default:return B()}}(Q=ue||(ue={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";var kp=null;function mw(){return new TextEncoder}var gw=new Mt([4294967295,4294967295],0);function Np(n){let e=mw().encode(n),t=new kc;return t.update(e),new Uint8Array(t.digest())}function Vp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Mt([t,r],0),new Mt([i,o],0)]}var yu=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new sn(`Invalid padding: ${t}`);if(r<0)throw new sn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new sn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new sn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Mt.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Mt.fromNumber(r)));return i.compare(gw)===1&&(i=new Mt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Np(e),[r,i]=Vp(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=Np(e),[r,i]=Vp(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},sn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ks=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,di.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(j.min(),i,new ae(Y),_t(),W())}},di=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,W(),W(),W())}};var zn=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Qs=class{constructor(e,t){this.targetId=e,this.me=t}},Js=class{constructor(e,t,r=be.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ys=class{constructor(){this.fe=0,this.ge=Op(),this.pe=be.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=W(),t=W(),r=W();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:B()}}),new di(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Op()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},vu=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=_t(),this.qe=xp(),this.Qe=new ae(Y)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:B()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(uu(o))if(r===0){let a=new L(o.path);this.Ue(t,a,$e.newNoDocument(a,j.min()))}else te(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),h=u?this.Xe(u,e,a):1;if(h!==0){this.je(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}kp?.et(function(p,I,S,R,N){var O,k,$,H,K,ne;let Se={localCacheCount:p,existenceFilterCount:I.count,databaseId:S.database,projectId:S.projectId},X=I.unchangedNames;return X&&(Se.bloomFilter={applied:N===0,hashCount:(O=X?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(H=($=(k=X?.bits)===null||k===void 0?void 0:k.bitmap)===null||$===void 0?void 0:$.length)!==null&&H!==void 0?H:0,padding:(ne=(K=X?.bits)===null||K===void 0?void 0:K.padding)!==null&&ne!==void 0?ne:0,mightContain:E=>{var m;return(m=R?.mightContain(E))!==null&&m!==void 0&&m}}),Se}(a,e.me,this.Le.tt(),u,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=Lt(r).toUint8Array()}catch(h){if(h instanceof Gs)return Hn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new yu(a,i,o)}catch(h){return Hn(h instanceof sn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,a)=>{let u=this.Je(a);if(u){if(o.current&&uu(u.target)){let h=new L(u.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,$e.newNoDocument(h,e))}o.be&&(t.set(a,o.ve()),o.Ce())}});let r=W();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let d=this.Je(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));let i=new Ks(e,t,this.Qe,this.ke,r);return this.ke=_t(),this.qe=xp(),this.Qe=new ae(Y),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ys,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ae(Y),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||x("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ys),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function xp(){return new ae(L.comparator)}function Op(){return new ae(L.comparator)}var _w={asc:"ASCENDING",desc:"DESCENDING"},yw={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vw={and:"AND",or:"OR"},Iu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Eu(n,e){return n.useProto3Json||_o(e)?e:{value:e}}function Xs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Em(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Iw(n,e){return Xs(n,e.toTimestamp())}function tt(n){return te(!!n),j.fromTimestamp(function(t){let r=gt(t);return new ye(r.seconds,r.nanos)}(n))}function Nl(n,e){return wu(n,e).canonicalString()}function wu(n,e){let t=function(i){return new se(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function wm(n){let e=se.fromString(n);return te(Cm(e)),e}function Tu(n,e){return Nl(n.databaseId,e.path)}function Lc(n,e){let t=wm(e);if(t.get(1)!==n.databaseId.projectId)throw new V(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new V(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(Am(t))}function Tm(n,e){return Nl(n.databaseId,e)}function Ew(n){let e=wm(n);return e.length===4?se.emptyPath():Am(e)}function Au(n){return new se(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Am(n){return te(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Mp(n,e,t){return{name:Tu(n,e),fields:t.value.mapValue.fields}}function ww(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:B()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(te(p===void 0||typeof p=="string"),be.fromBase64String(p||"")):(te(p===void 0||p instanceof Buffer||p instanceof Uint8Array),be.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?C.UNKNOWN:Im(d.code);return new V(p,d.message||"")}(a);t=new Js(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Lc(n,r.document.name),o=tt(r.document.updateTime),a=r.document.createTime?tt(r.document.createTime):j.min(),u=new je({mapValue:{fields:r.document.fields}}),h=$e.newFoundDocument(i,o,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new zn(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Lc(n,r.document),o=r.readTime?tt(r.readTime):j.min(),a=$e.newNoDocument(i,o),u=r.removedTargetIds||[];t=new zn([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Lc(n,r.document),o=r.removedTargetIds||[];t=new zn([],o,i,null)}else{if(!("filter"in e))return B();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new _u(i,o),u=r.targetId;t=new Qs(u,a)}}return t}function Tw(n,e){let t;if(e instanceof pn)t={update:Mp(n,e.key,e.value)};else if(e instanceof Hs)t={delete:Tu(n,e.key)};else if(e instanceof yt)t={update:Mp(n,e.key,e.data),updateMask:Nw(e.fieldMask)};else{if(!(e instanceof fu))return B();t={verify:Tu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let u=a.transform;if(u instanceof er)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof dn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof fn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof tr)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw B()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:Iw(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:B()}(n,e.precondition)),t}function Aw(n,e){return n&&n.length>0?(te(e!==void 0),n.map(t=>function(i,o){let a=i.updateTime?tt(i.updateTime):tt(o);return a.isEqual(j.min())&&(a=tt(o)),new du(a,i.transformResults||[])}(t,e))):[]}function bw(n,e){return{documents:[Tm(n,e.path)]}}function Sw(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Tm(n,i);let o=function(d){if(d.length!==0)return Sm(Ge.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(p=>function(S){return{field:jn(S.field),direction:Pw(S.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Eu(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function Cw(n){let e=Ew(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){te(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(I){let S=bm(I);return S instanceof Ge&&rm(S)?S.getFilters():[S]}(t.where));let a=[];t.orderBy&&(a=function(I){return I.map(S=>function(N){return new Xn($n(N.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(S))}(t.orderBy));let u=null;t.limit&&(u=function(I){let S;return S=typeof I=="object"?I.value:I,_o(S)?null:S}(t.limit));let h=null;t.startAt&&(h=function(I){let S=!!I.before,R=I.values||[];return new Yn(R,S)}(t.startAt));let d=null;return t.endAt&&(d=function(I){let S=!I.before,R=I.values||[];return new Yn(R,S)}(t.endAt)),ZE(e,i,a,o,u,"F",h,d)}function Rw(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function bm(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=$n(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=$n(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=$n(t.unaryFilter.field);return he.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=$n(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});default:return B()}}(n):n.fieldFilter!==void 0?function(t){return he.create($n(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return B()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ge.create(t.compositeFilter.filters.map(r=>bm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B()}}(t.compositeFilter.op))}(n):B()}function Pw(n){return _w[n]}function Dw(n){return yw[n]}function kw(n){return vw[n]}function jn(n){return{fieldPath:n.canonicalString()}}function $n(n){return Ve.fromServerFormat(n.fieldPath)}function Sm(n){return n instanceof he?function(t){if(t.op==="=="){if(wp(t.value))return{unaryFilter:{field:jn(t.field),op:"IS_NAN"}};if(Ep(t.value))return{unaryFilter:{field:jn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(wp(t.value))return{unaryFilter:{field:jn(t.field),op:"IS_NOT_NAN"}};if(Ep(t.value))return{unaryFilter:{field:jn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jn(t.field),op:Dw(t.op),value:t.value}}}(n):n instanceof Ge?function(t){let r=t.getFilters().map(i=>Sm(i));return r.length===1?r[0]:{compositeFilter:{op:kw(t.op),filters:r}}}(n):B()}function Nw(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Cm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var fi=class n{constructor(e,t,r,i,o=j.min(),a=j.min(),u=be.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var bu=class{constructor(e){this.ct=e}};function Vw(n){let e=Cw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?hu(e,e.limit,"L"):e}var Zs=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ie(e.integerValue));else if("doubleValue"in e){let r=ie(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),ui(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=gt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Lt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?em(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Zp(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):B()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(ie(u)),this.Vt(a,t),this.Tt(o[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),L.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Zs.vt=new Zs;var Su=class{constructor(){this.un=new Cu}addToCollectionParentIndex(e,t){return this.un.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(un.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(un.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Cu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ae(se.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ae(se.comparator)).toArray()}};var lb=new Uint8Array(0);var Ye=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Ye.DEFAULT_COLLECTION_PERCENTILE=10,Ye.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ye.DEFAULT=new Ye(41943040,Ye.DEFAULT_COLLECTION_PERCENTILE,Ye.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ye.DISABLED=new Ye(-1,0,0);var pi=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Ru=class{constructor(){this.changes=new Ut(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$e.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Pu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Du=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ai(r.mutation,i,Xe.empty(),ye.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,W()).next(()=>r))}getLocalViewOfDocuments(e,t,r=W()){let i=rn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=ri();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=rn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,W()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=_t(),a=oi(),u=function(){return oi()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof yt)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),ai(p.mutation,d,p.mutation.getFieldMask(),ye.now())):a.set(d.key,Xe.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var I;return u.set(d,new Pu(p,(I=a.get(d))!==null&&I!==void 0?I:null))}),u))}recalculateAndSaveOverlays(e,t){let r=oi(),i=new ae((a,u)=>a-u),o=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||Xe.empty();p=u.applyToLocalView(d,p),r.set(h,p);let I=(i.get(u.batchId)||W()).add(h);i=i.insert(u.batchId,I)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,I=dm();p.forEach(S=>{if(!o.has(S)){let R=ym(t.get(S),r.get(S));R!==null&&I.set(S,R),o=o.add(S)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,I))}return P.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):am(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):P.resolve(rn()),u=-1,h=o;return a.next(d=>P.forEach(d,(p,I)=>(u<I.largestBatchId&&(u=I.largestBatchId),o.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(S=>{h=h.insert(p,S)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,W())).next(p=>({batchId:u,changes:hm(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let i=ri();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=ri();return this.indexManager.getCollectionParents(e,o).next(u=>P.forEach(u,h=>{let d=function(I,S){return new hn(S,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((I,S)=>{a=a.insert(I,S)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,$e.newInvalidDocument(p)))});let u=ri();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&ai(p.mutation,d,Xe.empty(),ye.now()),vo(t,d)&&(u=u.insert(h,d))}),u})}};var ku=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return P.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:tt(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:Vw(i.bundledQuery),readTime:tt(i.readTime)}}(t)),P.resolve()}};var Nu=class{constructor(){this.overlays=new ae(L.comparator),this.Ir=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=rn();return P.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=rn(),o=t.length+1,a=new L(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ae((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=rn(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=rn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return P.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new gu(t,r));let o=this.Ir.get(t);o===void 0&&(o=W(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var Vu=class{constructor(){this.sessionToken=be.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var mi=class{constructor(){this.Tr=new Ae(le.Er),this.dr=new Ae(le.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new le(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new le(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new L(new se([])),r=new le(t,e),i=new le(t,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new L(new se([])),r=new le(t,e),i=new le(t,e+1),o=W();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new le(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},le=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return L.comparator(e.key,t.key)||Y(e.wr,t.wr)}static Ar(e,t){return Y(e.wr,t.wr)||L.comparator(e.key,t.key)}};var xu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ae(le.Er)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new pu(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new le(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return P.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new le(t,0),i=new le(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);o.push(u)}),P.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ae(Y);return t.forEach(i=>{let o=new le(i,0),a=new le(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),P.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;L.isDocumentKey(o)||(o=o.child(""));let a=new le(new L(o),0),u=new Ae(Y);return this.br.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.wr)),!0)},a),P.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){te(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return P.forEach(t.mutations,i=>{let o=new le(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new le(t,0),i=this.br.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ou=class{constructor(e){this.Mr=e,this.docs=function(){return new ae(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():$e.newInvalidDocument(t))}getEntries(e,t){let r=_t();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():$e.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=_t(),a=t.path,u=new L(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||jE(qE(p),r)<=0||(i.has(p.key)||vo(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return P.resolve(o)}getAllFromCollectionGroup(e,t,r,i){B()}Or(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Mu(this)}getSize(e){return P.resolve(this.size)}},Mu=class extends Ru{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Fu=class{constructor(e){this.persistence=e,this.Nr=new Ut(t=>Rl(t),Pl),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.Lr=0,this.Br=new mi,this.targetCount=0,this.kr=pi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),P.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new pi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.Kn(t),P.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),P.waitFor(o).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),P.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Br.containsKey(t))}};var Lu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Yp(0),this.Kr=!1,this.Kr=!0,this.$r=new Vu,this.referenceDelegate=e(this),this.Ur=new Fu(this),this.indexManager=new Su,this.remoteDocumentCache=function(i){return new Ou(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new bu(t),this.Gr=new ku(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Nu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new xu(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){x("MemoryPersistence","Starting transaction:",e);let i=new Uu(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return P.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Uu=class extends Jc{constructor(e){super(),this.currentSequenceNumber=e}},Bu=class n{constructor(e){this.persistence=e,this.Jr=new mi,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw B()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),P.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Xr,r=>{let i=L.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,j.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return P.or([()=>P.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var qu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=W(),i=W();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var ju=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var $u=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Cd()?8:GE(pe())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new ju;return this.Xi(e,t,a).next(u=>{if(o.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(ni()<=z.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",qn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),P.resolve()):(ni()<=z.DEBUG&&x("QueryEngine","Query:",qn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(ni()<=z.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",qn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,et(t))):P.resolve())}Yi(e,t){if(Sp(t))return P.resolve(null);let r=et(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=hu(t,null,"F"),r=et(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=W(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ts(t,u);return this.ns(t,d,a,h.readTime)?this.Yi(e,hu(t,null,"F")):this.rs(e,d,t,h)}))})))}Zi(e,t,r,i){return Sp(t)||i.isEqual(j.min())?P.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let a=this.ts(t,o);return this.ns(t,a,r,i)?P.resolve(null):(ni()<=z.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),qn(t)),this.rs(e,a,t,BE(i,-1)).next(u=>u))})}ts(e,t){let r=new Ae(um(e));return t.forEach((i,o)=>{vo(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return ni()<=z.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",qn(t)),this.Ji.getDocumentsMatchingQuery(e,t,un.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var Gu=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ae(Y),this._s=new Ut(o=>Rl(o),Pl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Du(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function xw(n,e,t,r){return new Gu(n,e,t,r)}function Rm(n,e){return y(this,null,function*(){let t=q(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=W();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function Ow(n,e){let t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let I=d.batch,S=I.keys(),R=P.resolve();return S.forEach(N=>{R=R.next(()=>p.getEntry(h,N)).next(O=>{let k=d.docVersions.get(N);te(k!==null),O.version.compareTo(k)<0&&(I.applyToRemoteDocument(O,d),O.isValidDocument()&&(O.setReadTime(d.commitVersion),p.addEntry(O)))})}),R.next(()=>u.mutationQueue.removeMutationBatch(h,I))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=W();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Pm(n){let e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Mw(n,e){let t=q(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,I)=>{let S=i.get(I);if(!S)return;u.push(t.Ur.removeMatchingKeys(o,p.removedDocuments,I).next(()=>t.Ur.addMatchingKeys(o,p.addedDocuments,I)));let R=S.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(I)!==null?R=R.withResumeToken(be.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):p.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(p.resumeToken,r)),i=i.insert(I,R),function(O,k,$){return O.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0}(S,R,p)&&u.push(t.Ur.updateTargetData(o,R))});let h=_t(),d=W();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(Fw(o,a,e.documentUpdates).next(p=>{h=p.Ps,d=p.Is})),!r.isEqual(j.min())){let p=t.Ur.getLastRemoteSnapshotVersion(o).next(I=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(p)}return P.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.os=i,o))}function Fw(n,e,t){let r=W(),i=W();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=_t();return t.forEach((u,h)=>{let d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(j.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):x("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function Lw(n,e){let t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Uw(n,e){let t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,P.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new fi(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function zu(n,e,t){return y(this,null,function*(){let r=q(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!wi(a))throw a;x("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Fp(n,e,t){let r=q(n),i=j.min(),o=W();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let I=q(h),S=I._s.get(p);return S!==void 0?P.resolve(I.os.get(S)):I.Ur.getTargetData(d,p)}(r,a,et(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:j.min(),t?o:W())).next(u=>(Bw(r,tw(e),u),{documents:u,Ts:o})))}function Bw(n,e,t){let r=n.us.get(e)||j.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}var eo=class{constructor(){this.activeTargetIds=aw()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Wu=class{constructor(){this.so=new eo,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new eo,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Hu=class{_o(e){}shutdown(){}};var to=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){x("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){x("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Fs=null;function Uc(){return Fs===null?Fs=function(){return 268435456+Math.round(2147483648*Math.random())}():Fs++,"0x"+Fs.toString(16)}var qw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Ku=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Te="WebChannelConnection",Qu=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,a){let u=Uc(),h=this.xo(t,r.toUriEncodedString());x("RestConnection",`Sending RPC '${t}' ${u}:`,h,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,o,a),this.No(t,h,d,i).then(p=>(x("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw Hn("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",h,"request:",i),p})}Lo(t,r,i,o,a,u){return this.Mo(t,r,i,o,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ar}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>t[a]=o),i&&i.headers.forEach((o,a)=>t[a]=o)}xo(t,r){let i=qw[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=Uc();return new Promise((a,u)=>{let h=new Nc;h.setWithCredentials(!0),h.listenOnce(xc.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ti.NO_ERROR:let p=h.getResponseJson();x(Te,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case ti.TIMEOUT:x(Te,`RPC '${e}' ${o} timed out`),u(new V(C.DEADLINE_EXCEEDED,"Request time out"));break;case ti.HTTP_ERROR:let I=h.getStatus();if(x(Te,`RPC '${e}' ${o} failed with status:`,I,"response text:",h.getResponseText()),I>0){let S=h.getResponseJson();Array.isArray(S)&&(S=S[0]);let R=S?.error;if(R&&R.status&&R.message){let N=function(k){let $=k.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf($)>=0?$:C.UNKNOWN}(R.status);u(new V(N,R.message))}else u(new V(C.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new V(C.UNAVAILABLE,"Connection failed."));break;default:B()}}finally{x(Te,`RPC '${e}' ${o} completed.`)}});let d=JSON.stringify(i);x(Te,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=Uc(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Fc(),u=Mc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.xmlHttpFactory=new Vc({})),this.Oo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");x(Te,`Creating RPC '${e}' stream ${i}: ${p}`,h);let I=a.createWebChannel(p,h),S=!1,R=!1,N=new Ku({Io:k=>{R?x(Te,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(S||(x(Te,`Opening RPC '${e}' stream ${i} transport.`),I.open(),S=!0),x(Te,`RPC '${e}' stream ${i} sending:`,k),I.send(k))},To:()=>I.close()}),O=(k,$,H)=>{k.listen($,K=>{try{H(K)}catch(ne){setTimeout(()=>{throw ne},0)}})};return O(I,Bn.EventType.OPEN,()=>{R||(x(Te,`RPC '${e}' stream ${i} transport opened.`),N.yo())}),O(I,Bn.EventType.CLOSE,()=>{R||(R=!0,x(Te,`RPC '${e}' stream ${i} transport closed`),N.So())}),O(I,Bn.EventType.ERROR,k=>{R||(R=!0,Hn(Te,`RPC '${e}' stream ${i} transport errored:`,k),N.So(new V(C.UNAVAILABLE,"The operation could not be completed")))}),O(I,Bn.EventType.MESSAGE,k=>{var $;if(!R){let H=k.data[0];te(!!H);let K=H,ne=K.error||(($=K[0])===null||$===void 0?void 0:$.error);if(ne){x(Te,`RPC '${e}' stream ${i} received error:`,ne);let Se=ne.status,X=function(_){let v=ue[_];if(v!==void 0)return Im(v)}(Se),E=ne.message;X===void 0&&(X=C.INTERNAL,E="Unknown error status: "+Se+" with message "+ne.message),R=!0,N.So(new V(X,E)),I.close()}else x(Te,`RPC '${e}' stream ${i} received:`,H),N.bo(H)}}),O(u,Oc.STAT_EVENT,k=>{k.stat===Os.PROXY?x(Te,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===Os.NOPROXY&&x(Te,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}};function Bc(){return typeof document<"u"?document:null}function Io(n){return new Iu(n,!0)}var no=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&x("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var ro=class{constructor(e,t,r,i,o,a,u,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new no(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(mt(t.toString()),mt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new V(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return x("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(x("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Ju=class extends ro{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=ww(this.serializer,e),r=function(o){if(!("targetChange"in o))return j.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?tt(a.readTime):j.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Au(this.serializer),t.addTarget=function(o,a){let u,h=a.target;if(u=uu(h)?{documents:bw(o,h)}:{query:Sw(o,h)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Em(o,a.resumeToken);let d=Eu(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(j.min())>0){u.readTime=Xs(o,a.snapshotVersion.toTimestamp());let d=Eu(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=Rw(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Au(this.serializer),t.removeTarget=e,this.a_(t)}},Yu=class extends ro{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return te(!!e.streamToken),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=Aw(e.writeResults,e.commitTime),r=tt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Au(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Tw(this.serializer,r))};this.a_(t)}};var Xu=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new V(C.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,wu(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new V(C.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,wu(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new V(C.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Zu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(mt(t),this.D_=!1):x("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var el=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(()=>y(this,null,function*(){mn(this)&&(x("RemoteStore","Restarting streams for network reachability change."),yield function(h){return y(this,null,function*(){let d=q(h);d.L_.add(4),yield Ti(d),d.q_.set("Unknown"),d.L_.delete(4),yield Eo(d)})}(this))}))}),this.q_=new Zu(r,i)}};function Eo(n){return y(this,null,function*(){if(mn(n))for(let e of n.B_)yield e(!0)})}function Ti(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Dm(n,e){let t=q(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Ml(t)?Ol(t):ur(t).r_()&&xl(t,e))}function Vl(n,e){let t=q(n),r=ur(t);t.N_.delete(e),r.r_()&&km(t,e),t.N_.size===0&&(r.r_()?r.o_():mn(t)&&t.q_.set("Unknown"))}function xl(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ur(n).A_(e)}function km(n,e){n.Q_.xe(e),ur(n).R_(e)}function Ol(n){n.Q_=new vu({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ur(n).start(),n.q_.v_()}function Ml(n){return mn(n)&&!ur(n).n_()&&n.N_.size>0}function mn(n){return q(n).L_.size===0}function Nm(n){n.Q_=void 0}function jw(n){return y(this,null,function*(){n.q_.set("Online")})}function $w(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{xl(n,e)})})}function Gw(n,e){return y(this,null,function*(){Nm(n),Ml(n)?(n.q_.M_(e),Ol(n)):n.q_.set("Unknown")})}function zw(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof Js&&e.state===2&&e.cause)try{yield function(i,o){return y(this,null,function*(){let a=o.cause;for(let u of o.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){x("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield io(n,r)}else if(e instanceof zn?n.Q_.Ke(e):e instanceof Qs?n.Q_.He(e):n.Q_.We(e),!t.isEqual(j.min()))try{let r=yield Pm(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let u=o.Q_.rt(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o.N_.get(d);p&&o.N_.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=o.N_.get(h);if(!p)return;o.N_.set(h,p.withResumeToken(be.EMPTY_BYTE_STRING,p.snapshotVersion)),km(o,h);let I=new fi(p.target,h,d,p.sequenceNumber);xl(o,I)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){x("RemoteStore","Failed to raise snapshot:",r),yield io(n,r)}})}function io(n,e,t){return y(this,null,function*(){if(!wi(e))throw e;n.L_.add(1),yield Ti(n),n.q_.set("Offline"),t||(t=()=>Pm(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){x("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Eo(n)}))})}function Vm(n,e){return e().catch(t=>io(n,t,e))}function wo(n){return y(this,null,function*(){let e=q(n),t=Bt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Ww(e);)try{let i=yield Lw(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,Hw(e,i)}catch(i){yield io(e,i)}xm(e)&&Om(e)})}function Ww(n){return mn(n)&&n.O_.length<10}function Hw(n,e){n.O_.push(e);let t=Bt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function xm(n){return mn(n)&&!Bt(n).n_()&&n.O_.length>0}function Om(n){Bt(n).start()}function Kw(n){return y(this,null,function*(){Bt(n).p_()})}function Qw(n){return y(this,null,function*(){let e=Bt(n);for(let t of n.O_)e.m_(t.mutations)})}function Jw(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=mu.from(r,e,t);yield Vm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield wo(n)})}function Yw(n,e){return y(this,null,function*(){e&&Bt(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(a){return pw(a)&&a!==C.ABORTED}(i.code)){let o=r.O_.shift();Bt(r).s_(),yield Vm(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield wo(r)}})}(n,e)),xm(n)&&Om(n)})}function Lp(n,e){return y(this,null,function*(){let t=q(n);t.asyncQueue.verifyOperationInProgress(),x("RemoteStore","RemoteStore received new credentials");let r=mn(t);t.L_.add(3),yield Ti(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Eo(t)})}function Xw(n,e){return y(this,null,function*(){let t=q(n);e?(t.L_.delete(2),yield Eo(t)):e||(t.L_.add(2),yield Ti(t),t.q_.set("Unknown"))})}function ur(n){return n.K_||(n.K_=function(t,r,i){let o=q(t);return o.w_(),new Ju(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:jw.bind(null,n),Ro:$w.bind(null,n),mo:Gw.bind(null,n),d_:zw.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),Ml(n)?Ol(n):n.q_.set("Unknown")):(yield n.K_.stop(),Nm(n))}))),n.K_}function Bt(n){return n.U_||(n.U_=function(t,r,i){let o=q(t);return o.w_(),new Yu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Kw.bind(null,n),mo:Yw.bind(null,n),f_:Qw.bind(null,n),g_:Jw.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield wo(n)):(yield n.U_.stop(),n.O_.length>0&&(x("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var tl=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new pt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new V(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Fl(n,e){if(mt("AsyncQueue",`${e}: ${n}`),wi(n))return new V(C.UNAVAILABLE,`${e}: ${n}`);throw n}var so=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||L.comparator(t.key,r.key):(t,r)=>L.comparator(t.key,r.key),this.keyedMap=ri(),this.sortedSet=new ae(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var oo=class{constructor(){this.W_=new ae(L.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):B():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},rr=class n{constructor(e,t,r,i,o,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,so.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var nl=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},rl=class{constructor(){this.queries=Up(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=q(t),o=i.queries;i.queries=Up(),o.forEach((a,u)=>{for(let h of u.j_)h.onError(r)})})(this,new V(C.ABORTED,"Firestore shutting down"))}};function Up(){return new Ut(n=>cm(n),yo)}function Zw(n,e){return y(this,null,function*(){let t=q(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new nl,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=Fl(a,`Initialization of query '${qn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&Ll(t)})}function eT(n,e){return y(this,null,function*(){let t=q(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function tT(n,e){let t=q(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&Ll(t)}function nT(n,e,t){let r=q(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function Ll(n){n.Y_.forEach(e=>{e.next()})}var il,Bp;(Bp=il||(il={})).ea="default",Bp.Cache="cache";var sl=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new rr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=rr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==il.Cache}};var ao=class{constructor(e){this.key=e}},co=class{constructor(e){this.key=e}},ol=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=W(),this.mutatedKeys=W(),this.Aa=um(e),this.Ra=new so(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new oo,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,I)=>{let S=i.get(p),R=vo(this.query,I)?I:null,N=!!S&&this.mutatedKeys.has(S.key),O=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations),k=!1;S&&R?S.data.isEqual(R.data)?N!==O&&(r.track({type:3,doc:R}),k=!0):this.ga(S,R)||(r.track({type:2,doc:R}),k=!0,(h&&this.Aa(R,h)>0||d&&this.Aa(R,d)<0)&&(u=!0)):!S&&R?(r.track({type:0,doc:R}),k=!0):S&&!R&&(r.track({type:1,doc:S}),k=!0,(h||d)&&(u=!0)),k&&(R?(a=a.add(R),o=O?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,I)=>function(R,N){let O=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B()}};return O(R)-O(N)}(p.type,I.type)||this.Aa(p.doc,I.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,d=h!==this.Ea;return this.Ea=h,a.length!==0||d?{snapshot:new rr(this.query,e.Ra,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new oo,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=W(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new co(r))}),this.da.forEach(r=>{e.has(r)||t.push(new ao(r))}),t}ba(e){this.Ta=e.Ts,this.da=W();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return rr.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},al=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},cl=class{constructor(e){this.key=e,this.va=!1}},ul=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Ut(u=>cm(u),yo),this.Ma=new Map,this.xa=new Set,this.Oa=new ae(L.comparator),this.Na=new Map,this.La=new mi,this.Ba={},this.ka=new Map,this.qa=pi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function rT(n,e,t=!0){return y(this,null,function*(){let r=qm(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield Mm(r,e,t,!0),i})}function iT(n,e){return y(this,null,function*(){let t=qm(n);yield Mm(t,e,!0,!1)})}function Mm(n,e,t,r){return y(this,null,function*(){let i=yield Uw(n.localStore,et(e)),o=i.targetId,a=t?n.sharedClientState.addLocalQueryTarget(o):"not-current",u;return r&&(u=yield sT(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Dm(n.remoteStore,i),u})}function sT(n,e,t,r,i){return y(this,null,function*(){n.Ka=(I,S,R)=>function(O,k,$,H){return y(this,null,function*(){let K=k.view.ma($);K.ns&&(K=yield Fp(O.localStore,k.query,!1).then(({documents:E})=>k.view.ma(E,K)));let ne=H&&H.targetChanges.get(k.targetId),Se=H&&H.targetMismatches.get(k.targetId)!=null,X=k.view.applyChanges(K,O.isPrimaryClient,ne,Se);return jp(O,k.targetId,X.wa),X.snapshot})}(n,I,S,R);let o=yield Fp(n.localStore,e,!0),a=new ol(e,o.Ts),u=a.ma(o.documents),h=di.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);jp(n,t,d.wa);let p=new al(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function oT(n,e,t){return y(this,null,function*(){let r=q(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!yo(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield zu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Vl(r.remoteStore,i.targetId),ll(r,i.targetId)}).catch(Ei))):(ll(r,i.targetId),yield zu(r.localStore,i.targetId,!0))})}function aT(n,e){return y(this,null,function*(){let t=q(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Vl(t.remoteStore,r.targetId))})}function cT(n,e,t){return y(this,null,function*(){let r=mT(n);try{let i=yield function(a,u){let h=q(a),d=ye.now(),p=u.reduce((R,N)=>R.add(N.key),W()),I,S;return h.persistence.runTransaction("Locally write mutations","readwrite",R=>{let N=_t(),O=W();return h.cs.getEntries(R,p).next(k=>{N=k,N.forEach(($,H)=>{H.isValidDocument()||(O=O.add($))})}).next(()=>h.localDocuments.getOverlayedDocuments(R,N)).next(k=>{I=k;let $=[];for(let H of u){let K=fw(H,I.get(H.key).overlayedDocument);K!=null&&$.push(new yt(H.key,K,tm(K.value.mapValue),an.exists(!0)))}return h.mutationQueue.addMutationBatch(R,d,$,u)}).next(k=>{S=k;let $=k.applyToLocalDocumentSet(I,O);return h.documentOverlayCache.saveOverlays(R,k.batchId,$)})}).then(()=>({batchId:S.batchId,changes:hm(I)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let d=a.Ba[a.currentUser.toKey()];d||(d=new ae(Y)),d=d.insert(u,h),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield Ai(r,i.changes),yield wo(r.remoteStore)}catch(i){let o=Fl(i,"Failed to persist write");t.reject(o)}})}function Fm(n,e){return y(this,null,function*(){let t=q(n);try{let r=yield Mw(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Na.get(o);a&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?te(a.va):i.removedDocuments.size>0&&(te(a.va),a.va=!1))}),yield Ai(t,r,e)}catch(r){yield Ei(r)}})}function qp(n,e,t){let r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=q(a);h.onlineState=u;let d=!1;h.queries.forEach((p,I)=>{for(let S of I.j_)S.Z_(u)&&(d=!0)}),d&&Ll(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function uT(n,e,t){return y(this,null,function*(){let r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let a=new ae(L.comparator);a=a.insert(o,$e.newNoDocument(o,j.min()));let u=W().add(o),h=new Ks(j.min(),new Map,new ae(Y),a,u);yield Fm(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),Ul(r)}else yield zu(r.localStore,e,!1).then(()=>ll(r,e,t)).catch(Ei)})}function lT(n,e){return y(this,null,function*(){let t=q(n),r=e.batch.batchId;try{let i=yield Ow(t.localStore,e);Um(t,r,null),Lm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ai(t,i)}catch(i){yield Ei(i)}})}function hT(n,e,t){return y(this,null,function*(){let r=q(n);try{let i=yield function(a,u){let h=q(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(I=>(te(I!==null),p=I.keys(),h.mutationQueue.removeMutationBatch(d,I))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);Um(r,e,t),Lm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ai(r,i)}catch(i){yield Ei(i)}})}function Lm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Um(n,e,t){let r=q(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function ll(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Bm(n,r)})}function Bm(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Vl(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Ul(n))}function jp(n,e,t){for(let r of t)r instanceof ao?(n.La.addReference(r.key,e),dT(n,r)):r instanceof co?(x("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Bm(n,r.key)):B()}function dT(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(x("SyncEngine","New document in limbo: "+t),n.xa.add(r),Ul(n))}function Ul(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new L(se.fromString(e)),r=n.qa.next();n.Na.set(r,new cl(t)),n.Oa=n.Oa.insert(t,r),Dm(n.remoteStore,new fi(et(Dl(t.path)),r,"TargetPurposeLimboResolution",Yp.oe))}}function Ai(n,e,t){return y(this,null,function*(){let r=q(n),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,h)=>{a.push(r.Ka(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let I=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,I?"current":"not-current")}if(d){i.push(d);let I=qu.Wi(h.targetId,d);o.push(I)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(h,d){return y(this,null,function*(){let p=q(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>P.forEach(d,S=>P.forEach(S.$i,R=>p.persistence.referenceDelegate.addReference(I,S.targetId,R)).next(()=>P.forEach(S.Ui,R=>p.persistence.referenceDelegate.removeReference(I,S.targetId,R)))))}catch(I){if(!wi(I))throw I;x("LocalStore","Failed to update sequence numbers: "+I)}for(let I of d){let S=I.targetId;if(!I.fromCache){let R=p.os.get(S),N=R.snapshotVersion,O=R.withLastLimboFreeSnapshotVersion(N);p.os=p.os.insert(S,O)}}})}(r.localStore,o))})}function fT(n,e){return y(this,null,function*(){let t=q(n);if(!t.currentUser.isEqual(e)){x("SyncEngine","User change. New user:",e.toKey());let r=yield Rm(t.localStore,e);t.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(h=>{h.reject(new V(C.CANCELLED,a))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ai(t,r.hs)}})}function pT(n,e){let t=q(n),r=t.Na.get(e);if(r&&r.va)return W().add(r.key);{let i=W(),o=t.Ma.get(e);if(!o)return i;for(let a of o){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function qm(n){let e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Fm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uT.bind(null,e),e.Ca.d_=tT.bind(null,e.eventManager),e.Ca.$a=nT.bind(null,e.eventManager),e}function mT(n){let e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hT.bind(null,e),e}var uo=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=Io(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return xw(this.persistence,new $u,e.initialUser,this.serializer)}createPersistence(e){return new Lu(Bu.Zr,this.serializer)}createSharedClientState(e){return new Wu}terminate(){return y(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var hl=class{initialize(e,t){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>qp(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fT.bind(null,this.syncEngine),yield Xw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new rl}()}createDatastore(e){let t=Io(e.databaseInfo.databaseId),r=function(o){return new Qu(o)}(e.databaseInfo);return function(o,a,u,h){return new Xu(o,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,a,u){return new el(r,i,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>qp(this.syncEngine,t,0),function(){return to.D()?new to:new Hu}())}createSyncEngine(e,t){return function(i,o,a,u,h,d,p){let I=new ul(i,o,a,u,h,d);return p&&(I.Qa=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return y(this,null,function*(){var e,t;yield function(i){return y(this,null,function*(){let o=q(i);x("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield Ti(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};var dl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):mt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var fl=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=me.UNAUTHENTICATED,this.clientId=qs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,o=>y(this,null,function*(){x("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(x("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new V(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new pt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Fl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function qc(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),x("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield Rm(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function $p(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield _T(n);x("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Lp(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Lp(e.remoteStore,i)),n._onlineComponents=e})}function gT(n){return n.name==="FirebaseError"?n.code===C.FAILED_PRECONDITION||n.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function _T(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){x("FirestoreClient","Using user provided OfflineComponentProvider");try{yield qc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!gT(t))throw t;Hn("Error using user provided cache. Falling back to memory cache: "+t),yield qc(n,new uo)}}else x("FirestoreClient","Using default OfflineComponentProvider"),yield qc(n,new uo);return n._offlineComponents})}function jm(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(x("FirestoreClient","Using user provided OnlineComponentProvider"),yield $p(n,n._uninitializedComponentsProvider._online)):(x("FirestoreClient","Using default OnlineComponentProvider"),yield $p(n,new hl))),n._onlineComponents})}function yT(n){return jm(n).then(e=>e.syncEngine)}function Gp(n){return y(this,null,function*(){let e=yield jm(n),t=e.eventManager;return t.onListen=rT.bind(null,e.syncEngine),t.onUnlisten=oT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=iT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=aT.bind(null,e.syncEngine),t})}function $m(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var zp=new Map;function Gm(n,e,t){if(!t)throw new V(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function vT(n,e,t,r){if(e===!0&&r===!0)throw new V(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Wp(n){if(!L.isDocumentKey(n))throw new V(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Hp(n){if(L.isDocumentKey(n))throw new V(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function To(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B()}function ci(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=To(n);throw new V(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var lo=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new V(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new V(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$m((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new V(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new V(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new V(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ir=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lo({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new V(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new V(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lo(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new jc;switch(r.type){case"firstParty":return new Wc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=zp.get(t);r&&(x("ComponentProvider","Removing Datastore"),zp.delete(t),r.terminate())}(this),Promise.resolve()}};function zm(n,e,t,r={}){var i;let o=(n=ci(n,ir))._getSettings(),a=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==a&&Hn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=me.MOCK_USER;else{u=wd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new V(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new me(d)}n._authCredentials=new $c(new Bs(u,h))}}var sr=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},xe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ft(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Ft=class n extends sr{constructor(e,t,r){super(e,t,Dl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new xe(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Wm(n,e,...t){if(n=_e(n),Gm("collection","path",e),n instanceof ir){let r=se.fromString(e,...t);return Hp(r),new Ft(n,null,r)}{if(!(n instanceof xe||n instanceof Ft))throw new V(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(se.fromString(e,...t));return Hp(r),new Ft(n.firestore,null,r)}}function Hm(n,e,...t){if(n=_e(n),arguments.length===1&&(e=qs.newId()),Gm("doc","path",e),n instanceof ir){let r=se.fromString(e,...t);return Wp(r),new xe(n,null,new L(r))}{if(!(n instanceof xe||n instanceof Ft))throw new V(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(se.fromString(e,...t));return Wp(r),new xe(n.firestore,n instanceof Ft?n.converter:null,new L(r))}}var pl=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new no(this,"async_queue_retry"),this.Eu=()=>{let t=Bc();t&&x("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=Bc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=Bc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new pt;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return y(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!wi(e))throw e;x("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw mt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=tl.createAndSchedule(this,e,t,r,o=>this.Vu(o));return this.lu.push(i),i}du(){this.hu&&B()}verifyOperationInProgress(){}mu(){return y(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function Kp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var or=class extends ir{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new pl}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Jm(this),this._firestoreClient.terminate()}};function Km(n,e){let t=typeof n=="object"?n:Dn(),r=typeof n=="string"?n:e||"(default)",i=Fr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Ed("firestore");o&&zm(i,...o)}return i}function Qm(n){return n._firestoreClient||Jm(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Jm(n){var e,t,r;let i=n._freezeSettings(),o=function(u,h,d,p){return new Yc(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,$m(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new fl(n._authCredentials,n._appCheckCredentials,n._queue,o),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var gi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(be.fromBase64String(e))}catch(t){throw new V(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(be.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var _i=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new V(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ho=class{constructor(e){this._methodName=e}};var yi=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}};var vi=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var IT=/^__.*__$/,ml=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new yt(e,this.data,this.fieldMask,t,this.fieldTransforms):new pn(e,this.data,t,this.fieldTransforms)}};function Ym(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}var gl=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.yu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return fo(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(Ym(this.wu)&&IT.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},_l=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Io(e)}Nu(e,t,r,i=!1){return new gl({wu:e,methodName:t,Ou:r,path:Ve.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Xm(n){let e=n._freezeSettings(),t=Io(n._databaseId);return new _l(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ET(n,e,t,r,i,o={}){let a=n.Nu(o.merge||o.mergeFields?2:0,e,t,i);tg("Data must be an object, but it was:",a,r);let u=Zm(r,a),h,d;if(o.merge)h=new Xe(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let p=[];for(let I of o.mergeFields){let S=TT(e,I,t);if(!a.contains(S))throw new V(C.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);bT(p,S)||p.push(S)}h=new Xe(p),d=a.fieldTransforms.filter(I=>h.covers(I.field))}else h=null,d=a.fieldTransforms;return new ml(new je(u),h,d)}function wT(n,e,t,r=!1){return Bl(t,n.Nu(r?4:3,e))}function Bl(n,e){if(eg(n=_e(n)))return tg("Unsupported field value:",e,n),Zm(n,e);if(n instanceof ho)return function(r,i){if(!Ym(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let u of r){let h=Bl(u,i.Fu(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=_e(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return cw(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ye.fromDate(r);return{timestampValue:Xs(i.serializer,o)}}if(r instanceof ye){let o=new ye(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Xs(i.serializer,o)}}if(r instanceof yi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof gi)return{bytesValue:Em(i.serializer,r._byteString)};if(r instanceof xe){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Nl(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof vi)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Mu("VectorValues must only contain numeric values.");return kl(u.serializer,h)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${To(r)}`)}(n,e)}function Zm(n,e){let t={};return Xp(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):cr(n,(r,i)=>{let o=Bl(i,e.bu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function eg(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ye||n instanceof yi||n instanceof gi||n instanceof xe||n instanceof ho||n instanceof vi)}function tg(n,e,t){if(!eg(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=To(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function TT(n,e,t){if((e=_e(e))instanceof _i)return e._internalPath;if(typeof e=="string")return ng(n,e);throw fo("Field path arguments must be of type string or ",n,!1,void 0,t)}var AT=new RegExp("[~\\*/\\[\\]]");function ng(n,e,t){if(e.search(AT)>=0)throw fo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new _i(...e.split("."))._internalPath}catch{throw fo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fo(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new V(C.INVALID_ARGUMENT,u+n+h)}function bT(n,e){return n.some(t=>t.isEqual(e))}var po=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new yl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(rg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},yl=class extends po{data(){return super.data()}};function rg(n,e){return typeof e=="string"?ng(n,e):e instanceof _i?e._internalPath:e._delegate._internalPath}function ST(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new V(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ii=class{},vl=class extends Ii{};function ig(n,e,...t){let r=[];e instanceof Ii&&r.push(e),r=r.concat(t),function(o){let a=o.filter(h=>h instanceof El).length,u=o.filter(h=>h instanceof Il).length;if(a>1||a>0&&u>0)throw new V(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Il=class n extends vl{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return sg(e._query,t),new sr(e.firestore,e.converter,lu(e._query,t))}_parse(e){let t=Xm(e.firestore);return function(o,a,u,h,d,p,I){let S;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new V(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Jp(I,p);let R=[];for(let N of I)R.push(Qp(h,o,N));S={arrayValue:{values:R}}}else S=Qp(h,o,I)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Jp(I,p),S=wT(u,a,I,p==="in"||p==="not-in");return he.create(d,p,S)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var El=class n extends Ii{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ge.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let a=i,u=o.getFlattenedFilters();for(let h of u)sg(a,h),a=lu(a,h)}(e._query,t),new sr(e.firestore,e.converter,lu(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function Qp(n,e,t){if(typeof(t=_e(t))=="string"){if(t==="")throw new V(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!am(e)&&t.indexOf("/")!==-1)throw new V(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(se.fromString(t));if(!L.isDocumentKey(r))throw new V(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ip(n,new L(r))}if(t instanceof xe)return Ip(n,t._key);throw new V(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${To(t)}.`)}function Jp(n,e){if(!Array.isArray(n)||n.length===0)throw new V(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sg(n,e){let t=function(i,o){for(let a of i)for(let u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new V(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new V(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var wl=class{convertValue(e,t="none"){switch(ln(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ie(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Lt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return cr(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ie(a.doubleValue));return new vi(o)}convertGeoPoint(e){return new yi(ie(e.latitude),ie(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Sl(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(li(e));default:return null}}convertTimestamp(e){let t=gt(e);return new ye(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=se.fromString(e);te(Cm(r));let i=new zs(r.get(1),r.get(3)),o=new L(r.popFirst(5));return i.isEqual(t)||mt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function CT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var on=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},mo=class extends po{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Wn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(rg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Wn=class extends mo{data(e={}){return super.data(e)}},Tl=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new on(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Wn(this._firestore,this._userDataWriter,r.key,r,new on(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new Wn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new on(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new Wn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new on(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:RT(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function RT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B()}}var go=class extends wl{constructor(e){super(),this.firestore=e}convertBytes(e){return new gi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new xe(this.firestore,null,t)}};function og(n,e){let t=ci(n.firestore,or),r=Hm(n),i=CT(n.converter,e);return PT(t,[ET(Xm(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,an.exists(!1))]).then(()=>r)}function ql(n,...e){var t,r,i;n=_e(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Kp(e[a])||(o=e[a],a++);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Kp(e[a])){let I=e[a];e[a]=(t=I.next)===null||t===void 0?void 0:t.bind(I),e[a+1]=(r=I.error)===null||r===void 0?void 0:r.bind(I),e[a+2]=(i=I.complete)===null||i===void 0?void 0:i.bind(I)}let h,d,p;if(n instanceof xe)d=ci(n.firestore,or),p=Dl(n._key.path),h={next:I=>{e[a]&&e[a](DT(d,n,I))},error:e[a+1],complete:e[a+2]};else{let I=ci(n,sr);d=ci(I.firestore,or),p=I._query;let S=new go(d);h={next:R=>{e[a]&&e[a](new Tl(d,S,I,R))},error:e[a+1],complete:e[a+2]},ST(n._query)}return function(S,R,N,O){let k=new dl(O),$=new sl(R,k,N);return S.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Zw(yield Gp(S),$)})),()=>{k.za(),S.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return eT(yield Gp(S),$)}))}}(Qm(d),p,u,h)}function PT(n,e){return function(r,i){let o=new pt;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return cT(yield yT(r),i,o)})),o.promise}(Qm(n),e)}function DT(n,e,t){let r=t.docs.get(e._key),i=new go(n);return new mo(n,i,e._key,r,new on(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){ar=i})(Dt),Pt(new Le("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new or(new Gc(r.getProvider("auth-internal")),new Kc(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new V(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zs(d.options.projectId,p)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),de(gp,"4.7.1",e),de(gp,"4.7.1","esm2017")})();var Ao=function(){return Ao=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ao.apply(this,arguments)};var VT={includeMetadataChanges:!1};function ag(n,e){return e===void 0&&(e=VT),new kr(function(t){var r=ql(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function cg(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Ao(Ao({},r),(t={},t[e.idField]=n.id,t))}function ug(n){return ag(n,{includeMetadataChanges:!0}).pipe(Nr(function(e){return e.docs}))}function lg(n,e){return e===void 0&&(e={}),ug(n).pipe(Nr(function(t){return t.map(function(r){return cg(r,e)})}))}var gn=class{constructor(e){return e}},hg="firestore",jl=class{constructor(){return Lr(hg)}};var $l=new Me("angularfire2.firestore-instances");function xT(n,e){let t=rs(hg,n,e);return t&&new gn(t)}function OT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new gn(r)}}var MT={provide:jl,deps:[[new Fe,$l]]},FT={provide:gn,useFactory:xT,deps:[[new Fe,$l],ut]};function dg(n,...e){return de("angularfire",Yt.full,"fst"),En([FT,MT,{provide:$l,useFactory:OT(n),multi:!0,deps:[bt,Wt,Vn,Xt,[new Fe,Hr],[new Fe,Nn],...e]}])}var fg=Ne(lg,!0);var pg=Ne(og,!0);var Gl=Ne(Wm,!0);var mg=Ne(Km,!0);var gg=Ne(ig,!0);var lr=class n{constructor(e){this.firestore=e}loginsCollection=[];countLogins=0;sub;LoginReg(e){let t=Gl(this.firestore,"logins");pg(t,{fecha:new Date,user:e})}GetDataReg(){let e=Gl(this.firestore,"logins"),t=gg(e),r=fg(t);this.sub=r.subscribe(i=>{this.loginsCollection=i,this.countLogins=this.loginsCollection.length,console.log(i)})}static \u0275fac=function(t){return new(t||n)($i(gn))};static \u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})};var bo=class n{constructor(e,t,r){this.router=e;this.auth=t;this.loginsReg=r}title="Login";userMail="";userPWD="";loggedUser="";Login(){Wf(this.auth,this.userMail,this.userPWD).then(e=>{e.user.email!==null&&(this.loggedUser=e.user.email),this.loginsReg.LoginReg(this.loggedUser),this.loginsReg.GetDataReg(),this.router.navigate(["/home"])}).catch(e=>{switch(e.code){case"auth/invalid-credential":this.toastCredenciales();break;case"auth/email-already-in-use":break;default:this.toastDefault();break}})}CloseSession(){Ts(this.auth).then(()=>{this.router.navigate(["/home"])})}toastCredenciales(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="Email o contrase\xF1a incorrectos",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastDefault(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="No fue posible logearse",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}AccesoRapido(){this.userMail="lolo@gmail.com",this.userPWD="123321"}static \u0275fac=function(t){return new(t||n)(ee(St),ee(qe),ee(lr))};static \u0275cmp=ze({type:n,selectors:[["app-login"]],standalone:!0,features:[He],decls:27,vars:2,consts:[[1,"d-flex","justify-content-center"],[1,"row","login","inner-content"],[1,"col"],[1,"container","d-flex","justify-content-between","mt-5","mb-4"],[1,"text-left","texto-blanco"],["src","assets/img/logo.png","alt","logo",1,"logo"],[1,"d-grid","gap-3"],["placeholder","Usuario - Email",1,"form-control","my-2",3,"ngModelChange","ngModel"],["required","","placeholder","Contrase\xF1a",1,"form-control","my-2",3,"ngModelChange","ngModel"],[1,"btn","form-control","mb-5","texto-blanco",3,"click"],["id","miTostada","role","alert","aria-live","assertive","aria-atomic","true",1,"toast",2,"position","absolute","top","20px","right","20px"],[1,"toast-header"],["src","../../../assets/img/admiracion.png","alt","...",1,"rounded","me-2"],[1,"me-auto"],["type","button","data-bs-dismiss","toast","aria-label","Close",1,"btn-close"],[1,"toast-body"]],template:function(t,r){t&1&&(M(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"h2",4),G(6,"Ingresar usuario"),F(),fe(7,"img",5),F(),M(8,"div",6)(9,"div")(10,"input",7),Cn("ngModelChange",function(o){return Sn(r.userMail,o)||(r.userMail=o),o}),F()(),M(11,"div")(12,"input",8),Cn("ngModelChange",function(o){return Sn(r.userPWD,o)||(r.userPWD=o),o}),F()(),M(13,"div")(14,"button",9),ot("click",function(){return r.Login()}),G(15,"Login"),F()(),M(16,"div")(17,"button",9),ot("click",function(){return r.AccesoRapido()}),G(18,"Acceso Rapido"),F()()()()()()(),M(19,"div",10)(20,"div",11),fe(21,"img",12),M(22,"strong",13),G(23,"Atencion!"),F(),fe(24,"button",14),F(),M(25,"div",15),G(26," Hello, world! This is a toast message. "),F()()),t&2&&(ce(10),bn("ngModel",r.userMail),ce(2),bn("ngModel",r.userPWD))},dependencies:[Vs,Un,ks,ei,Zr,Qi],styles:["div[_ngcontent-%COMP%]{--fondo: #3F3F43;--colorBoton: rgb(112, 230, 112);--colorBotonHover:green}.texto-blanco[_ngcontent-%COMP%]{color:#fff;font-family:Gothic A1,sans-serif;font-weight:800;font-style:normal}.logo[_ngcontent-%COMP%]{height:30px;width:40px;margin-top:7px}.login[_ngcontent-%COMP%]{background-color:var(--fondo);border-radius:10px;box-shadow:0 0 10px #0000001a;margin-top:3rem;margin-bottom:3rem}.btn[_ngcontent-%COMP%]{background:var(--colorBoton);border:none;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus{background:var(--colorBotonHover)}input[_ngcontent-%COMP%]:focus{border-color:green;outline:none}.gothic-a1-extrabold[_ngcontent-%COMP%]{font-family:Gothic A1,sans-serif;font-weight:800;font-style:normal}.inner-content[_ngcontent-%COMP%]{max-width:450px;width:100%}"]})};function UT(n,e){if(n&1&&(M(0,"h2",11),G(1),F()),n&2){let t=An();ce(),Wi("Usuario registrado: ",t.loggedUser,"")}}function BT(n,e){if(n&1&&(M(0,"p",11),G(1),F()),n&2){let t=An();ce(),ad(t.msjError)}}var So=class n{constructor(e,t,r){this.auth=e;this.router=t;this.loginsReg=r}newUserMail="";newUserPWD="";loggedUser="";flagError=!1;msjError="";small="";strong="";Register(){Gf(this.auth,this.newUserMail,this.newUserPWD).then(e=>{e.user.email!==null&&(this.loggedUser=e.user.email),this.flagError=!1,this.loginsReg.LoginReg(this.loggedUser),this.router.navigate(["/home"])}).catch(e=>{switch(this.flagError=!0,e.code){case"auth/invalid-email":this.toastEmailInvalido();break;case"auth/email-already-in-use":this.toastEmailYaEnUso();break;default:this.toastDefault();break}})}toastEmailYaEnUso(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="Email ya en uso",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastEmailInvalido(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="Email Invalido",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastDefault(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="No fue posible registrar la cuenta",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}showToast(){var e=document.getElementById("miTostada"),t=new bootstrap.Toast(e);t.show()}static \u0275fac=function(t){return new(t||n)(ee(qe),ee(St),ee(lr))};static \u0275cmp=ze({type:n,selectors:[["app-registro"]],standalone:!0,features:[He],decls:27,vars:4,consts:[[1,"d-flex","justify-content-center"],[1,"row","login","inner-content"],[1,"col"],[1,"container","d-flex","justify-content-between","mt-5","mb-4"],[1,"text-center","texto-blanco"],["src","assets/img/logo.png","alt","logo",1,"logo"],[1,"d-grid","gap-3"],["placeholder","Usuario - Email",1,"form-control","my-2",3,"ngModelChange","ngModel"],["required","","placeholder","Contrase\xF1a",1,"form-control","my-2",3,"ngModelChange","ngModel"],[1,"d-grid","gap-2"],[1,"btn","form-control","mb-5","texto-blanco",3,"click"],[1,"text-center","text-primary"],["id","miTostada","role","alert","aria-live","assertive","aria-atomic","true",1,"toast",2,"position","absolute","top","20px","right","20px"],[1,"toast-header"],["src","../../../assets/img/admiracion.png","alt","...",1,"rounded","me-2"],[1,"me-auto"],["type","button","data-bs-dismiss","toast","aria-label","Close",1,"btn-close"],[1,"toast-body"]],template:function(t,r){t&1&&(M(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"h2",4),G(6,"Registrar usuario"),F(),fe(7,"img",5),F(),M(8,"div",6)(9,"div")(10,"input",7),Cn("ngModelChange",function(o){return Sn(r.newUserMail,o)||(r.newUserMail=o),o}),F()(),M(11,"div")(12,"input",8),Cn("ngModelChange",function(o){return Sn(r.newUserPWD,o)||(r.newUserPWD=o),o}),F()(),M(13,"div")(14,"div",9)(15,"button",10),ot("click",function(){return r.Register()}),G(16,"Registrarse"),F()(),Tn(17,UT,2,1,"h2",11)(18,BT,2,1,"p",11),F()()()()()(),M(19,"div",12)(20,"div",13),fe(21,"img",14),M(22,"strong",15),G(23,"Atencion!"),F(),fe(24,"button",16),F(),M(25,"div",17),G(26," Hello, world! This is a toast message. "),F()()),t&2&&(ce(10),bn("ngModel",r.newUserMail),ce(2),bn("ngModel",r.newUserPWD),ce(5),la(r.loggedUser!=""?17:-1),ce(),la(r.flagError?18:-1))},dependencies:[Vs,Un,ks,ei,Zr],styles:["div[_ngcontent-%COMP%]{--fondo: #3F3F43;--colorBoton: rgb(112, 230, 112);--colorBotonHover:green}.texto-blanco[_ngcontent-%COMP%]{color:#fff;font-family:Gothic A1,sans-serif;font-weight:800;font-style:normal}.logo[_ngcontent-%COMP%]{height:30px;width:40px;margin-top:7px}.login[_ngcontent-%COMP%]{background-color:var(--fondo);border-radius:10px;box-shadow:0 0 10px #0000001a;margin-top:3rem;margin-bottom:3rem}.btn[_ngcontent-%COMP%]{background:var(--colorBoton);border:none;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus{background:var(--colorBotonHover)}input[_ngcontent-%COMP%]:focus{border-color:green;outline:none}.inner-content[_ngcontent-%COMP%]{max-width:450px;width:100%}.img-toas[_ngcontent-%COMP%]{width:10px;height:10px}"]})};var Co=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ze({type:n,selectors:[["app-page-not-found"]],standalone:!0,features:[He],decls:2,vars:0,template:function(t,r){t&1&&(M(0,"p"),G(1,"page-not-found works!"),F())}})};var yg=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home",component:bs,children:[{path:"login",component:bo},{path:"registro",component:So},{path:"juegos",loadChildren:()=>import("./chunk-TW3H5VEP.js").then(n=>n.JuegosModule)}]},{path:"**",component:Co}];var vg={projectId:"saladejuegos-f162c",appId:"1:427218264835:web:a5a676bfcd8bba0b83bf36",storageBucket:"saladejuegos-f162c.appspot.com",apiKey:"AIzaSyBUvgRVekAkiMeQF-S55lTfwjXw5JEkoeo",authDomain:"saladejuegos-f162c.firebaseapp.com",messagingSenderId:"427218264835"};var Ig={providers:[hd({eventCoalescing:!0}),_d(yg),zd(()=>Wd(vg)),$f(()=>zf()),dg(()=>mg())]};var hr=class{nombre;clave;constructor(e,t){this.nombre=e,this.clave=t}};var Ro=class n{constructor(e){this.router=e}title="Sala de Juegos";usuario1=new hr("juan","1234");usuario2=new hr("pedro","1234");usuario3=new hr("laura","1234");ngOnInit(){this.guardarUsuarios()}guardarUsuarios(){let e=[this.usuario1,this.usuario2,this.usuario3],t=JSON.stringify(e);localStorage.setItem("usuarios",t)}static \u0275fac=function(t){return new(t||n)(ee(St))};static \u0275cmp=ze({type:n,selectors:[["app-root"]],standalone:!0,features:[He],decls:2,vars:0,template:function(t,r){t&1&&(M(0,"div"),fe(1,"router-outlet"),F())},dependencies:[Ji],styles:["[_nghost-%COMP%]{display:block;min-height:100vh;background-color:#bbb;margin:0;width:100%}[_ngcontent-%COMP%]:root{--colorFondo: rgb(187, 187, 187)}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100%}"]})};pd(Ro,Ig).catch(n=>console.error(n));
