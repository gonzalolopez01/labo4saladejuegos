import{A as Ph,Aa as Nn,Ba as xn,Ca as zi,D as Q,Da as On,E as _e,F as je,G as he,H as Nr,I as x,J as V,K as de,L as Dh,M as kh,N as Bi,O as Ke,P as Ae,Q as qi,R as q,S as xr,T as Cn,V as St,W as Rt,X as Ct,Y as Ue,Z as Nh,a as Ah,aa as xh,b as bh,ba as Oh,c as Et,ca as ji,d as y,da as Vh,e as kr,ea as Mh,f as Fi,fa as Lh,g as Sh,ga as Fh,h as Rh,ha as Uh,i as Go,ia as Pn,j as Wo,k as Ko,ka as Bh,l as Ho,la as Dn,m as Ch,n as An,oa as qh,p as bn,pa as jh,q as Ui,qa as $h,ra as Qo,s as Le,sa as zh,t as Fe,ta as Gh,ua as $i,v as Sn,va as Pt,w as Tt,wa as Wh,x as At,xa as Kh,y as Rn,z as bt,za as kn}from"./chunk-BNR2CGG2.js";var Qh=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},hg=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Jh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,I=(o&3)<<4|u>>4,S=(u&15)<<2|d>>6,C=d&63;h||(C=64,a||(S=64)),r.push(t[p],t[I],t[S],t[C])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Qh(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):hg(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let I=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||I==null)throw new Yo;let S=o<<2|u>>4;if(r.push(S),d!==64){let C=u<<4&240|d>>2;if(r.push(C),I!==64){let N=d<<6&192|I;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Yo=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},dg=function(n){let e=Qh(n);return Jh.encodeByteArray(e,!0)},Or=function(n){return dg(n).replace(/\./g,"")},Zo=function(n){try{return Jh.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function fg(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var pg=()=>fg().__FIREBASE_DEFAULTS__,mg=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},gg=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Zo(n[1]);return e&&JSON.parse(e)},Wi=()=>{try{return pg()||mg()||gg()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ea=n=>{var e,t;return(t=(e=Wi())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Yh=n=>{let e=ea(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},ta=()=>{var n;return(n=Wi())===null||n===void 0?void 0:n.config},na=n=>{var e;return(e=Wi())===null||e===void 0?void 0:e[`_${n}`]};var Gi=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Xh(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Or(JSON.stringify(t)),Or(JSON.stringify(a)),""].join(".")}function pe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Zh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pe())}function _g(){var n;let e=(n=Wi())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ed(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function td(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function nd(){let n=pe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function rd(){return!_g()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ra(){try{return typeof indexedDB=="object"}catch{return!1}}function id(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var yg="FirebaseError",xe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=yg,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ot.prototype.create)}},ot=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?vg(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new xe(i,u,r)}};function vg(n,e){return n.replace(Ig,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Ig=/\{\$([^}]+)}/g;function sd(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Jt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(Hh(o)&&Hh(a)){if(!Jt(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Hh(n){return n!==null&&typeof n=="object"}function Vr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Vn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Mn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function od(n,e){let t=new Xo(n,e);return t.subscribe.bind(t)}var Xo=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");wg(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Jo),i.error===void 0&&(i.error=Jo),i.complete===void 0&&(i.complete=Jo);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function wg(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Jo(){}var RE=4*60*60*1e3;function ye(n){return n&&n._delegate?n._delegate:n}var Be=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Yt="[DEFAULT]";var ia=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Gi;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Tg(e))try{this.getOrInitializeService({instanceIdentifier:Yt})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Yt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Yt){return this.instances.has(e)}getOptions(e=Yt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Eg(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yt){return this.component?this.component.multipleInstances?e:Yt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Eg(n){return n===Yt?void 0:n}function Tg(n){return n.instantiationMode==="EAGER"}var Ki=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ia(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Ag=[],G=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(G||{}),bg={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},Sg=G.INFO,Rg={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},Cg=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Rg[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Dt=class{constructor(e){this.name=e,this._logLevel=Sg,this._logHandler=Cg,this._userLogHandler=null,Ag.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}};var Pg=(n,e)=>e.some(t=>n instanceof t),ad,cd;function Dg(){return ad||(ad=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kg(){return cd||(cd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var ud=new WeakMap,oa=new WeakMap,ld=new WeakMap,sa=new WeakMap,ca=new WeakMap;function Ng(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(He(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&ud.set(t,n)}).catch(()=>{}),ca.set(e,n),e}function xg(n){if(oa.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});oa.set(n,e)}var aa={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return oa.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ld.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return He(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function hd(n){aa=n(aa)}function Og(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Hi(this),e,...t);return ld.set(r,e.sort?e.sort():[e]),He(r)}:kg().includes(n)?function(...e){return n.apply(Hi(this),e),He(ud.get(this))}:function(...e){return He(n.apply(Hi(this),e))}}function Vg(n){return typeof n=="function"?Og(n):(n instanceof IDBTransaction&&xg(n),Pg(n,Dg())?new Proxy(n,aa):n)}function He(n){if(n instanceof IDBRequest)return Ng(n);if(sa.has(n))return sa.get(n);let e=Vg(n);return e!==n&&(sa.set(n,e),ca.set(e,n)),e}var Hi=n=>ca.get(n);function fd(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=He(a);return r&&a.addEventListener("upgradeneeded",h=>{r(He(a.result),h.oldVersion,h.newVersion,He(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var Mg=["get","getKey","getAll","getAllKeys","count"],Lg=["put","add","delete","clear"],ua=new Map;function dd(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ua.get(e))return ua.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Lg.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Mg.includes(t)))return;let o=function(a,...u){return y(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return ua.set(e,o),o}hd(n=>bh(Ah({},n),{get:(e,t,r)=>dd(e,t)||n.get(e,t,r),has:(e,t)=>!!dd(e,t)||n.has(e,t)}));var ha=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Fg(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Fg(n){let e=n.getComponent();return e?.type==="VERSION"}var da="@firebase/app",pd="0.10.10";var at=new Dt("@firebase/app"),Ug="@firebase/app-compat",Bg="@firebase/analytics-compat",qg="@firebase/analytics",jg="@firebase/app-check-compat",$g="@firebase/app-check",zg="@firebase/auth",Gg="@firebase/auth-compat",Wg="@firebase/database",Kg="@firebase/database-compat",Hg="@firebase/functions",Qg="@firebase/functions-compat",Jg="@firebase/installations",Yg="@firebase/installations-compat",Xg="@firebase/messaging",Zg="@firebase/messaging-compat",e_="@firebase/performance",t_="@firebase/performance-compat",n_="@firebase/remote-config",r_="@firebase/remote-config-compat",i_="@firebase/storage",s_="@firebase/storage-compat",o_="@firebase/firestore",a_="@firebase/vertexai-preview",c_="@firebase/firestore-compat",u_="firebase",l_="10.13.1";var fa="[DEFAULT]",h_={[da]:"fire-core",[Ug]:"fire-core-compat",[qg]:"fire-analytics",[Bg]:"fire-analytics-compat",[$g]:"fire-app-check",[jg]:"fire-app-check-compat",[zg]:"fire-auth",[Gg]:"fire-auth-compat",[Wg]:"fire-rtdb",[Kg]:"fire-rtdb-compat",[Hg]:"fire-fn",[Qg]:"fire-fn-compat",[Jg]:"fire-iid",[Yg]:"fire-iid-compat",[Xg]:"fire-fcm",[Zg]:"fire-fcm-compat",[e_]:"fire-perf",[t_]:"fire-perf-compat",[n_]:"fire-rc",[r_]:"fire-rc-compat",[i_]:"fire-gcs",[s_]:"fire-gcs-compat",[o_]:"fire-fst",[c_]:"fire-fst-compat",[a_]:"fire-vertex","fire-js":"fire-js",[u_]:"fire-js-all"};var Mr=new Map,d_=new Map,pa=new Map;function md(n,e){try{n.container.addComponent(e)}catch(t){at.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Nt(n){let e=n.name;if(pa.has(e))return at.debug(`There were multiple attempts to register component ${e}.`),!1;pa.set(e,n);for(let t of Mr.values())md(t,n);for(let t of d_.values())md(t,n);return!0}function Fr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function $e(n){return n.settings!==void 0}var f_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},kt=new ot("app","Firebase",f_);var ma=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Be("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw kt.create("app-deleted",{appName:this._name})}};var xt=l_;function ya(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:fa,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw kt.create("bad-app-name",{appName:String(i)});if(t||(t=ta()),!t)throw kt.create("no-options");let o=Mr.get(i);if(o){if(Jt(t,o.options)&&Jt(r,o.config))return o;throw kt.create("duplicate-app",{appName:i})}let a=new Ki(i);for(let h of pa.values())a.addComponent(h);let u=new ma(t,r,a);return Mr.set(i,u),u}function Ln(n=fa){let e=Mr.get(n);if(!e&&n===fa&&ta())return ya();if(!e)throw kt.create("no-app",{appName:n});return e}function Qi(){return Array.from(Mr.values())}function fe(n,e,t){var r;let i=(r=h_[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),at.warn(u.join(" "));return}Nt(new Be(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var p_="firebase-heartbeat-database",m_=1,Lr="firebase-heartbeat-store",la=null;function vd(){return la||(la=fd(p_,m_,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Lr)}catch(t){console.warn(t)}}}}).catch(n=>{throw kt.create("idb-open",{originalErrorMessage:n.message})})),la}function g_(n){return y(this,null,function*(){try{let t=(yield vd()).transaction(Lr),r=yield t.objectStore(Lr).get(Id(n));return yield t.done,r}catch(e){if(e instanceof xe)at.warn(e.message);else{let t=kt.create("idb-get",{originalErrorMessage:e?.message});at.warn(t.message)}}})}function gd(n,e){return y(this,null,function*(){try{let r=(yield vd()).transaction(Lr,"readwrite");yield r.objectStore(Lr).put(e,Id(n)),yield r.done}catch(t){if(t instanceof xe)at.warn(t.message);else{let r=kt.create("idb-set",{originalErrorMessage:t?.message});at.warn(r.message)}}})}function Id(n){return`${n.name}!${n.options.appId}`}var __=1024,y_=30*24*60*60*1e3,ga=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new _a(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=_d();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=y_}),this._storage.overwrite(this._heartbeatsCache))}catch(r){at.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=_d(),{heartbeatsToSend:r,unsentEntries:i}=v_(this._heartbeatsCache.heartbeats),o=Or(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return at.warn(t),""}})}};function _d(){return new Date().toISOString().substring(0,10)}function v_(n,e=__){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),yd(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),yd(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var _a=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return ra()?id().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield g_(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return gd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return gd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function yd(n){return Or(JSON.stringify({version:2,heartbeats:n})).length}function I_(n){Nt(new Be("platform-logger",e=>new ha(e),"PRIVATE")),Nt(new Be("heartbeat",e=>new ga(e),"PRIVATE")),fe(da,pd,n),fe(da,pd,"esm2017"),fe("fire-js","")}I_("");var w_="firebase",E_="10.13.1";fe(w_,E_,"app");var Zt=new Vh("ANGULARFIRE2_VERSION");function Yi(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Ur=(n,e)=>{let t=e?[e]:Qi(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Un=class{constructor(){return Ur(T_)}},T_="app-check";function Fn(){}var Ji=class{zone;delegate;constructor(e,t=Rh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(o,t,r)}},va=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Fn,{},Fn,Fn)),t.pipe(Ch({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Bn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Ji(Zone.current)),this.insideAngular=t.run(()=>new Ji(Zone.current,Sh)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Ui(bt))};static \u0275prov=An({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Xi(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function A_(n){return Xi().ngZone.runOutsideAngular(()=>n())}function Xt(n){return Xi().ngZone.run(()=>n())}function b_(n){return S_(Xi())(n)}function S_(n){return function(t){return t=t.lift(new va(n.ngZone)),t.pipe(Ko(n.outsideAngular),Wo(n.insideAngular))}}var R_=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Xt(()=>n.apply(void 0,r))},ke=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=Xt(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Fn,{},Fn,Fn))),r[o]=R_(r[o],t));let i=A_(()=>n.apply(this,r));if(!e)if(i instanceof kr){let o=Xi();return i.pipe(Ko(o.outsideAngular),Wo(o.insideAngular))}else return Xt(()=>i);return i instanceof kr?i.pipe(b_):i instanceof Promise?Xt(()=>new Promise((o,a)=>i.then(u=>Xt(()=>o(u)),u=>Xt(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Xt(()=>i)};var ct=class{constructor(e){return e}},en=class{constructor(){return Qi()}};function C_(n){return n&&n.length===1?n[0]:new ct(Ln())}var Ia=new bn("angularfire2._apps"),P_={provide:ct,useFactory:C_,deps:[[new Le,Ia]]},D_={provide:en,deps:[[new Le,Ia]]};function k_(n){return(e,t)=>{let r=t.get(Ph);fe("angularfire",Zt.full,"core"),fe("angularfire",Zt.full,"app"),fe("angular",Mh.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new ct(i)}}function wd(n,...e){return Sn([P_,D_,{provide:Ia,useFactory:k_(n),multi:!0,deps:[bt,Rn,Bn,...e]}])}var Ed=ke(ya,!0);function Ud(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Bd=Ud,qd=new ot("auth","Firebase",Ud());var is=new Dt("@firebase/auth");function N_(n,...e){is.logLevel<=G.WARN&&is.warn(`Auth (${xt}): ${n}`,...e)}function es(n,...e){is.logLevel<=G.ERROR&&is.error(`Auth (${xt}): ${n}`,...e)}function Je(n,...e){throw $a(n,...e)}function tn(n,...e){return $a(n,...e)}function jd(n,e,t){let r=Object.assign(Object.assign({},Bd()),{[e]:t});return new ot("auth","Firebase",r).create(e,{appName:n.name})}function ht(n){return jd(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $a(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return qd.create(n,...e)}function U(n,e,...t){if(!n)throw $a(e,...t)}function ut(n){let e="INTERNAL ASSERTION FAILED: "+n;throw es(e),new Error(e)}function Mt(n,e){n||ut(e)}function Aa(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function x_(){return Td()==="http:"||Td()==="https:"}function Td(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function O_(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(x_()||ed()||"connection"in navigator)?navigator.onLine:!0}function V_(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var nn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Mt(t>e,"Short delay should be less than long delay!"),this.isMobile=Zh()||td()}get(){return O_()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function za(n,e){Mt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var ss=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ut("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ut("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ut("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var M_={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var L_=new nn(3e4,6e4);function Lt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Ft(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){return $d(n,i,()=>y(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let I=Vr(Object.assign({key:n.config.apiKey},p)).slice(1),S=yield n._getAdditionalHeaders();return S["Content-Type"]="application/json",n.languageCode&&(S["X-Firebase-Locale"]=n.languageCode),ss.fetch()(zd(n,n.config.apiHost,t,I),Object.assign({method:e,headers:S,referrerPolicy:"no-referrer"},d))}))})}function $d(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},M_),e);try{let i=new ba(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw Zi(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zi(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Zi(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw Zi(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw jd(n,p,d);Je(n,p)}}catch(i){if(i instanceof xe)throw i;Je(n,"network-request-failed",{message:String(i)})}})}function Kr(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield Ft(n,e,t,r,i);return"mfaPendingCredential"in d&&Je(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function zd(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?za(n.config,i):`${n.config.apiScheme}://${i}`}function F_(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var ba=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(tn(this.auth,"network-request-failed")),L_.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Zi(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=tn(n,e,r);return i.customData._tokenResponse=t,i}function Ad(n){return n!==void 0&&n.enterprise!==void 0}var Sa=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return F_(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function U_(n,e){return y(this,null,function*(){return Ft(n,"GET","/v2/recaptchaConfig",Lt(n,e))})}function B_(n,e){return y(this,null,function*(){return Ft(n,"POST","/v1/accounts:delete",e)})}function Gd(n,e){return y(this,null,function*(){return Ft(n,"POST","/v1/accounts:lookup",e)})}function Br(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Ga(n,e=!1){return y(this,null,function*(){let t=ye(n),r=yield t.getIdToken(e),i=Wa(r);U(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:Br(wa(i.auth_time)),issuedAtTime:Br(wa(i.iat)),expirationTime:Br(wa(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function wa(n){return Number(n)*1e3}function Wa(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return es("JWT malformed, contained fewer than 3 sections"),null;try{let i=Zo(t);return i?JSON.parse(i):(es("Failed to decode base64 JWT payload"),null)}catch(i){return es("Caught error parsing JWT payload as JSON",i?.toString()),null}}function bd(n){let e=Wa(n);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function jr(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof xe&&q_(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function q_({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Ra=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var $r=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Br(this.lastLoginAt),this.creationTime=Br(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function os(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield jr(n,Gd(t,{idToken:r}));U(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Wd(o.providerUserInfo):[],u=j_(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,p=h?d:!1,I={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new $r(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,I)})}function Ka(n){return y(this,null,function*(){let e=ye(n);yield os(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function j_(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Wd(n){return n.map(e=>{var{providerId:t}=e,r=Go(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function $_(n,e){return y(this,null,function*(){let t=yield $d(n,{},()=>y(this,null,function*(){let r=Vr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=zd(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",ss.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function z_(n,e){return y(this,null,function*(){return Ft(n,"POST","/v2/accounts:revokeToken",Lt(n,e))})}var qr=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):bd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(e.length!==0,"internal-error");let t=bd(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield $_(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(U(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(U(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ut("not implemented")}};function Vt(n,e){U(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var qn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=Go(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ra(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new $r(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield jr(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Ga(this,e)}reload(){return Ka(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield os(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if($e(this.auth.app))return Promise.reject(ht(this.auth));let e=yield this.getIdToken();return yield jr(this,B_(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,p;let I=(r=t.displayName)!==null&&r!==void 0?r:void 0,S=(i=t.email)!==null&&i!==void 0?i:void 0,C=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,N=(a=t.photoURL)!==null&&a!==void 0?a:void 0,L=(u=t.tenantId)!==null&&u!==void 0?u:void 0,k=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,z=(d=t.createdAt)!==null&&d!==void 0?d:void 0,K=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:H,emailVerified:ne,isAnonymous:Ce,providerData:Z,stsTokenManager:w}=t;U(H&&w,e,"internal-error");let m=qr.fromJSON(this.name,w);U(typeof H=="string",e,"internal-error"),Vt(I,e.name),Vt(S,e.name),U(typeof ne=="boolean",e,"internal-error"),U(typeof Ce=="boolean",e,"internal-error"),Vt(C,e.name),Vt(N,e.name),Vt(L,e.name),Vt(k,e.name),Vt(z,e.name),Vt(K,e.name);let _=new n({uid:H,auth:e,email:S,emailVerified:ne,displayName:I,isAnonymous:Ce,photoURL:N,phoneNumber:C,tenantId:L,stsTokenManager:m,createdAt:z,lastLoginAt:K});return Z&&Array.isArray(Z)&&(_.providerData=Z.map(v=>Object.assign({},v))),k&&(_._redirectEventId=k),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new qr;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield os(o),o})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];U(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Wd(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new qr;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new $r(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var Sd=new Map;function lt(n){Mt(n instanceof Function,"Expected a class definition");let e=Sd.get(n);return e?(Mt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Sd.set(n,e),e)}var G_=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Ca=G_;function ts(n,e,t){return`firebase:${n}:${e}:${t}`}var as=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=ts(this.userKey,i.apiKey,o),this.fullPersistenceKey=ts("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?qn._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(lt(Ca),e,r);let i=(yield Promise.all(t.map(d=>y(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||lt(Ca),a=ts(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let I=qn._fromJSON(e,p);d!==o&&(u=I),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(d=>y(this,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function Rd(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Jd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Kd(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Xd(e))return"Blackberry";if(Zd(e))return"Webos";if(Hd(e))return"Safari";if((e.includes("chrome/")||Qd(e))&&!e.includes("edge/"))return"Chrome";if(Yd(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Kd(n=pe()){return/firefox\//i.test(n)}function Hd(n=pe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Qd(n=pe()){return/crios\//i.test(n)}function Jd(n=pe()){return/iemobile/i.test(n)}function Yd(n=pe()){return/android/i.test(n)}function Xd(n=pe()){return/blackberry/i.test(n)}function Zd(n=pe()){return/webos/i.test(n)}function Ha(n=pe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function W_(n=pe()){var e;return Ha(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function K_(){return nd()&&document.documentMode===10}function ef(n=pe()){return Ha(n)||Yd(n)||Zd(n)||Xd(n)||/windows phone/i.test(n)||Jd(n)}function tf(n,e=[]){let t;switch(n){case"Browser":t=Rd(pe());break;case"Worker":t=`${Rd(pe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${xt}/${r}`}var Pa=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function H_(t){return y(this,arguments,function*(n,e={}){return Ft(n,"GET","/v2/passwordPolicy",Lt(n,e))})}var Q_=6,Da=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:Q_,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var ka=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cs(this),this.idTokenSubscription=new cs(this),this.beforeStateQueue=new Pa(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=lt(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield as.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield Gd(this,{idToken:e}),r=yield qn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if($e(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield os(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=V_()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if($e(this.app))return Promise.reject(ht(this));let t=e?ye(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return $e(this.app)?Promise.reject(ht(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return $e(this.app)?Promise.reject(ht(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(lt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield H_(this),t=new Da(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ot("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield z_(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&lt(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=yield as.create(this,[lt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&N_(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function sn(n){return ye(n)}var cs=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=od(t=>this.observer=t)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var ms={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function J_(n){ms=n}function nf(n){return ms.loadJS(n)}function Y_(){return ms.recaptchaEnterpriseScript}function X_(){return ms.gapiScript}function rf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var Z_="recaptcha-enterprise",ey="NO_RECAPTCHA",Na=class{constructor(e){this.type=Z_,this.auth=sn(e)}verify(e="verify",t=!1){return y(this,null,function*(){function r(o){return y(this,null,function*(){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise((a,u)=>y(this,null,function*(){U_(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new Sa(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,a(d.siteKey)}}).catch(h=>{u(h)})}))})}function i(o,a,u){let h=window.grecaptcha;Ad(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{a(d)}).catch(()=>{a(ey)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,a)=>{r(this.auth).then(u=>{if(!t&&Ad(window.grecaptcha))i(u,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=Y_();h.length!==0&&(h+=u),nf(h).then(()=>{i(u,o,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})})}};function Cd(n,e,t,r=!1){return y(this,null,function*(){let i=new Na(n),o;try{o=yield i.verify(t)}catch{o=yield i.verify(t,!0)}let a=Object.assign({},e);return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function xa(n,e,t,r){return y(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let o=yield Cd(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(o=>y(this,null,function*(){if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=yield Cd(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(o)}))})}function Qa(n,e){let t=Fr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(Jt(o,e??{}))return i;Je(i,"already-initialized")}return t.initialize({options:e})}function ty(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(lt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Ja(n,e,t){let r=sn(n);U(r._canInitEmulator,r,"emulator-config-failed"),U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=sf(e),{host:a,port:u}=ny(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${o}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||ry()}function sf(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ny(n){let e=sf(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:Pd(r.substr(o.length+1))}}else{let[o,a]=r.split(":");return{host:o,port:Pd(a)}}}function Pd(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function ry(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var zr=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ut("not implemented")}_getIdTokenResponse(e){return ut("not implemented")}_linkToIdToken(e,t){return ut("not implemented")}_getReauthenticationResolver(e){return ut("not implemented")}};function iy(n,e){return y(this,null,function*(){return Ft(n,"POST","/v1/accounts:signUp",e)})}function sy(n,e){return y(this,null,function*(){return Kr(n,"POST","/v1/accounts:signInWithPassword",Lt(n,e))})}function oy(n,e){return y(this,null,function*(){return Kr(n,"POST","/v1/accounts:signInWithEmailLink",Lt(n,e))})}function ay(n,e){return y(this,null,function*(){return Kr(n,"POST","/v1/accounts:signInWithEmailLink",Lt(n,e))})}var Gr=class n extends zr{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xa(e,t,"signInWithPassword",sy);case"emailLink":return oy(e,{email:this._email,oobCode:this._password});default:Je(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xa(e,r,"signUpPassword",iy);case"emailLink":return ay(e,{idToken:t,email:this._email,oobCode:this._password});default:Je(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ea(n,e){return y(this,null,function*(){return Kr(n,"POST","/v1/accounts:signInWithIdp",Lt(n,e))})}function cy(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function uy(n){let e=Vn(Mn(n)).link,t=e?Vn(Mn(e)).deep_link_id:null,r=Vn(Mn(n)).deep_link_id;return(r?Vn(Mn(r)).link:null)||r||t||e||n}var us=class n{constructor(e){var t,r,i,o,a,u;let h=Vn(Mn(e)),d=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,I=cy((i=h.mode)!==null&&i!==void 0?i:null);U(d&&p&&I,"argument-error"),this.apiKey=d,this.operation=I,this.code=p,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=uy(e);try{return new n(t)}catch{return null}}};var of=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Gr._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=us.parseLink(r);return U(i,"argument-error"),Gr._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),ls=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Oa=class extends ls{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function ly(n,e){return y(this,null,function*(){return Kr(n,"POST","/v1/accounts:signUp",Lt(n,e))})}var jn=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let o=yield qn._fromIdTokenResponse(e,r,i),a=Dd(r);return new n({user:o,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=Dd(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function Dd(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Va=class n extends xe{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function af(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Va._fromErrorAndOperation(n,o,e,r):o})}function hy(n,e,t=!1){return y(this,null,function*(){let r=yield jr(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return jn._forOperation(n,"link",r)})}function dy(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if($e(r.app))return Promise.reject(ht(r));let i="reauthenticate";try{let o=yield jr(n,af(r,i,e,n),t);U(o.idToken,r,"internal-error");let a=Wa(o.idToken);U(a,r,"internal-error");let{sub:u}=a;return U(n.uid===u,r,"user-mismatch"),jn._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Je(r,"user-mismatch"),o}})}function cf(n,e,t=!1){return y(this,null,function*(){if($e(n.app))return Promise.reject(ht(n));let r="signIn",i=yield af(n,r,e),o=yield jn._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function Ya(n,e){return y(this,null,function*(){return cf(sn(n),e)})}function uf(n){return y(this,null,function*(){let e=sn(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function Xa(n,e,t){return y(this,null,function*(){if($e(n.app))return Promise.reject(ht(n));let r=sn(n),a=yield xa(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ly).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&uf(n),h}),u=yield jn._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(u.user),u})}function Za(n,e,t){return $e(n.app)?Promise.reject(ht(n)):Ya(ye(n),of.credential(e,t)).catch(r=>y(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&uf(n),r}))}function ec(n,e,t,r){return ye(n).onIdTokenChanged(e,t,r)}function tc(n,e,t){return ye(n).beforeAuthStateChanged(e,t)}function nc(n){return ye(n).signOut()}var hs="__sak";var ds=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(hs,"1"),this.storage.removeItem(hs),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var fy=1e3,py=10,my=(()=>{class n extends ds{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ef(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);K_()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,py):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},fy)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Et(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Et(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Et(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),lf=my;var gy=(()=>{class n extends ds{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),rc=gy;function _y(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var yy=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:o,data:a}=r.data,u=this.handlersMap[o];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let h=Array.from(u).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield _y(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function hf(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Ma=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,h)=>{let d=hf("",20);i.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(I){let S=I;if(S.data.eventId===d)switch(S.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(S.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function Qe(){return window}function vy(n){Qe().location.href=n}function df(){return typeof Qe().WorkerGlobalScope<"u"&&typeof Qe().importScripts=="function"}function Iy(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function wy(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Ey(){return df()?self:null}var ff="firebaseLocalStorageDb",Ty=1,fs="firebaseLocalStorage",pf="fbase_key",rn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function gs(n,e){return n.transaction([fs],e?"readwrite":"readonly").objectStore(fs)}function Ay(){let n=indexedDB.deleteDatabase(ff);return new rn(n).toPromise()}function La(){let n=indexedDB.open(ff,Ty);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(fs,{keyPath:pf})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(fs)?e(r):(r.close(),yield Ay(),e(yield La()))}))})}function kd(n,e,t){return y(this,null,function*(){let r=gs(n,!0).put({[pf]:e,value:t});return new rn(r).toPromise()})}function by(n,e){return y(this,null,function*(){let t=gs(n,!1).get(e),r=yield new rn(t).toPromise();return r===void 0?null:r.value})}function Nd(n,e){let t=gs(n,!0).delete(e);return new rn(t).toPromise()}var Sy=800,Ry=3,Cy=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield La(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Ry)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return df()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=yy._getInstance(Ey()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield Iy(),!this.activeServiceWorker)return;this.sender=new Ma(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||wy()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield La();return yield kd(t,hs,"1"),yield Nd(t,hs),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>kd(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>by(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>Nd(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(o=>{let a=gs(o,!1).getAll();return new rn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:a}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),Sy)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),mf=Cy;var IT=rf("rcb"),wT=new nn(3e4,6e4);function Py(n,e){return e?lt(e):(U(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Wr=class extends zr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ea(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ea(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ea(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Dy(n){return cf(n.auth,new Wr(n),n.bypassAuthState)}function ky(n){let{auth:e,user:t}=n;return U(t,e,"internal-error"),dy(t,new Wr(n),n.bypassAuthState)}function Ny(n){return y(this,null,function*(){let{auth:e,user:t}=n;return U(t,e,"internal-error"),hy(t,new Wr(n),n.bypassAuthState)})}var Fa=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Dy;case"linkViaPopup":case"linkViaRedirect":return Ny;case"reauthViaPopup":case"reauthViaRedirect":return ky;default:Je(this.auth,"internal-error")}}resolve(e){Mt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Mt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var ET=new nn(2e3,1e4);var xy="pendingRedirect",ns=new Map,Ua=class n extends Fa{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=ns.get(this.auth._key());if(!e){try{let r=(yield Oy(this.resolver,this.auth))?yield Et(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ns.set(this.auth._key(),e)}return this.bypassAuthState||ns.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Et(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Et(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function Oy(n,e){return y(this,null,function*(){let t=Ly(e),r=My(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Vy(n,e){ns.set(n._key(),e)}function My(n){return lt(n._redirectPersistence)}function Ly(n){return ts(xy,n.config.apiKey,n.name)}function Fy(n,e,t=!1){return y(this,null,function*(){if($e(n.app))return Promise.reject(ht(n));let r=sn(n),i=Py(r,e),a=yield new Ua(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var Uy=10*60*1e3,Ba=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!By(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!gf(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(tn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Uy&&this.cachedEventUids.clear(),this.cachedEventUids.has(xd(e))}saveEventToCache(e){this.cachedEventUids.add(xd(e)),this.lastProcessedEventTime=Date.now()}};function xd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function gf({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function By(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gf(n);default:return!1}}function qy(t){return y(this,arguments,function*(n,e={}){return Ft(n,"GET","/v1/projects",e)})}var jy=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$y=/^https?/;function zy(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield qy(n);for(let t of e)try{if(Gy(t))return}catch{}Je(n,"unauthorized-domain")})}function Gy(n){let e=Aa(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!$y.test(t))return!1;if(jy.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Wy=new nn(3e4,6e4);function Od(){let n=Qe().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Ky(n){return new Promise((e,t)=>{var r,i,o;function a(){Od(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Od(),t(tn(n,"network-request-failed"))},timeout:Wy.get()})}if(!((i=(r=Qe().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=Qe().gapi)===null||o===void 0)&&o.load)a();else{let u=rf("iframefcb");return Qe()[u]=()=>{gapi.load?a():t(tn(n,"network-request-failed"))},nf(`${X_()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw rs=null,e})}var rs=null;function Hy(n){return rs=rs||Ky(n),rs}var Qy=new nn(5e3,15e3),Jy="__/auth/iframe",Yy="emulator/auth/iframe",Xy={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Zy=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ev(n){let e=n.config;U(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?za(e,Yy):`https://${n.config.authDomain}/${Jy}`,r={apiKey:e.apiKey,appName:n.name,v:xt},i=Zy.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Vr(r).slice(1)}`}function tv(n){return y(this,null,function*(){let e=yield Hy(n),t=Qe().gapi;return U(t,n,"internal-error"),e.open({where:document.body,url:ev(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Xy,dontclear:!0},r=>new Promise((i,o)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=tn(n,"network-request-failed"),u=Qe().setTimeout(()=>{o(a)},Qy.get());function h(){Qe().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(a)})})))})}var nv={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rv=500,iv=600,sv="_blank",ov="http://localhost",ps=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function av(n,e,t,r=rv,i=iv){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",h=Object.assign(Object.assign({},nv),{width:r.toString(),height:i.toString(),top:o,left:a}),d=pe().toLowerCase();t&&(u=Qd(d)?sv:t),Kd(d)&&(e=e||ov,h.scrollbars="yes");let p=Object.entries(h).reduce((S,[C,N])=>`${S}${C}=${N},`,"");if(W_(d)&&u!=="_self")return cv(e||"",u),new ps(null);let I=window.open(e||"",u,p);U(I,n,"popup-blocked");try{I.focus()}catch{}return new ps(I)}function cv(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var uv="__/auth/handler",lv="emulator/auth/handler",hv=encodeURIComponent("fac");function Vd(n,e,t,r,i,o){return y(this,null,function*(){U(n.config.authDomain,n,"auth-domain-config-required"),U(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:xt,eventId:i};if(e instanceof ls){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",sd(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,I]of Object.entries(o||{}))a[p]=I}if(e instanceof Oa){let p=e.getScopes().filter(I=>I!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let h=yield n._getAppCheckToken(),d=h?`#${hv}=${encodeURIComponent(h)}`:"";return`${dv(n)}?${Vr(u).slice(1)}${d}`})}function dv({config:n}){return n.emulator?za(n,lv):`https://${n.authDomain}/${uv}`}var Ta="webStorageSupport",qa=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rc,this._completeRedirectFn=Fy,this._overrideRedirectResult=Vy}_openPopup(e,t,r,i){return y(this,null,function*(){var o;Mt((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let a=yield Vd(e,t,r,Aa(),i);return av(e,a,hf())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let o=yield Vd(e,t,r,Aa(),i);return vy(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Mt(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield tv(e),r=new Ba(e);return t.register("authEvent",i=>(U(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ta,{type:Ta},i=>{var o;let a=(o=i?.[0])===null||o===void 0?void 0:o[Ta];a!==void 0&&t(!!a),Je(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=zy(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ef()||Hd()||Ha()}},_f=qa;var Md="@firebase/auth",Ld="1.7.8";var ja=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function fv(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function pv(n){Nt(new Be("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;U(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tf(n)},d=new ka(r,i,o,h);return ty(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Nt(new Be("auth-internal",e=>{let t=sn(e.getProvider("auth").getImmediate());return(r=>new ja(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fe(Md,Ld,fv(n)),fe(Md,Ld,"esm2017")}var mv=5*60,gv=na("authIdTokenMaxAge")||mv,Fd=null,_v=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>gv)return;let i=t?.token;Fd!==i&&(Fd=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function ic(n=Ln()){let e=Fr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Qa(n,{popupRedirectResolver:_f,persistence:[mf,lf,rc]}),r=na("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let a=_v(o.toString());tc(t,a,()=>a(t.currentUser)),ec(t,u=>a(u))}}let i=ea("auth");return i&&Ja(t,`http://${i}`),t}function yv(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}J_({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=tn("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",yv().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});pv("Browser");var yf="auth",Oe=class{constructor(e){return e}},Hr=class{constructor(){return Ur(yf)}};var sc=new bn("angularfire2.auth-instances");function cI(n,e){let t=Yi(yf,n,e);return t&&new Oe(t)}function uI(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Oe(r)}}var lI={provide:Hr,deps:[[new Le,sc]]},hI={provide:Oe,useFactory:cI,deps:[[new Le,sc],ct]};function vf(n,...e){return fe("angularfire",Zt.full,"auth"),Sn([hI,lI,{provide:sc,useFactory:uI(n),multi:!0,deps:[bt,Rn,Bn,en,[new Le,Un],...e]}])}var If=ke(Xa,!0);var wf=ke(ic,!0);var Ef=ke(Za,!0);var _s=ke(nc,!0);var Tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Af={};var Ut,oc;(function(){var n;function e(w,m){function _(){}_.prototype=m.prototype,w.D=m.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(v,E,A){for(var g=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)g[rt-2]=arguments[rt];return m.prototype[E].apply(v,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,m,_){_||(_=0);var v=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)v[E]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(E=0;16>E;++E)v[E]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=w.g[0],_=w.g[1],E=w.g[2];var A=w.g[3],g=m+(A^_&(E^A))+v[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[1]+3905402710&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[2]+606105819&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[3]+3250441966&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(A^_&(E^A))+v[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[5]+1200080426&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[6]+2821735955&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[7]+4249261313&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(A^_&(E^A))+v[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[9]+2336552879&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[10]+4294925233&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[11]+2304563134&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(A^_&(E^A))+v[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[13]+4254626195&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[14]+2792965006&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[15]+1236535329&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(E^A&(_^E))+v[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[6]+3225465664&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[11]+643717713&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[0]+3921069994&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^A&(_^E))+v[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[10]+38016083&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[15]+3634488961&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[4]+3889429448&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^A&(_^E))+v[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[14]+3275163606&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[3]+4107603335&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[8]+1163531501&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^A&(_^E))+v[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[2]+4243563512&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[7]+1735328473&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[12]+2368359562&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(_^E^A)+v[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[8]+2272392833&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[11]+1839030562&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[14]+4259657740&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^A)+v[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[4]+1272893353&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[7]+4139469664&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[10]+3200236656&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^A)+v[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[0]+3936430074&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[3]+3572445317&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[6]+76029189&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^A)+v[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[12]+3873151461&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[15]+530742520&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[2]+3299628645&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(E^(_|~A))+v[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[7]+1126891415&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[14]+2878612391&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[5]+4237533241&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~A))+v[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[3]+2399980690&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[10]+4293915773&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[1]+2240044497&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~A))+v[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[15]+4264355552&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[6]+2734768916&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[13]+1309151649&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~A))+v[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[11]+3174756917&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[2]+718787259&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(E+(g<<21&4294967295|g>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+A&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var _=m-this.blockSize,v=this.B,E=this.h,A=0;A<m;){if(E==0)for(;A<=_;)i(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<m;)if(v[E++]=w.charCodeAt(A++),E==this.blockSize){i(this,v),E=0;break}}else for(;A<m;)if(v[E++]=w[A++],E==this.blockSize){i(this,v),E=0;break}}this.h=E,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var _=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=_&255,_/=256;for(this.u(w),w=Array(16),m=_=0;4>m;++m)for(var v=0;32>v;v+=8)w[_++]=this.g[m]>>>v&255;return w};function o(w,m){var _=u;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=m(w)}function a(w,m){this.h=m;for(var _=[],v=!0,E=w.length-1;0<=E;E--){var A=w[E]|0;v&&A==m||(_[E]=A,v=!1)}this.g=_}var u={};function h(w){return-128<=w&&128>w?o(w,function(m){return new a([m|0],0>m?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return I;if(0>w)return k(d(-w));for(var m=[],_=1,v=0;w>=_;v++)m[v]=w/_|0,_*=4294967296;return new a(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return k(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),v=I,E=0;E<w.length;E+=8){var A=Math.min(8,w.length-E),g=parseInt(w.substring(E,E+A),m);8>A?(A=d(Math.pow(m,A)),v=v.j(A).add(d(g))):(v=v.j(_),v=v.add(d(g)))}return v}var I=h(0),S=h(1),C=h(16777216);n=a.prototype,n.m=function(){if(L(this))return-k(this).m();for(var w=0,m=1,_=0;_<this.g.length;_++){var v=this.i(_);w+=(0<=v?v:4294967296+v)*m,m*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(N(this))return"0";if(L(this))return"-"+k(this).toString(w);for(var m=d(Math.pow(w,6)),_=this,v="";;){var E=ne(_,m).g;_=z(_,E.j(m));var A=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=E,N(_))return A+v;for(;6>A.length;)A="0"+A;v=A+v}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function N(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function L(w){return w.h==-1}n.l=function(w){return w=z(this,w),L(w)?-1:N(w)?0:1};function k(w){for(var m=w.g.length,_=[],v=0;v<m;v++)_[v]=~w.g[v];return new a(_,~w.h).add(S)}n.abs=function(){return L(this)?k(this):this},n.add=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0,E=0;E<=m;E++){var A=v+(this.i(E)&65535)+(w.i(E)&65535),g=(A>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);v=g>>>16,A&=65535,g&=65535,_[E]=g<<16|A}return new a(_,_[_.length-1]&-2147483648?-1:0)};function z(w,m){return w.add(k(m))}n.j=function(w){if(N(this)||N(w))return I;if(L(this))return L(w)?k(this).j(k(w)):k(k(this).j(w));if(L(w))return k(this.j(k(w)));if(0>this.l(C)&&0>w.l(C))return d(this.m()*w.m());for(var m=this.g.length+w.g.length,_=[],v=0;v<2*m;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(var E=0;E<w.g.length;E++){var A=this.i(v)>>>16,g=this.i(v)&65535,rt=w.i(E)>>>16,dr=w.i(E)&65535;_[2*v+2*E]+=g*dr,K(_,2*v+2*E),_[2*v+2*E+1]+=A*dr,K(_,2*v+2*E+1),_[2*v+2*E+1]+=g*rt,K(_,2*v+2*E+1),_[2*v+2*E+2]+=A*rt,K(_,2*v+2*E+2)}for(v=0;v<m;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=m;v<2*m;v++)_[v]=0;return new a(_,0)};function K(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function H(w,m){this.g=w,this.h=m}function ne(w,m){if(N(m))throw Error("division by zero");if(N(w))return new H(I,I);if(L(w))return m=ne(k(w),m),new H(k(m.g),k(m.h));if(L(m))return m=ne(w,k(m)),new H(k(m.g),m.h);if(30<w.g.length){if(L(w)||L(m))throw Error("slowDivide_ only works with positive integers.");for(var _=S,v=m;0>=v.l(w);)_=Ce(_),v=Ce(v);var E=Z(_,1),A=Z(v,1);for(v=Z(v,2),_=Z(_,2);!N(v);){var g=A.add(v);0>=g.l(w)&&(E=E.add(_),A=g),v=Z(v,1),_=Z(_,1)}return m=z(w,E.j(m)),new H(E,m)}for(E=I;0<=w.l(m);){for(_=Math.max(1,Math.floor(w.m()/m.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),A=d(_),g=A.j(m);L(g)||0<g.l(w);)_-=v,A=d(_),g=A.j(m);N(A)&&(A=S),E=E.add(A),w=z(w,g)}return new H(E,w)}n.A=function(w){return ne(this,w).h},n.and=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)&w.i(v);return new a(_,this.h&w.h)},n.or=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)|w.i(v);return new a(_,this.h|w.h)},n.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)^w.i(v);return new a(_,this.h^w.h)};function Ce(w){for(var m=w.g.length+1,_=[],v=0;v<m;v++)_[v]=w.i(v)<<1|w.i(v-1)>>>31;return new a(_,w.h)}function Z(w,m){var _=m>>5;m%=32;for(var v=w.g.length-_,E=[],A=0;A<v;A++)E[A]=0<m?w.i(A+_)>>>m|w.i(A+_+1)<<32-m:w.i(A+_);return new a(E,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,oc=Af.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Ut=Af.Integer=a}).apply(typeof Tf<"u"?Tf:typeof self<"u"?self:typeof window<"u"?window:{});var vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dt={};var ac,cc,$n,uc,Qr,Is,lc,hc,dc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof vs=="object"&&vs];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var T=s[f];if(!(T in l))break e;l=l[T]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,T={next:function(){if(!f&&l<s.length){var b=l++;return{value:c(b,s[b]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function p(s,c,l){return s.call.apply(s.bind,arguments)}function I(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),s.apply(c,T)}}return function(){return s.apply(c,arguments)}}function S(s,c,l){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:I,S.apply(null,arguments)}function C(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function N(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,T,b){for(var D=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)D[ee-2]=arguments[ee];return c.prototype[T].apply(f,D)}}function L(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function k(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let T=s.length||0,b=f.length||0;s.length=T+b;for(let D=0;D<b;D++)s[T+D]=f[D]}else s.push(f)}}class z{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function K(s){return/^[\s\xa0]*$/.test(s)}function H(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function ne(s){return ne[" "](s),s}ne[" "]=function(){};var Ce=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function Z(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function w(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function m(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(s,c){let l,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(l in f)s[l]=f[l];for(let b=0;b<_.length;b++)l=_[b],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function E(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function A(s){u.setTimeout(()=>{throw s},0)}function g(){var s=Io;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class rt{constructor(){this.h=this.g=null}add(c,l){let f=dr.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var dr=new z(()=>new km,s=>s.reset());class km{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let fr,pr=!1,Io=new rt,Tl=()=>{let s=u.Promise.resolve(void 0);fr=()=>{s.then(Nm)}};var Nm=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){A(l)}var c=dr;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}pr=!1};function yt(){this.s=this.s,this.C=this.C}yt.prototype.s=!1,yt.prototype.ma=function(){this.s||(this.s=!0,this.N())},yt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ie(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}Ie.prototype.h=function(){this.defaultPrevented=!0};var xm=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s}();function mr(s,c){if(Ie.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(Ce){e:{try{ne(c.nodeName);var T=!0;break e}catch{}T=!1}T||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:Om[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&mr.aa.h.call(this)}}N(mr,Ie);var Om={2:"touch",3:"pen",4:"mouse"};mr.prototype.h=function(){mr.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var gr="closure_listenable_"+(1e6*Math.random()|0),Vm=0;function Mm(s,c,l,f,T){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=T,this.key=++Vm,this.da=this.fa=!1}function wi(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Ei(s){this.src=s,this.g={},this.h=0}Ei.prototype.add=function(s,c,l,f,T){var b=s.toString();s=this.g[b],s||(s=this.g[b]=[],this.h++);var D=Eo(s,c,f,T);return-1<D?(c=s[D],l||(c.fa=!1)):(c=new Mm(c,this.src,b,!!f,T),c.fa=l,s.push(c)),c};function wo(s,c){var l=c.type;if(l in s.g){var f=s.g[l],T=Array.prototype.indexOf.call(f,c,void 0),b;(b=0<=T)&&Array.prototype.splice.call(f,T,1),b&&(wi(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function Eo(s,c,l,f){for(var T=0;T<s.length;++T){var b=s[T];if(!b.da&&b.listener==c&&b.capture==!!l&&b.ha==f)return T}return-1}var To="closure_lm_"+(1e6*Math.random()|0),Ao={};function Al(s,c,l,f,T){if(f&&f.once)return Sl(s,c,l,f,T);if(Array.isArray(c)){for(var b=0;b<c.length;b++)Al(s,c[b],l,f,T);return null}return l=Co(l),s&&s[gr]?s.K(c,l,d(f)?!!f.capture:!!f,T):bl(s,c,l,!1,f,T)}function bl(s,c,l,f,T,b){if(!c)throw Error("Invalid event type");var D=d(T)?!!T.capture:!!T,ee=So(s);if(ee||(s[To]=ee=new Ei(s)),l=ee.add(c,l,f,D,b),l.proxy)return l;if(f=Lm(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)xm||(T=D),T===void 0&&(T=!1),s.addEventListener(c.toString(),f,T);else if(s.attachEvent)s.attachEvent(Cl(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function Lm(){function s(l){return c.call(s.src,s.listener,l)}let c=Fm;return s}function Sl(s,c,l,f,T){if(Array.isArray(c)){for(var b=0;b<c.length;b++)Sl(s,c[b],l,f,T);return null}return l=Co(l),s&&s[gr]?s.L(c,l,d(f)?!!f.capture:!!f,T):bl(s,c,l,!0,f,T)}function Rl(s,c,l,f,T){if(Array.isArray(c))for(var b=0;b<c.length;b++)Rl(s,c[b],l,f,T);else f=d(f)?!!f.capture:!!f,l=Co(l),s&&s[gr]?(s=s.i,c=String(c).toString(),c in s.g&&(b=s.g[c],l=Eo(b,l,f,T),-1<l&&(wi(b[l]),Array.prototype.splice.call(b,l,1),b.length==0&&(delete s.g[c],s.h--)))):s&&(s=So(s))&&(c=s.g[c.toString()],s=-1,c&&(s=Eo(c,l,f,T)),(l=-1<s?c[s]:null)&&bo(l))}function bo(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[gr])wo(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(Cl(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=So(c))?(wo(l,s),l.h==0&&(l.src=null,c[To]=null)):wi(s)}}}function Cl(s){return s in Ao?Ao[s]:Ao[s]="on"+s}function Fm(s,c){if(s.da)s=!0;else{c=new mr(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&bo(s),s=l.call(f,c)}return s}function So(s){return s=s[To],s instanceof Ei?s:null}var Ro="__closure_events_fn_"+(1e9*Math.random()>>>0);function Co(s){return typeof s=="function"?s:(s[Ro]||(s[Ro]=function(c){return s.handleEvent(c)}),s[Ro])}function we(){yt.call(this),this.i=new Ei(this),this.M=this,this.F=null}N(we,yt),we.prototype[gr]=!0,we.prototype.removeEventListener=function(s,c,l,f){Rl(this,s,c,l,f)};function Pe(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new Ie(c,s);else if(c instanceof Ie)c.target=c.target||s;else{var T=c;c=new Ie(f,s),v(c,T)}if(T=!0,l)for(var b=l.length-1;0<=b;b--){var D=c.g=l[b];T=Ti(D,f,!0,c)&&T}if(D=c.g=s,T=Ti(D,f,!0,c)&&T,T=Ti(D,f,!1,c)&&T,l)for(b=0;b<l.length;b++)D=c.g=l[b],T=Ti(D,f,!1,c)&&T}we.prototype.N=function(){if(we.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)wi(l[f]);delete s.g[c],s.h--}}this.F=null},we.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},we.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function Ti(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var T=!0,b=0;b<c.length;++b){var D=c[b];if(D&&!D.da&&D.capture==l){var ee=D.listener,ge=D.ha||D.src;D.fa&&wo(s.i,D),T=ee.call(ge,f)!==!1&&T}}return T&&!f.defaultPrevented}function Pl(s,c,l){if(typeof s=="function")l&&(s=S(s,l));else if(s&&typeof s.handleEvent=="function")s=S(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function Dl(s){s.g=Pl(()=>{s.g=null,s.i&&(s.i=!1,Dl(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Um extends yt{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Dl(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _r(s){yt.call(this),this.h=s,this.g={}}N(_r,yt);var kl=[];function Nl(s){Z(s.g,function(c,l){this.g.hasOwnProperty(l)&&bo(c)},s),s.g={}}_r.prototype.N=function(){_r.aa.N.call(this),Nl(this)},_r.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Po=u.JSON.stringify,Bm=u.JSON.parse,qm=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function Do(){}Do.prototype.h=null;function xl(s){return s.h||(s.h=s.i())}function Ol(){}var yr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ko(){Ie.call(this,"d")}N(ko,Ie);function No(){Ie.call(this,"c")}N(No,Ie);var Wt={},Vl=null;function Ai(){return Vl=Vl||new we}Wt.La="serverreachability";function Ml(s){Ie.call(this,Wt.La,s)}N(Ml,Ie);function vr(s){let c=Ai();Pe(c,new Ml(c))}Wt.STAT_EVENT="statevent";function Ll(s,c){Ie.call(this,Wt.STAT_EVENT,s),this.stat=c}N(Ll,Ie);function De(s){let c=Ai();Pe(c,new Ll(c,s))}Wt.Ma="timingevent";function Fl(s,c){Ie.call(this,Wt.Ma,s),this.size=c}N(Fl,Ie);function Ir(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function wr(){this.g=!0}wr.prototype.xa=function(){this.g=!1};function jm(s,c,l,f,T,b){s.info(function(){if(s.g)if(b)for(var D="",ee=b.split("&"),ge=0;ge<ee.length;ge++){var Y=ee[ge].split("=");if(1<Y.length){var Ee=Y[0];Y=Y[1];var Te=Ee.split("_");D=2<=Te.length&&Te[1]=="type"?D+(Ee+"="+Y+"&"):D+(Ee+"=redacted&")}}else D=null;else D=b;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+c+`
`+l+`
`+D})}function $m(s,c,l,f,T,b,D){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+c+`
`+l+`
`+b+" "+D})}function In(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+Gm(s,l)+(f?" "+f:"")})}function zm(s,c){s.info(function(){return"TIMEOUT: "+c})}wr.prototype.info=function(){};function Gm(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var b=T[0];if(b!="noop"&&b!="stop"&&b!="close")for(var D=1;D<T.length;D++)T[D]=""}}}}return Po(l)}catch{return c}}var bi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ul={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xo;function Si(){}N(Si,Do),Si.prototype.g=function(){return new XMLHttpRequest},Si.prototype.i=function(){return{}},xo=new Si;function vt(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new _r(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bl}function Bl(){this.i=null,this.g="",this.h=!1}var ql={},Oo={};function Vo(s,c,l){s.L=1,s.v=Di(it(c)),s.m=l,s.P=!0,jl(s,null)}function jl(s,c){s.F=Date.now(),Ri(s),s.A=it(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),nh(l.i,"t",f),s.C=0,l=s.j.J,s.h=new Bl,s.g=Ih(s.j,l?c:null,!s.m),0<s.O&&(s.M=new Um(S(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var T="readystatechange";Array.isArray(T)||(T&&(kl[0]=T.toString()),T=kl);for(var b=0;b<T.length;b++){var D=Al(l,T[b],f||c.handleEvent,!1,c.h||c);if(!D)break;c.g[D.key]=D}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),vr(),jm(s.i,s.u,s.A,s.l,s.R,s.m)}vt.prototype.ca=function(s){s=s.target;let c=this.M;c&&st(s)==3?c.j():this.Y(s)},vt.prototype.Y=function(s){try{if(s==this.g)e:{let Te=st(this.g);var c=this.g.Ba();let Tn=this.g.Z();if(!(3>Te)&&(Te!=3||this.g&&(this.h.h||this.g.oa()||uh(this.g)))){this.J||Te!=4||c==7||(c==8||0>=Tn?vr(3):vr(2)),Mo(this);var l=this.g.Z();this.X=l;t:if($l(this)){var f=uh(this.g);s="";var T=f.length,b=st(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Kt(this),Er(this);var D="";break t}this.h.i=new u.TextDecoder}for(c=0;c<T;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(b&&c==T-1)});f.length=0,this.h.g+=s,this.C=0,D=this.h.g}else D=this.g.oa();if(this.o=l==200,$m(this.i,this.u,this.A,this.l,this.R,Te,l),this.o){if(this.T&&!this.K){t:{if(this.g){var ee,ge=this.g;if((ee=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(ee)){var Y=ee;break t}}Y=null}if(l=Y)In(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Lo(this,l);else{this.o=!1,this.s=3,De(12),Kt(this),Er(this);break e}}if(this.P){l=!0;let qe;for(;!this.J&&this.C<D.length;)if(qe=Wm(this,D),qe==Oo){Te==4&&(this.s=4,De(14),l=!1),In(this.i,this.l,null,"[Incomplete Response]");break}else if(qe==ql){this.s=4,De(15),In(this.i,this.l,D,"[Invalid Chunk]"),l=!1;break}else In(this.i,this.l,qe,null),Lo(this,qe);if($l(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Te!=4||D.length!=0||this.h.h||(this.s=1,De(16),l=!1),this.o=this.o&&l,!l)In(this.i,this.l,D,"[Invalid Chunked Response]"),Kt(this),Er(this);else if(0<D.length&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.ba&&!Ee.M&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),$o(Ee),Ee.M=!0,De(11))}}else In(this.i,this.l,D,null),Lo(this,D);Te==4&&Kt(this),this.o&&!this.J&&(Te==4?gh(this.j,this):(this.o=!1,Ri(this)))}else ug(this.g),l==400&&0<D.indexOf("Unknown SID")?(this.s=3,De(12)):(this.s=0,De(13)),Kt(this),Er(this)}}}catch{}finally{}};function $l(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function Wm(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?Oo:(l=Number(c.substring(l,f)),isNaN(l)?ql:(f+=1,f+l>c.length?Oo:(c=c.slice(f,f+l),s.C=f+l,c)))}vt.prototype.cancel=function(){this.J=!0,Kt(this)};function Ri(s){s.S=Date.now()+s.I,zl(s,s.I)}function zl(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=Ir(S(s.ba,s),c)}function Mo(s){s.B&&(u.clearTimeout(s.B),s.B=null)}vt.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(zm(this.i,this.A),this.L!=2&&(vr(),De(17)),Kt(this),this.s=2,Er(this)):zl(this,this.S-s)};function Er(s){s.j.G==0||s.J||gh(s.j,s)}function Kt(s){Mo(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,Nl(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function Lo(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||Fo(l.h,s))){if(!s.K&&Fo(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)Vi(l),xi(l);else break e;jo(l),De(18)}}else l.za=T[1],0<l.za-l.T&&37500>T[2]&&l.F&&l.v==0&&!l.C&&(l.C=Ir(S(l.Za,l),6e3));if(1>=Kl(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else Qt(l,11)}else if((s.K||l.g==s)&&Vi(l),!K(c))for(T=l.Da.g.parse(c),c=0;c<T.length;c++){let Y=T[c];if(l.T=Y[0],Y=Y[1],l.G==2)if(Y[0]=="c"){l.K=Y[1],l.ia=Y[2];let Ee=Y[3];Ee!=null&&(l.la=Ee,l.j.info("VER="+l.la));let Te=Y[4];Te!=null&&(l.Aa=Te,l.j.info("SVER="+l.Aa));let Tn=Y[5];Tn!=null&&typeof Tn=="number"&&0<Tn&&(f=1.5*Tn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let qe=s.g;if(qe){let Li=qe.g?qe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Li){var b=f.h;b.g||Li.indexOf("spdy")==-1&&Li.indexOf("quic")==-1&&Li.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(Uo(b,b.h),b.h=null))}if(f.D){let zo=qe.g?qe.g.getResponseHeader("X-HTTP-Session-Id"):null;zo&&(f.ya=zo,re(f.I,f.D,zo))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var D=s;if(f.qa=vh(f,f.J?f.ia:null,f.W),D.K){Hl(f.h,D);var ee=D,ge=f.L;ge&&(ee.I=ge),ee.B&&(Mo(ee),Ri(ee)),f.g=D}else ph(f);0<l.i.length&&Oi(l)}else Y[0]!="stop"&&Y[0]!="close"||Qt(l,7);else l.G==3&&(Y[0]=="stop"||Y[0]=="close"?Y[0]=="stop"?Qt(l,7):qo(l):Y[0]!="noop"&&l.l&&l.l.ta(Y),l.v=0)}}vr(4)}catch{}}var Km=class{constructor(s,c){this.g=s,this.map=c}};function Gl(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wl(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Kl(s){return s.h?1:s.g?s.g.size:0}function Fo(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function Uo(s,c){s.g?s.g.add(c):s.h=c}function Hl(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}Gl.prototype.cancel=function(){if(this.i=Ql(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Ql(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return L(s.i)}function Hm(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function Qm(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function Jl(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=Qm(s),f=Hm(s),T=f.length,b=0;b<T;b++)c.call(void 0,f[b],l&&l[b],s)}var Yl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jm(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),T=null;if(0<=f){var b=s[l].substring(0,f);T=s[l].substring(f+1)}else b=s[l];c(b,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Ht(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof Ht){this.h=s.h,Ci(this,s.j),this.o=s.o,this.g=s.g,Pi(this,s.s),this.l=s.l;var c=s.i,l=new br;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),Xl(this,l),this.m=s.m}else s&&(c=String(s).match(Yl))?(this.h=!1,Ci(this,c[1]||"",!0),this.o=Tr(c[2]||""),this.g=Tr(c[3]||"",!0),Pi(this,c[4]),this.l=Tr(c[5]||"",!0),Xl(this,c[6]||"",!0),this.m=Tr(c[7]||"")):(this.h=!1,this.i=new br(null,this.h))}Ht.prototype.toString=function(){var s=[],c=this.j;c&&s.push(Ar(c,Zl,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(Ar(c,Zl,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(Ar(l,l.charAt(0)=="/"?Zm:Xm,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",Ar(l,tg)),s.join("")};function it(s){return new Ht(s)}function Ci(s,c,l){s.j=l?Tr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Pi(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function Xl(s,c,l){c instanceof br?(s.i=c,ng(s.i,s.h)):(l||(c=Ar(c,eg)),s.i=new br(c,s.h))}function re(s,c,l){s.i.set(c,l)}function Di(s){return re(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function Tr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function Ar(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,Ym),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function Ym(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Zl=/[#\/\?@]/g,Xm=/[#\?:]/g,Zm=/[#\?]/g,eg=/[#\?@]/g,tg=/#/g;function br(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function It(s){s.g||(s.g=new Map,s.h=0,s.i&&Jm(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=br.prototype,n.add=function(s,c){It(this),this.i=null,s=wn(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function eh(s,c){It(s),c=wn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function th(s,c){return It(s),c=wn(s,c),s.g.has(c)}n.forEach=function(s,c){It(this),this.g.forEach(function(l,f){l.forEach(function(T){s.call(c,T,f,this)},this)},this)},n.na=function(){It(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let T=s[f];for(let b=0;b<T.length;b++)l.push(c[f])}return l},n.V=function(s){It(this);let c=[];if(typeof s=="string")th(this,s)&&(c=c.concat(this.g.get(wn(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return It(this),this.i=null,s=wn(this,s),th(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function nh(s,c,l){eh(s,c),0<l.length&&(s.i=null,s.g.set(wn(s,c),L(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let b=encodeURIComponent(String(f)),D=this.V(f);for(f=0;f<D.length;f++){var T=b;D[f]!==""&&(T+="="+encodeURIComponent(String(D[f]))),s.push(T)}}return this.i=s.join("&")};function wn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function ng(s,c){c&&!s.j&&(It(s),s.i=null,s.g.forEach(function(l,f){var T=f.toLowerCase();f!=T&&(eh(this,f),nh(this,T,l))},s)),s.j=c}function rg(s,c){let l=new wr;if(u.Image){let f=new Image;f.onload=C(wt,l,"TestLoadImage: loaded",!0,c,f),f.onerror=C(wt,l,"TestLoadImage: error",!1,c,f),f.onabort=C(wt,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=C(wt,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function ig(s,c){let l=new wr,f=new AbortController,T=setTimeout(()=>{f.abort(),wt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(b=>{clearTimeout(T),b.ok?wt(l,"TestPingServer: ok",!0,c):wt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),wt(l,"TestPingServer: error",!1,c)})}function wt(s,c,l,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(l)}catch{}}function sg(){this.g=new qm}function og(s,c,l){let f=l||"";try{Jl(s,function(T,b){let D=T;d(T)&&(D=Po(T)),c.push(f+b+"="+encodeURIComponent(D))})}catch(T){throw c.push(f+"type="+encodeURIComponent("_badmap")),T}}function Sr(s){this.l=s.Ub||null,this.j=s.eb||!1}N(Sr,Do),Sr.prototype.g=function(){return new ki(this.l,this.j)},Sr.prototype.i=function(s){return function(){return s}}({});function ki(s,c){we.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(ki,we),n=ki.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,Cr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Rr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Cr(this)),this.g&&(this.readyState=3,Cr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;rh(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function rh(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?Rr(this):Cr(this),this.readyState==3&&rh(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,Rr(this))},n.Qa=function(s){this.g&&(this.response=s,Rr(this))},n.ga=function(){this.g&&Rr(this)};function Rr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,Cr(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function Cr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(ki.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function ih(s){let c="";return Z(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function Bo(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=ih(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):re(s,c,l))}function oe(s){we.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(oe,we);var ag=/^https?$/i,cg=["POST","PUT"];n=oe.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xo.g(),this.v=this.o?xl(this.o):xl(xo),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(b){sh(this,b);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)l.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let b of f.keys())l.set(b,f.get(b));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(b=>b.toLowerCase()=="content-type"),T=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(cg,c,void 0))||f||T||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,D]of l)this.g.setRequestHeader(b,D);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ch(this),this.u=!0,this.g.send(s),this.u=!1}catch(b){sh(this,b)}};function sh(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,oh(s),Ni(s)}function oh(s){s.A||(s.A=!0,Pe(s,"complete"),Pe(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,Pe(this,"complete"),Pe(this,"abort"),Ni(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ni(this,!0)),oe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ah(this):this.bb())},n.bb=function(){ah(this)};function ah(s){if(s.h&&typeof a<"u"&&(!s.v[1]||st(s)!=4||s.Z()!=2)){if(s.u&&st(s)==4)Pl(s.Ea,0,s);else if(Pe(s,"readystatechange"),st(s)==4){s.h=!1;try{let D=s.Z();e:switch(D){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=D===0){var T=String(s.D).match(Yl)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),f=!ag.test(T?T.toLowerCase():"")}l=f}if(l)Pe(s,"complete"),Pe(s,"success");else{s.m=6;try{var b=2<st(s)?s.g.statusText:""}catch{b=""}s.l=b+" ["+s.Z()+"]",oh(s)}}finally{Ni(s)}}}}function Ni(s,c){if(s.g){ch(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||Pe(s,"ready");try{l.onreadystatechange=f}catch{}}}function ch(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function st(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<st(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Bm(c)}};function uh(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function ug(s){let c={};s=(s.g&&2<=st(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(K(s[f]))continue;var l=E(s[f]);let T=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let b=c[T]||[];c[T]=b,b.push(l)}w(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function lh(s){this.Aa=0,this.i=[],this.j=new wr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pr("baseRetryDelayMs",5e3,s),this.cb=Pr("retryDelaySeedMs",1e4,s),this.Wa=Pr("forwardChannelMaxRetries",2,s),this.wa=Pr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new Gl(s&&s.concurrentRequestLimit),this.Da=new sg,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=lh.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){De(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=vh(this,null,this.W),Oi(this)};function qo(s){if(hh(s),s.G==3){var c=s.U++,l=it(s.I);if(re(l,"SID",s.K),re(l,"RID",c),re(l,"TYPE","terminate"),Dr(s,l),c=new vt(s,s.j,c),c.L=2,c.v=Di(it(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=Ih(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Ri(c)}yh(s)}function xi(s){s.g&&($o(s),s.g.cancel(),s.g=null)}function hh(s){xi(s),s.u&&(u.clearTimeout(s.u),s.u=null),Vi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function Oi(s){if(!Wl(s.h)&&!s.s){s.s=!0;var c=s.Ga;fr||Tl(),pr||(fr(),pr=!0),Io.add(c,s),s.B=0}}function lg(s,c){return Kl(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=Ir(S(s.Ga,s,c),_h(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let T=new vt(this,this.j,s),b=this.o;if(this.S&&(b?(b=m(b),v(b,this.S)):b=this.S),this.m!==null||this.O||(T.H=b,b=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=fh(this,T,c),l=it(this.I),re(l,"RID",s),re(l,"CVER",22),this.D&&re(l,"X-HTTP-Session-Id",this.D),Dr(this,l),b&&(this.O?c="headers="+encodeURIComponent(String(ih(b)))+"&"+c:this.m&&Bo(l,this.m,b)),Uo(this.h,T),this.Ua&&re(l,"TYPE","init"),this.P?(re(l,"$req",c),re(l,"SID","null"),T.T=!0,Vo(T,l,null)):Vo(T,l,c),this.G=2}}else this.G==3&&(s?dh(this,s):this.i.length==0||Wl(this.h)||dh(this))};function dh(s,c){var l;c?l=c.l:l=s.U++;let f=it(s.I);re(f,"SID",s.K),re(f,"RID",l),re(f,"AID",s.T),Dr(s,f),s.m&&s.o&&Bo(f,s.m,s.o),l=new vt(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=fh(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),Uo(s.h,l),Vo(l,f,c)}function Dr(s,c){s.H&&Z(s.H,function(l,f){re(c,f,l)}),s.l&&Jl({},function(l,f){re(c,f,l)})}function fh(s,c,l){l=Math.min(s.i.length,l);var f=s.l?S(s.l.Na,s.l,s):null;e:{var T=s.i;let b=-1;for(;;){let D=["count="+l];b==-1?0<l?(b=T[0].g,D.push("ofs="+b)):b=0:D.push("ofs="+b);let ee=!0;for(let ge=0;ge<l;ge++){let Y=T[ge].g,Ee=T[ge].map;if(Y-=b,0>Y)b=Math.max(0,T[ge].g-100),ee=!1;else try{og(Ee,D,"req"+Y+"_")}catch{f&&f(Ee)}}if(ee){f=D.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function ph(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;fr||Tl(),pr||(fr(),pr=!0),Io.add(c,s),s.v=0}}function jo(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=Ir(S(s.Fa,s),_h(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,mh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=Ir(S(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,De(10),xi(this),mh(this))};function $o(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function mh(s){s.g=new vt(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=it(s.qa);re(c,"RID","rpc"),re(c,"SID",s.K),re(c,"AID",s.T),re(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&re(c,"TO",s.ja),re(c,"TYPE","xmlhttp"),Dr(s,c),s.m&&s.o&&Bo(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=Di(it(c)),l.m=null,l.P=!0,jl(l,s)}n.Za=function(){this.C!=null&&(this.C=null,xi(this),jo(this),De(19))};function Vi(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function gh(s,c){var l=null;if(s.g==c){Vi(s),$o(s),s.g=null;var f=2}else if(Fo(s.h,c))l=c.D,Hl(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var T=s.B;f=Ai(),Pe(f,new Fl(f,l)),Oi(s)}else ph(s);else if(T=c.s,T==3||T==0&&0<c.X||!(f==1&&lg(s,c)||f==2&&jo(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),T){case 1:Qt(s,5);break;case 4:Qt(s,10);break;case 3:Qt(s,6);break;default:Qt(s,2)}}}function _h(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function Qt(s,c){if(s.j.info("Error code "+c),c==2){var l=S(s.fb,s),f=s.Xa;let T=!f;f=new Ht(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ci(f,"https"),Di(f),T?rg(f.toString(),l):ig(f.toString(),l)}else De(2);s.G=0,s.l&&s.l.sa(c),yh(s),hh(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),De(2)):(this.j.info("Failed to ping google.com"),De(1))};function yh(s){if(s.G=0,s.ka=[],s.l){let c=Ql(s.h);(c.length!=0||s.i.length!=0)&&(k(s.ka,c),k(s.ka,s.i),s.h.i.length=0,L(s.i),s.i.length=0),s.l.ra()}}function vh(s,c,l){var f=l instanceof Ht?it(l):new Ht(l);if(f.g!="")c&&(f.g=c+"."+f.g),Pi(f,f.s);else{var T=u.location;f=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;var b=new Ht(null);f&&Ci(b,f),c&&(b.g=c),T&&Pi(b,T),l&&(b.l=l),f=b}return l=s.D,c=s.ya,l&&c&&re(f,l,c),re(f,"VER",s.la),Dr(s,f),f}function Ih(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new oe(new Sr({eb:l})):new oe(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function wh(){}n=wh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Mi(){}Mi.prototype.g=function(s,c){return new Ne(s,c)};function Ne(s,c){we.call(this),this.g=new lh(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!K(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!K(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new En(this)}N(Ne,we),Ne.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ne.prototype.close=function(){qo(this.g)},Ne.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=Po(s),s=l);c.i.push(new Km(c.Ya++,s)),c.G==3&&Oi(c)},Ne.prototype.N=function(){this.g.l=null,delete this.j,qo(this.g),delete this.g,Ne.aa.N.call(this)};function Eh(s){ko.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}N(Eh,ko);function Th(){No.call(this),this.status=1}N(Th,No);function En(s){this.g=s}N(En,wh),En.prototype.ua=function(){Pe(this.g,"a")},En.prototype.ta=function(s){Pe(this.g,new Eh(s))},En.prototype.sa=function(s){Pe(this.g,new Th)},En.prototype.ra=function(){Pe(this.g,"b")},Mi.prototype.createWebChannel=Mi.prototype.g,Ne.prototype.send=Ne.prototype.o,Ne.prototype.open=Ne.prototype.m,Ne.prototype.close=Ne.prototype.close,dc=dt.createWebChannelTransport=function(){return new Mi},hc=dt.getStatEventTarget=function(){return Ai()},lc=dt.Event=Wt,Is=dt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},bi.NO_ERROR=0,bi.TIMEOUT=8,bi.HTTP_ERROR=6,Qr=dt.ErrorCode=bi,Ul.COMPLETE="complete",uc=dt.EventType=Ul,Ol.EventType=yr,yr.OPEN="a",yr.CLOSE="b",yr.ERROR="c",yr.MESSAGE="d",we.prototype.listen=we.prototype.K,$n=dt.WebChannel=Ol,cc=dt.FetchXmlHttpFactory=Sr,oe.prototype.listenOnce=oe.prototype.L,oe.prototype.getLastError=oe.prototype.Ka,oe.prototype.getLastErrorCode=oe.prototype.Ba,oe.prototype.getStatus=oe.prototype.Z,oe.prototype.getResponseJson=oe.prototype.Oa,oe.prototype.getResponseText=oe.prototype.oa,oe.prototype.send=oe.prototype.ea,oe.prototype.setWithCredentials=oe.prototype.Ha,ac=dt.XhrIo=oe}).apply(typeof vs<"u"?vs:typeof self<"u"?self:typeof window<"u"?window:{});var bf="@firebase/firestore";var me=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};me.UNAUTHENTICATED=new me(null),me.GOOGLE_CREDENTIALS=new me("google-credentials-uid"),me.FIRST_PARTY=new me("first-party-uid"),me.MOCK_USER=new me("mock-user");var cr="10.13.1";var ln=new Dt("@firebase/firestore");function Jr(){return ln.logLevel}function M(n,...e){if(ln.logLevel<=G.DEBUG){let t=e.map(Xu);ln.debug(`Firestore (${cr}): ${n}`,...t)}}function pt(n,...e){if(ln.logLevel<=G.ERROR){let t=e.map(Xu);ln.error(`Firestore (${cr}): ${n}`,...t)}}function Jn(n,...e){if(ln.logLevel<=G.WARN){let t=e.map(Xu);ln.warn(`Firestore (${cr}): ${n}`,...t)}}function Xu(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function B(n="Unexpected state"){let e=`FIRESTORE (${cr}) INTERNAL ASSERTION FAILED: `+n;throw pt(e),new Error(e)}function te(n,e){n||B()}function j(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},O=class extends xe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ft=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var bs=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},_c=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(me.UNAUTHENTICATED))}shutdown(){}},yc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},vc=class{constructor(e){this.t=e,this.currentUser=me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new ft;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ft,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>y(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ft)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string"),new bs(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string"),new me(e)}},Ic=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=me.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},wc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Ic(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(me.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Ec=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Tc=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=o=>{o.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(te(typeof t.token=="string"),this.R=t.token,new Ec(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function dI(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Ss=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=dI(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function X(n,e){return n<e?-1:n>e?1:0}function Yn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var ve=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new O(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new O(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new O(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new O(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var $=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ve(0,0))}static max(){return new n(new ve(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Rs=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(),r===void 0?r=e.length-t:r>e.length-t&&B(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),a=t.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},se=class n extends Rs{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new O(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},fI=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ve=class n extends Rs{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return fI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new O(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new O(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new O(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new O(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var F=class n{constructor(e){this.path=e}static fromPath(e){return new n(se.fromString(e))}static fromName(e){return new n(se.fromString(e).popFirst(5))}static empty(){return new n(se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return se.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new se(e.slice()))}};var Ac=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Ac.UNKNOWN_ID=-1;function pI(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=$.fromTimestamp(r===1e9?new ve(t+1,0):new ve(t,r));return new hn(i,F.empty(),e)}function mI(n){return new hn(n.readTime,n.key,-1)}var hn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n($.min(),F.empty(),-1)}static max(){return new n($.max(),F.empty(),-1)}};function gI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:X(n.largestBatchId,e.largestBatchId))}var _I="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",bc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function mi(n){return y(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==_I)throw n;M("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function yI(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function gi(n){return n.name==="IndexedDbTransactionError"}var op=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function ro(n){return n==null}function ri(n){return n===0&&1/n==-1/0}function vI(n){return typeof n=="number"&&Number.isInteger(n)&&!ri(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var II=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],_0=[...II,"documentOverlays"],wI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],EI=wI,TI=[...EI,"indexConfiguration","indexState","indexEntries"];var y0=[...TI,"globals"];function Sf(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ur(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ap(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ae=class n{constructor(e,t){this.comparator=e,this.root=t||Ze.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ze.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ze.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kn(this.root,e,this.comparator,!0)}},Kn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ze=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();let e=this.left.check();if(e!==this.right.check())throw B();return e+(this.isRed()?0:1)}};Ze.EMPTY=null,Ze.RED=!0,Ze.BLACK=!1;Ze.EMPTY=new class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Ze(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Se=class n{constructor(e){this.comparator=e,this.data=new ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Cs(this.data.getIterator())}getIteratorFrom(e){return new Cs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Cs=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Xe=class n{constructor(e){this.fields=e,e.sort(Ve.comparator)}static empty(){return new n([])}unionWith(e){let t=new Se(Ve.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Yn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Ps=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Re=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Ps("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Re.EMPTY_BYTE_STRING=new Re("");var AI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mt(n){if(te(!!n),typeof n=="string"){let e=0,t=AI.exec(n);if(te(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ie(n.seconds),nanos:ie(n.nanos)}}function ie(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function qt(n){return typeof n=="string"?Re.fromBase64String(n):Re.fromUint8Array(n)}function Zu(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function el(n){let e=n.mapValue.fields.__previous_value__;return Zu(e)?el(e):e}function ii(n){let e=mt(n.mapValue.fields.__local_write_time__.timestampValue);return new ve(e.seconds,e.nanos)}var Sc=class{constructor(e,t,r,i,o,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d}},Ds=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var ws={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function dn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Zu(n)?4:up(n)?9007199254740991:cp(n)?10:11:B()}function nt(n,e){if(n===e)return!0;let t=dn(n);if(t!==dn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ii(n).isEqual(ii(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=mt(i.timestampValue),u=mt(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return qt(i.bytesValue).isEqual(qt(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return ie(i.geoPointValue.latitude)===ie(o.geoPointValue.latitude)&&ie(i.geoPointValue.longitude)===ie(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return ie(i.integerValue)===ie(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=ie(i.doubleValue),u=ie(o.doubleValue);return a===u?ri(a)===ri(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return Yn(n.arrayValue.values||[],e.arrayValue.values||[],nt);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(Sf(a)!==Sf(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!nt(a[h],u[h])))return!1;return!0}(n,e);default:return B()}}function si(n,e){return(n.values||[]).find(t=>nt(t,e))!==void 0}function Xn(n,e){if(n===e)return 0;let t=dn(n),r=dn(e);if(t!==r)return X(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return X(n.booleanValue,e.booleanValue);case 2:return function(o,a){let u=ie(o.integerValue||o.doubleValue),h=ie(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return Rf(n.timestampValue,e.timestampValue);case 4:return Rf(ii(n),ii(e));case 5:return X(n.stringValue,e.stringValue);case 6:return function(o,a){let u=qt(o),h=qt(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=X(u[d],h[d]);if(p!==0)return p}return X(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let u=X(ie(o.latitude),ie(a.latitude));return u!==0?u:X(ie(o.longitude),ie(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Cf(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,h,d,p;let I=o.fields||{},S=a.fields||{},C=(u=I.value)===null||u===void 0?void 0:u.arrayValue,N=(h=S.value)===null||h===void 0?void 0:h.arrayValue,L=X(((d=C?.values)===null||d===void 0?void 0:d.length)||0,((p=N?.values)===null||p===void 0?void 0:p.length)||0);return L!==0?L:Cf(C,N)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===ws.mapValue&&a===ws.mapValue)return 0;if(o===ws.mapValue)return 1;if(a===ws.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let I=0;I<h.length&&I<p.length;++I){let S=X(h[I],p[I]);if(S!==0)return S;let C=Xn(u[h[I]],d[p[I]]);if(C!==0)return C}return X(h.length,p.length)}(n.mapValue,e.mapValue);default:throw B()}}function Rf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return X(n,e);let t=mt(n),r=mt(e),i=X(t.seconds,r.seconds);return i!==0?i:X(t.nanos,r.nanos)}function Cf(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Xn(t[i],r[i]);if(o)return o}return X(t.length,r.length)}function Zn(n){return Rc(n)}function Rc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=mt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return qt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Rc(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${Rc(t.fields[a])}`;return i+"}"}(n.mapValue):B()}function Pf(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Cc(n){return!!n&&"integerValue"in n}function tl(n){return!!n&&"arrayValue"in n}function Df(n){return!!n&&"nullValue"in n}function kf(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ts(n){return!!n&&"mapValue"in n}function cp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Xr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ur(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Xr(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Xr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function up(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var ze=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ts(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xr(t)}setAll(e){let t=Ve.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=Xr(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Ts(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ts(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ur(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Xr(this.value))}};function lp(n){let e=[];return ur(n.fields,(t,r)=>{let i=new Ve([t]);if(Ts(r)){let o=lp(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new Xe(e)}var Ge=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,$.min(),$.min(),$.min(),ze.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,$.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,$.min(),$.min(),ze.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,$.min(),$.min(),ze.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var er=class{constructor(e,t){this.position=e,this.inclusive=t}};function Nf(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=Xn(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function xf(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!nt(n.position[t],e.position[t]))return!1;return!0}var fn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function bI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var ks=class{},le=class n extends ks{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Dc(e,t,r):t==="array-contains"?new xc(e,r):t==="in"?new Oc(e,r):t==="not-in"?new Vc(e,r):t==="array-contains-any"?new Mc(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new kc(e,r):new Nc(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Xn(t,this.value)):t!==null&&dn(this.value)===dn(t)&&this.matchesComparison(Xn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},We=class n extends ks{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return hp(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function hp(n){return n.op==="and"}function dp(n){return SI(n)&&hp(n)}function SI(n){for(let e of n.filters)if(e instanceof We)return!1;return!0}function Pc(n){if(n instanceof le)return n.field.canonicalString()+n.op.toString()+Zn(n.value);if(dp(n))return n.filters.map(e=>Pc(e)).join(",");{let e=n.filters.map(t=>Pc(t)).join(",");return`${n.op}(${e})`}}function fp(n,e){return n instanceof le?function(r,i){return i instanceof le&&r.op===i.op&&r.field.isEqual(i.field)&&nt(r.value,i.value)}(n,e):n instanceof We?function(r,i){return i instanceof We&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&fp(a,i.filters[u]),!0):!1}(n,e):void B()}function pp(n){return n instanceof le?function(t){return`${t.field.canonicalString()} ${t.op} ${Zn(t.value)}`}(n):n instanceof We?function(t){return t.op.toString()+" {"+t.getFilters().map(pp).join(" ,")+"}"}(n):"Filter"}var Dc=class extends le{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){let t=F.comparator(e.key,this.key);return this.matchesComparison(t)}},kc=class extends le{constructor(e,t){super(e,"in",t),this.keys=mp("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Nc=class extends le{constructor(e,t){super(e,"not-in",t),this.keys=mp("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function mp(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}var xc=class extends le{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return tl(t)&&si(t.arrayValue,this.value)}},Oc=class extends le{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&si(this.value.arrayValue,t)}},Vc=class extends le{constructor(e,t){super(e,"not-in",t)}matches(e){if(si(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!si(this.value.arrayValue,t)}},Mc=class extends le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!tl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>si(this.value.arrayValue,r))}};var Lc=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}};function Of(n,e=null,t=[],r=[],i=null,o=null,a=null){return new Lc(n,e,t,r,i,o,a)}function nl(n){let e=j(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Pc(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),ro(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Zn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Zn(r)).join(",")),e.ue=t}return e.ue}function rl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!bI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!fp(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!xf(n.startAt,e.startAt)&&xf(n.endAt,e.endAt)}function Fc(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var jt=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function RI(n,e,t,r,i,o,a,u){return new jt(n,e,t,r,i,o,a,u)}function il(n){return new jt(n)}function Vf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function gp(n){return n.collectionGroup!==null}function Zr(n){let e=j(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Se(Ve.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new fn(o,r))}),t.has(Ve.keyField().canonicalString())||e.ce.push(new fn(Ve.keyField(),r))}return e.ce}function et(n){let e=j(n);return e.le||(e.le=CI(e,Zr(n))),e.le}function CI(n,e){if(n.limitType==="F")return Of(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new fn(i.field,o)});let t=n.endAt?new er(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new er(n.startAt.position,n.startAt.inclusive):null;return Of(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Uc(n,e){let t=n.filters.concat([e]);return new jt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Bc(n,e,t){return new jt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function io(n,e){return rl(et(n),et(e))&&n.limitType===e.limitType}function _p(n){return`${nl(et(n))}|lt:${n.limitType}`}function zn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>pp(i)).join(", ")}]`),ro(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Zn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Zn(i)).join(",")),`Target(${r})`}(et(n))}; limitType=${n.limitType})`}function so(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):F.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of Zr(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=Nf(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,Zr(r),i)||r.endAt&&!function(a,u,h){let d=Nf(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,Zr(r),i))}(n,e)}function PI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function yp(n){return(e,t)=>{let r=!1;for(let i of Zr(n)){let o=DI(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function DI(n,e,t){let r=n.field.isKeyField()?F.comparator(e.key,t.key):function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Xn(h,d):B()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B()}}var $t=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ur(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return ap(this.inner)}size(){return this.innerSize}};var kI=new ae(F.comparator);function gt(){return kI}var vp=new ae(F.comparator);function Yr(...n){let e=vp;for(let t of n)e=e.insert(t.key,t);return e}function Ip(n){let e=vp;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function on(){return ei()}function wp(){return ei()}function ei(){return new $t(n=>n.toString(),(n,e)=>n.isEqual(e))}var NI=new ae(F.comparator),xI=new Se(F.comparator);function W(...n){let e=xI;for(let t of n)e=e.add(t);return e}var OI=new Se(X);function VI(){return OI}function sl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ri(e)?"-0":e}}function Ep(n){return{integerValue:""+n}}function MI(n,e){return vI(e)?Ep(e):sl(n,e)}var tr=class{constructor(){this._=void 0}};function LI(n,e,t){return n instanceof nr?function(i,o){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Zu(o)&&(o=el(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(t,e):n instanceof pn?Ap(n,e):n instanceof mn?bp(n,e):function(i,o){let a=Tp(i,o),u=Mf(a)+Mf(i.Pe);return Cc(a)&&Cc(i.Pe)?Ep(u):sl(i.serializer,u)}(n,e)}function FI(n,e,t){return n instanceof pn?Ap(n,e):n instanceof mn?bp(n,e):t}function Tp(n,e){return n instanceof rr?function(r){return Cc(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var nr=class extends tr{},pn=class extends tr{constructor(e){super(),this.elements=e}};function Ap(n,e){let t=Sp(e);for(let r of n.elements)t.some(i=>nt(i,r))||t.push(r);return{arrayValue:{values:t}}}var mn=class extends tr{constructor(e){super(),this.elements=e}};function bp(n,e){let t=Sp(e);for(let r of n.elements)t=t.filter(i=>!nt(i,r));return{arrayValue:{values:t}}}var rr=class extends tr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Mf(n){return ie(n.integerValue||n.doubleValue)}function Sp(n){return tl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function UI(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof pn&&i instanceof pn||r instanceof mn&&i instanceof mn?Yn(r.elements,i.elements,nt):r instanceof rr&&i instanceof rr?nt(r.Pe,i.Pe):r instanceof nr&&i instanceof nr}(n.transform,e.transform)}var qc=class{constructor(e,t){this.version=e,this.transformResults=t}},un=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function As(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ir=class{};function Rp(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ns(n.key,un.none()):new gn(n.key,n.data,un.none());{let t=n.data,r=ze.empty(),i=new Se(Ve.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new _t(n.key,r,new Xe(i.toArray()),un.none())}}function BI(n,e,t){n instanceof gn?function(i,o,a){let u=i.value.clone(),h=Ff(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof _t?function(i,o,a){if(!As(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=Ff(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Cp(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function ti(n,e,t,r){return n instanceof gn?function(o,a,u,h){if(!As(o.precondition,a))return u;let d=o.value.clone(),p=Uf(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof _t?function(o,a,u,h){if(!As(o.precondition,a))return u;let d=Uf(o.fieldTransforms,h,a),p=a.data;return p.setAll(Cp(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(I=>I.field))}(n,e,t,r):function(o,a,u){return As(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function qI(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=Tp(r.transform,i||null);o!=null&&(t===null&&(t=ze.empty()),t.set(r.field,o))}return t||null}function Lf(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Yn(r,i,(o,a)=>UI(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var gn=class extends ir{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},_t=class extends ir{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Cp(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Ff(n,e,t){let r=new Map;te(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,FI(a,u,t[i]))}return r}function Uf(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,LI(o,a,e))}return r}var Ns=class extends ir{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},jc=class extends ir{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var $c=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&BI(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ti(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ti(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=wp();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=Rp(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument($.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),W())}isEqual(e){return this.batchId===e.batchId&&Yn(this.mutations,e.mutations,(t,r)=>Lf(t,r))&&Yn(this.baseMutations,e.baseMutations,(t,r)=>Lf(t,r))}},zc=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){te(e.mutations.length===r.length);let i=function(){return NI}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var Gc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Wc=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ce,J;function jI(n){switch(n){default:return B();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function Pp(n){if(n===void 0)return pt("GRPC error has no .code"),R.UNKNOWN;switch(n){case ce.OK:return R.OK;case ce.CANCELLED:return R.CANCELLED;case ce.UNKNOWN:return R.UNKNOWN;case ce.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ce.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ce.INTERNAL:return R.INTERNAL;case ce.UNAVAILABLE:return R.UNAVAILABLE;case ce.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ce.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ce.NOT_FOUND:return R.NOT_FOUND;case ce.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ce.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ce.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ce.ABORTED:return R.ABORTED;case ce.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ce.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ce.DATA_LOSS:return R.DATA_LOSS;default:return B()}}(J=ce||(ce={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";var Bf=null;function $I(){return new TextEncoder}var zI=new Ut([4294967295,4294967295],0);function qf(n){let e=$I().encode(n),t=new oc;return t.update(e),new Uint8Array(t.digest())}function jf(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ut([t,r],0),new Ut([i,o],0)]}var Kc=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new an(`Invalid padding: ${t}`);if(r<0)throw new an(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new an(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new an(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ut.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Ut.fromNumber(r)));return i.compare(zI)===1&&(i=new Ut([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=qf(e),[r,i]=jf(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=qf(e),[r,i]=jf(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},an=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var xs=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,oi.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n($.min(),i,new ae(X),gt(),W())}},oi=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,W(),W(),W())}};var Hn=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Os=class{constructor(e,t){this.targetId=e,this.me=t}},Vs=class{constructor(e,t,r=Re.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ms=class{constructor(){this.fe=0,this.ge=zf(),this.pe=Re.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=W(),t=W(),r=W();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:B()}}),new oi(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=zf()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Hc=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=gt(),this.qe=$f(),this.Qe=new ae(X)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:B()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(Fc(o))if(r===0){let a=new F(o.path);this.Ue(t,a,Ge.newNoDocument(a,$.min()))}else te(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),h=u?this.Xe(u,e,a):1;if(h!==0){this.je(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}Bf?.et(function(p,I,S,C,N){var L,k,z,K,H,ne;let Ce={localCacheCount:p,existenceFilterCount:I.count,databaseId:S.database,projectId:S.projectId},Z=I.unchangedNames;return Z&&(Ce.bloomFilter={applied:N===0,hashCount:(L=Z?.hashCount)!==null&&L!==void 0?L:0,bitmapLength:(K=(z=(k=Z?.bits)===null||k===void 0?void 0:k.bitmap)===null||z===void 0?void 0:z.length)!==null&&K!==void 0?K:0,padding:(ne=(H=Z?.bits)===null||H===void 0?void 0:H.padding)!==null&&ne!==void 0?ne:0,mightContain:w=>{var m;return(m=C?.mightContain(w))!==null&&m!==void 0&&m}}),Ce}(a,e.me,this.Le.tt(),u,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=qt(r).toUint8Array()}catch(h){if(h instanceof Ps)return Jn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Kc(a,i,o)}catch(h){return Jn(h instanceof an?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,a)=>{let u=this.Je(a);if(u){if(o.current&&Fc(u.target)){let h=new F(u.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,Ge.newNoDocument(h,e))}o.be&&(t.set(a,o.ve()),o.Ce())}});let r=W();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let d=this.Je(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));let i=new xs(e,t,this.Qe,this.ke,r);return this.ke=gt(),this.qe=$f(),this.Qe=new ae(X),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ms,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Se(X),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ms),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function $f(){return new ae(F.comparator)}function zf(){return new ae(F.comparator)}var GI={asc:"ASCENDING",desc:"DESCENDING"},WI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KI={and:"AND",or:"OR"},Qc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Jc(n,e){return n.useProto3Json||ro(e)?e:{value:e}}function Ls(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Dp(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function HI(n,e){return Ls(n,e.toTimestamp())}function tt(n){return te(!!n),$.fromTimestamp(function(t){let r=mt(t);return new ve(r.seconds,r.nanos)}(n))}function ol(n,e){return Yc(n,e).canonicalString()}function Yc(n,e){let t=function(i){return new se(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function kp(n){let e=se.fromString(n);return te(Mp(e)),e}function Xc(n,e){return ol(n.databaseId,e.path)}function fc(n,e){let t=kp(e);if(t.get(1)!==n.databaseId.projectId)throw new O(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new O(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(xp(t))}function Np(n,e){return ol(n.databaseId,e)}function QI(n){let e=kp(n);return e.length===4?se.emptyPath():xp(e)}function Zc(n){return new se(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function xp(n){return te(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Gf(n,e,t){return{name:Xc(n,e),fields:t.value.mapValue.fields}}function JI(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:B()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(te(p===void 0||typeof p=="string"),Re.fromBase64String(p||"")):(te(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Re.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?R.UNKNOWN:Pp(d.code);return new O(p,d.message||"")}(a);t=new Vs(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=fc(n,r.document.name),o=tt(r.document.updateTime),a=r.document.createTime?tt(r.document.createTime):$.min(),u=new ze({mapValue:{fields:r.document.fields}}),h=Ge.newFoundDocument(i,o,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Hn(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=fc(n,r.document),o=r.readTime?tt(r.readTime):$.min(),a=Ge.newNoDocument(i,o),u=r.removedTargetIds||[];t=new Hn([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=fc(n,r.document),o=r.removedTargetIds||[];t=new Hn([],o,i,null)}else{if(!("filter"in e))return B();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new Wc(i,o),u=r.targetId;t=new Os(u,a)}}return t}function YI(n,e){let t;if(e instanceof gn)t={update:Gf(n,e.key,e.value)};else if(e instanceof Ns)t={delete:Xc(n,e.key)};else if(e instanceof _t)t={update:Gf(n,e.key,e.data),updateMask:ow(e.fieldMask)};else{if(!(e instanceof jc))return B();t={verify:Xc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let u=a.transform;if(u instanceof nr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof pn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof mn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof rr)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw B()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:HI(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:B()}(n,e.precondition)),t}function XI(n,e){return n&&n.length>0?(te(e!==void 0),n.map(t=>function(i,o){let a=i.updateTime?tt(i.updateTime):tt(o);return a.isEqual($.min())&&(a=tt(o)),new qc(a,i.transformResults||[])}(t,e))):[]}function ZI(n,e){return{documents:[Np(n,e.path)]}}function ew(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Np(n,i);let o=function(d){if(d.length!==0)return Vp(We.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(p=>function(S){return{field:Gn(S.field),direction:rw(S.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Jc(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function tw(n){let e=QI(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){te(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(I){let S=Op(I);return S instanceof We&&dp(S)?S.getFilters():[S]}(t.where));let a=[];t.orderBy&&(a=function(I){return I.map(S=>function(N){return new fn(Wn(N.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(S))}(t.orderBy));let u=null;t.limit&&(u=function(I){let S;return S=typeof I=="object"?I.value:I,ro(S)?null:S}(t.limit));let h=null;t.startAt&&(h=function(I){let S=!!I.before,C=I.values||[];return new er(C,S)}(t.startAt));let d=null;return t.endAt&&(d=function(I){let S=!I.before,C=I.values||[];return new er(C,S)}(t.endAt)),RI(e,i,a,o,u,"F",h,d)}function nw(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Op(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Wn(t.unaryFilter.field);return le.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Wn(t.unaryFilter.field);return le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Wn(t.unaryFilter.field);return le.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Wn(t.unaryFilter.field);return le.create(a,"!=",{nullValue:"NULL_VALUE"});default:return B()}}(n):n.fieldFilter!==void 0?function(t){return le.create(Wn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return B()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return We.create(t.compositeFilter.filters.map(r=>Op(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B()}}(t.compositeFilter.op))}(n):B()}function rw(n){return GI[n]}function iw(n){return WI[n]}function sw(n){return KI[n]}function Gn(n){return{fieldPath:n.canonicalString()}}function Wn(n){return Ve.fromServerFormat(n.fieldPath)}function Vp(n){return n instanceof le?function(t){if(t.op==="=="){if(kf(t.value))return{unaryFilter:{field:Gn(t.field),op:"IS_NAN"}};if(Df(t.value))return{unaryFilter:{field:Gn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(kf(t.value))return{unaryFilter:{field:Gn(t.field),op:"IS_NOT_NAN"}};if(Df(t.value))return{unaryFilter:{field:Gn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gn(t.field),op:iw(t.op),value:t.value}}}(n):n instanceof We?function(t){let r=t.getFilters().map(i=>Vp(i));return r.length===1?r[0]:{compositeFilter:{op:sw(t.op),filters:r}}}(n):B()}function ow(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Mp(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ai=class n{constructor(e,t,r,i,o=$.min(),a=$.min(),u=Re.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var eu=class{constructor(e){this.ct=e}};function aw(n){let e=tw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Bc(e,e.limit,"L"):e}var Fs=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ie(e.integerValue));else if("doubleValue"in e){let r=ie(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),ri(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=mt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(qt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?up(e)?this.dt(t,Number.MAX_SAFE_INTEGER):cp(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):B()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(ie(u)),this.Vt(a,t),this.Tt(o[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),F.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Fs.vt=new Fs;var tu=class{constructor(){this.un=new nu}addToCollectionParentIndex(e,t){return this.un.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(hn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(hn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},nu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Se(se.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Se(se.comparator)).toArray()}};var I0=new Uint8Array(0);var Ye=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Ye.DEFAULT_COLLECTION_PERCENTILE=10,Ye.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ye.DEFAULT=new Ye(41943040,Ye.DEFAULT_COLLECTION_PERCENTILE,Ye.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ye.DISABLED=new Ye(-1,0,0);var ci=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var ru=class{constructor(){this.changes=new $t(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ge.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var iu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var su=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ti(r.mutation,i,Xe.empty(),ve.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,W()).next(()=>r))}getLocalViewOfDocuments(e,t,r=W()){let i=on();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=Yr();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=on();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,W()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=gt(),a=ei(),u=function(){return ei()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof _t)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),ti(p.mutation,d,p.mutation.getFieldMask(),ve.now())):a.set(d.key,Xe.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var I;return u.set(d,new iu(p,(I=a.get(d))!==null&&I!==void 0?I:null))}),u))}recalculateAndSaveOverlays(e,t){let r=ei(),i=new ae((a,u)=>a-u),o=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||Xe.empty();p=u.applyToLocalView(d,p),r.set(h,p);let I=(i.get(u.batchId)||W()).add(h);i=i.insert(u.batchId,I)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,I=wp();p.forEach(S=>{if(!o.has(S)){let C=Rp(t.get(S),r.get(S));C!==null&&I.set(S,C),o=o.add(S)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,I))}return P.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):gp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):P.resolve(on()),u=-1,h=o;return a.next(d=>P.forEach(d,(p,I)=>(u<I.largestBatchId&&(u=I.largestBatchId),o.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(S=>{h=h.insert(p,S)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,W())).next(p=>({batchId:u,changes:Ip(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=Yr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=Yr();return this.indexManager.getCollectionParents(e,o).next(u=>P.forEach(u,h=>{let d=function(I,S){return new jt(S,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((I,S)=>{a=a.insert(I,S)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,Ge.newInvalidDocument(p)))});let u=Yr();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&ti(p.mutation,d,Xe.empty(),ve.now()),so(t,d)&&(u=u.insert(h,d))}),u})}};var ou=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return P.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:tt(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:aw(i.bundledQuery),readTime:tt(i.readTime)}}(t)),P.resolve()}};var au=class{constructor(){this.overlays=new ae(F.comparator),this.Ir=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=on();return P.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=on(),o=t.length+1,a=new F(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ae((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=on(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=on(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return P.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Gc(t,r));let o=this.Ir.get(t);o===void 0&&(o=W(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var cu=class{constructor(){this.sessionToken=Re.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var ui=class{constructor(){this.Tr=new Se(ue.Er),this.dr=new Se(ue.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new ue(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new ue(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new F(new se([])),r=new ue(t,e),i=new ue(t,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new F(new se([])),r=new ue(t,e),i=new ue(t,e+1),o=W();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new ue(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ue=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return F.comparator(e.key,t.key)||X(e.wr,t.wr)}static Ar(e,t){return X(e.wr,t.wr)||F.comparator(e.key,t.key)}};var uu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Se(ue.Er)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new $c(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new ue(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return P.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ue(t,0),i=new ue(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);o.push(u)}),P.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Se(X);return t.forEach(i=>{let o=new ue(i,0),a=new ue(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),P.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;F.isDocumentKey(o)||(o=o.child(""));let a=new ue(new F(o),0),u=new Se(X);return this.br.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.wr)),!0)},a),P.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){te(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return P.forEach(t.mutations,i=>{let o=new ue(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new ue(t,0),i=this.br.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var lu=class{constructor(e){this.Mr=e,this.docs=function(){return new ae(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Ge.newInvalidDocument(t))}getEntries(e,t){let r=gt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ge.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=gt(),a=t.path,u=new F(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||gI(mI(p),r)<=0||(i.has(p.key)||so(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return P.resolve(o)}getAllFromCollectionGroup(e,t,r,i){B()}Or(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new hu(this)}getSize(e){return P.resolve(this.size)}},hu=class extends ru{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var du=class{constructor(e){this.persistence=e,this.Nr=new $t(t=>nl(t),rl),this.lastRemoteSnapshotVersion=$.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ui,this.targetCount=0,this.kr=ci.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),P.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new ci(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.Kn(t),P.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),P.waitFor(o).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),P.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Br.containsKey(t))}};var fu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new op(0),this.Kr=!1,this.Kr=!0,this.$r=new cu,this.referenceDelegate=e(this),this.Ur=new du(this),this.indexManager=new tu,this.remoteDocumentCache=function(i){return new lu(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new eu(t),this.Gr=new ou(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new au,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new uu(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);let i=new pu(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return P.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},pu=class extends bc{constructor(e){super(),this.currentSequenceNumber=e}},mu=class n{constructor(e){this.persistence=e,this.Jr=new ui,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw B()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),P.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Xr,r=>{let i=F.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,$.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return P.or([()=>P.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var gu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=W(),i=W();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var _u=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var yu=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return rd()?8:yI(pe())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new _u;return this.Xi(e,t,a).next(u=>{if(o.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Jr()<=G.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",zn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),P.resolve()):(Jr()<=G.DEBUG&&M("QueryEngine","Query:",zn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Jr()<=G.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",zn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,et(t))):P.resolve())}Yi(e,t){if(Vf(t))return P.resolve(null);let r=et(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Bc(t,null,"F"),r=et(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=W(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ts(t,u);return this.ns(t,d,a,h.readTime)?this.Yi(e,Bc(t,null,"F")):this.rs(e,d,t,h)}))})))}Zi(e,t,r,i){return Vf(t)||i.isEqual($.min())?P.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let a=this.ts(t,o);return this.ns(t,a,r,i)?P.resolve(null):(Jr()<=G.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),zn(t)),this.rs(e,a,t,pI(i,-1)).next(u=>u))})}ts(e,t){let r=new Se(yp(e));return t.forEach((i,o)=>{so(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return Jr()<=G.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",zn(t)),this.Ji.getDocumentsMatchingQuery(e,t,hn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var vu=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ae(X),this._s=new $t(o=>nl(o),rl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new su(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function cw(n,e,t,r){return new vu(n,e,t,r)}function Lp(n,e){return y(this,null,function*(){let t=j(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=W();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function uw(n,e){let t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let I=d.batch,S=I.keys(),C=P.resolve();return S.forEach(N=>{C=C.next(()=>p.getEntry(h,N)).next(L=>{let k=d.docVersions.get(N);te(k!==null),L.version.compareTo(k)<0&&(I.applyToRemoteDocument(L,d),L.isValidDocument()&&(L.setReadTime(d.commitVersion),p.addEntry(L)))})}),C.next(()=>u.mutationQueue.removeMutationBatch(h,I))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=W();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Fp(n){let e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function lw(n,e){let t=j(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,I)=>{let S=i.get(I);if(!S)return;u.push(t.Ur.removeMatchingKeys(o,p.removedDocuments,I).next(()=>t.Ur.addMatchingKeys(o,p.addedDocuments,I)));let C=S.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(I)!==null?C=C.withResumeToken(Re.EMPTY_BYTE_STRING,$.min()).withLastLimboFreeSnapshotVersion($.min()):p.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(p.resumeToken,r)),i=i.insert(I,C),function(L,k,z){return L.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=3e8?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(S,C,p)&&u.push(t.Ur.updateTargetData(o,C))});let h=gt(),d=W();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(hw(o,a,e.documentUpdates).next(p=>{h=p.Ps,d=p.Is})),!r.isEqual($.min())){let p=t.Ur.getLastRemoteSnapshotVersion(o).next(I=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(p)}return P.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.os=i,o))}function hw(n,e,t){let r=W(),i=W();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=gt();return t.forEach((u,h)=>{let d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual($.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):M("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function dw(n,e){let t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function fw(n,e){let t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,P.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new ai(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Iu(n,e,t){return y(this,null,function*(){let r=j(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!gi(a))throw a;M("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Wf(n,e,t){let r=j(n),i=$.min(),o=W();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let I=j(h),S=I._s.get(p);return S!==void 0?P.resolve(I.os.get(S)):I.Ur.getTargetData(d,p)}(r,a,et(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:$.min(),t?o:W())).next(u=>(pw(r,PI(e),u),{documents:u,Ts:o})))}function pw(n,e,t){let r=n.us.get(e)||$.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}var Us=class{constructor(){this.activeTargetIds=VI()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var wu=class{constructor(){this.so=new Us,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Us,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Eu=class{_o(e){}shutdown(){}};var Bs=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Es=null;function pc(){return Es===null?Es=function(){return 268435456+Math.round(2147483648*Math.random())}():Es++,"0x"+Es.toString(16)}var mw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Tu=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var be="WebChannelConnection",Au=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,a){let u=pc(),h=this.xo(t,r.toUriEncodedString());M("RestConnection",`Sending RPC '${t}' ${u}:`,h,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,o,a),this.No(t,h,d,i).then(p=>(M("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw Jn("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",h,"request:",i),p})}Lo(t,r,i,o,a,u){return this.Mo(t,r,i,o,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+cr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>t[a]=o),i&&i.headers.forEach((o,a)=>t[a]=o)}xo(t,r){let i=mw[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=pc();return new Promise((a,u)=>{let h=new ac;h.setWithCredentials(!0),h.listenOnce(uc.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Qr.NO_ERROR:let p=h.getResponseJson();M(be,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case Qr.TIMEOUT:M(be,`RPC '${e}' ${o} timed out`),u(new O(R.DEADLINE_EXCEEDED,"Request time out"));break;case Qr.HTTP_ERROR:let I=h.getStatus();if(M(be,`RPC '${e}' ${o} failed with status:`,I,"response text:",h.getResponseText()),I>0){let S=h.getResponseJson();Array.isArray(S)&&(S=S[0]);let C=S?.error;if(C&&C.status&&C.message){let N=function(k){let z=k.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(z)>=0?z:R.UNKNOWN}(C.status);u(new O(N,C.message))}else u(new O(R.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new O(R.UNAVAILABLE,"Connection failed."));break;default:B()}}finally{M(be,`RPC '${e}' ${o} completed.`)}});let d=JSON.stringify(i);M(be,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=pc(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=dc(),u=hc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.xmlHttpFactory=new cc({})),this.Oo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");M(be,`Creating RPC '${e}' stream ${i}: ${p}`,h);let I=a.createWebChannel(p,h),S=!1,C=!1,N=new Tu({Io:k=>{C?M(be,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(S||(M(be,`Opening RPC '${e}' stream ${i} transport.`),I.open(),S=!0),M(be,`RPC '${e}' stream ${i} sending:`,k),I.send(k))},To:()=>I.close()}),L=(k,z,K)=>{k.listen(z,H=>{try{K(H)}catch(ne){setTimeout(()=>{throw ne},0)}})};return L(I,$n.EventType.OPEN,()=>{C||(M(be,`RPC '${e}' stream ${i} transport opened.`),N.yo())}),L(I,$n.EventType.CLOSE,()=>{C||(C=!0,M(be,`RPC '${e}' stream ${i} transport closed`),N.So())}),L(I,$n.EventType.ERROR,k=>{C||(C=!0,Jn(be,`RPC '${e}' stream ${i} transport errored:`,k),N.So(new O(R.UNAVAILABLE,"The operation could not be completed")))}),L(I,$n.EventType.MESSAGE,k=>{var z;if(!C){let K=k.data[0];te(!!K);let H=K,ne=H.error||((z=H[0])===null||z===void 0?void 0:z.error);if(ne){M(be,`RPC '${e}' stream ${i} received error:`,ne);let Ce=ne.status,Z=function(_){let v=ce[_];if(v!==void 0)return Pp(v)}(Ce),w=ne.message;Z===void 0&&(Z=R.INTERNAL,w="Unknown error status: "+Ce+" with message "+ne.message),C=!0,N.So(new O(Z,w)),I.close()}else M(be,`RPC '${e}' stream ${i} received:`,K),N.bo(K)}}),L(u,lc.STAT_EVENT,k=>{k.stat===Is.PROXY?M(be,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===Is.NOPROXY&&M(be,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}};function mc(){return typeof document<"u"?document:null}function oo(n){return new Qc(n,!0)}var qs=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&M("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var js=class{constructor(e,t,r,i,o,a,u,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new qs(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(pt(t.toString()),pt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new O(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return M("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},bu=class extends js{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=JI(this.serializer,e),r=function(o){if(!("targetChange"in o))return $.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?$.min():a.readTime?tt(a.readTime):$.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Zc(this.serializer),t.addTarget=function(o,a){let u,h=a.target;if(u=Fc(h)?{documents:ZI(o,h)}:{query:ew(o,h)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Dp(o,a.resumeToken);let d=Jc(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo($.min())>0){u.readTime=Ls(o,a.snapshotVersion.toTimestamp());let d=Jc(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=nw(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Zc(this.serializer),t.removeTarget=e,this.a_(t)}},Su=class extends js{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return te(!!e.streamToken),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=XI(e.writeResults,e.commitTime),r=tt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Zc(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>YI(this.serializer,r))};this.a_(t)}};var Ru=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new O(R.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Yc(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new O(R.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,Yc(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new O(R.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Cu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(pt(t),this.D_=!1):M("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Pu=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(()=>y(this,null,function*(){yn(this)&&(M("RemoteStore","Restarting streams for network reachability change."),yield function(h){return y(this,null,function*(){let d=j(h);d.L_.add(4),yield _i(d),d.q_.set("Unknown"),d.L_.delete(4),yield ao(d)})}(this))}))}),this.q_=new Cu(r,i)}};function ao(n){return y(this,null,function*(){if(yn(n))for(let e of n.B_)yield e(!0)})}function _i(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Up(n,e){let t=j(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),ll(t)?ul(t):lr(t).r_()&&cl(t,e))}function al(n,e){let t=j(n),r=lr(t);t.N_.delete(e),r.r_()&&Bp(t,e),t.N_.size===0&&(r.r_()?r.o_():yn(t)&&t.q_.set("Unknown"))}function cl(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}lr(n).A_(e)}function Bp(n,e){n.Q_.xe(e),lr(n).R_(e)}function ul(n){n.Q_=new Hc({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),lr(n).start(),n.q_.v_()}function ll(n){return yn(n)&&!lr(n).n_()&&n.N_.size>0}function yn(n){return j(n).L_.size===0}function qp(n){n.Q_=void 0}function gw(n){return y(this,null,function*(){n.q_.set("Online")})}function _w(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{cl(n,e)})})}function yw(n,e){return y(this,null,function*(){qp(n),ll(n)?(n.q_.M_(e),ul(n)):n.q_.set("Unknown")})}function vw(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof Vs&&e.state===2&&e.cause)try{yield function(i,o){return y(this,null,function*(){let a=o.cause;for(let u of o.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){M("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield $s(n,r)}else if(e instanceof Hn?n.Q_.Ke(e):e instanceof Os?n.Q_.He(e):n.Q_.We(e),!t.isEqual($.min()))try{let r=yield Fp(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let u=o.Q_.rt(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o.N_.get(d);p&&o.N_.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=o.N_.get(h);if(!p)return;o.N_.set(h,p.withResumeToken(Re.EMPTY_BYTE_STRING,p.snapshotVersion)),Bp(o,h);let I=new ai(p.target,h,d,p.sequenceNumber);cl(o,I)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){M("RemoteStore","Failed to raise snapshot:",r),yield $s(n,r)}})}function $s(n,e,t){return y(this,null,function*(){if(!gi(e))throw e;n.L_.add(1),yield _i(n),n.q_.set("Offline"),t||(t=()=>Fp(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){M("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield ao(n)}))})}function jp(n,e){return e().catch(t=>$s(n,t,e))}function co(n){return y(this,null,function*(){let e=j(n),t=zt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Iw(e);)try{let i=yield dw(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,ww(e,i)}catch(i){yield $s(e,i)}$p(e)&&zp(e)})}function Iw(n){return yn(n)&&n.O_.length<10}function ww(n,e){n.O_.push(e);let t=zt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function $p(n){return yn(n)&&!zt(n).n_()&&n.O_.length>0}function zp(n){zt(n).start()}function Ew(n){return y(this,null,function*(){zt(n).p_()})}function Tw(n){return y(this,null,function*(){let e=zt(n);for(let t of n.O_)e.m_(t.mutations)})}function Aw(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=zc.from(r,e,t);yield jp(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield co(n)})}function bw(n,e){return y(this,null,function*(){e&&zt(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(a){return jI(a)&&a!==R.ABORTED}(i.code)){let o=r.O_.shift();zt(r).s_(),yield jp(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield co(r)}})}(n,e)),$p(n)&&zp(n)})}function Kf(n,e){return y(this,null,function*(){let t=j(n);t.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");let r=yn(t);t.L_.add(3),yield _i(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield ao(t)})}function Sw(n,e){return y(this,null,function*(){let t=j(n);e?(t.L_.delete(2),yield ao(t)):e||(t.L_.add(2),yield _i(t),t.q_.set("Unknown"))})}function lr(n){return n.K_||(n.K_=function(t,r,i){let o=j(t);return o.w_(),new bu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:gw.bind(null,n),Ro:_w.bind(null,n),mo:yw.bind(null,n),d_:vw.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),ll(n)?ul(n):n.q_.set("Unknown")):(yield n.K_.stop(),qp(n))}))),n.K_}function zt(n){return n.U_||(n.U_=function(t,r,i){let o=j(t);return o.w_(),new Su(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Ew.bind(null,n),mo:bw.bind(null,n),f_:Tw.bind(null,n),g_:Aw.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield co(n)):(yield n.U_.stop(),n.O_.length>0&&(M("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var Du=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new ft,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new O(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function hl(n,e){if(pt("AsyncQueue",`${e}: ${n}`),gi(n))return new O(R.UNAVAILABLE,`${e}: ${n}`);throw n}var zs=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=Yr(),this.sortedSet=new ae(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Gs=class{constructor(){this.W_=new ae(F.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):B():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},sr=class n{constructor(e,t,r,i,o,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,zs.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&io(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var ku=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},Nu=class{constructor(){this.queries=Hf(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=j(t),o=i.queries;i.queries=Hf(),o.forEach((a,u)=>{for(let h of u.j_)h.onError(r)})})(this,new O(R.ABORTED,"Firestore shutting down"))}};function Hf(){return new $t(n=>_p(n),io)}function Rw(n,e){return y(this,null,function*(){let t=j(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new ku,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=hl(a,`Initialization of query '${zn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&dl(t)})}function Cw(n,e){return y(this,null,function*(){let t=j(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function Pw(n,e){let t=j(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&dl(t)}function Dw(n,e,t){let r=j(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function dl(n){n.Y_.forEach(e=>{e.next()})}var xu,Qf;(Qf=xu||(xu={})).ea="default",Qf.Cache="cache";var Ou=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new sr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=sr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==xu.Cache}};var Ws=class{constructor(e){this.key=e}},Ks=class{constructor(e){this.key=e}},Vu=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=W(),this.mutatedKeys=W(),this.Aa=yp(e),this.Ra=new zs(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Gs,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,I)=>{let S=i.get(p),C=so(this.query,I)?I:null,N=!!S&&this.mutatedKeys.has(S.key),L=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations),k=!1;S&&C?S.data.isEqual(C.data)?N!==L&&(r.track({type:3,doc:C}),k=!0):this.ga(S,C)||(r.track({type:2,doc:C}),k=!0,(h&&this.Aa(C,h)>0||d&&this.Aa(C,d)<0)&&(u=!0)):!S&&C?(r.track({type:0,doc:C}),k=!0):S&&!C&&(r.track({type:1,doc:S}),k=!0,(h||d)&&(u=!0)),k&&(C?(a=a.add(C),o=L?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,I)=>function(C,N){let L=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B()}};return L(C)-L(N)}(p.type,I.type)||this.Aa(p.doc,I.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,d=h!==this.Ea;return this.Ea=h,a.length!==0||d?{snapshot:new sr(this.query,e.Ra,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Gs,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=W(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Ks(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Ws(r))}),t}ba(e){this.Ta=e.Ts,this.da=W();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return sr.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Mu=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Lu=class{constructor(e){this.key=e,this.va=!1}},Fu=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new $t(u=>_p(u),io),this.Ma=new Map,this.xa=new Set,this.Oa=new ae(F.comparator),this.Na=new Map,this.La=new ui,this.Ba={},this.ka=new Map,this.qa=ci.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function kw(n,e,t=!0){return y(this,null,function*(){let r=Jp(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield Gp(r,e,t,!0),i})}function Nw(n,e){return y(this,null,function*(){let t=Jp(n);yield Gp(t,e,!0,!1)})}function Gp(n,e,t,r){return y(this,null,function*(){let i=yield fw(n.localStore,et(e)),o=i.targetId,a=t?n.sharedClientState.addLocalQueryTarget(o):"not-current",u;return r&&(u=yield xw(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Up(n.remoteStore,i),u})}function xw(n,e,t,r,i){return y(this,null,function*(){n.Ka=(I,S,C)=>function(L,k,z,K){return y(this,null,function*(){let H=k.view.ma(z);H.ns&&(H=yield Wf(L.localStore,k.query,!1).then(({documents:w})=>k.view.ma(w,H)));let ne=K&&K.targetChanges.get(k.targetId),Ce=K&&K.targetMismatches.get(k.targetId)!=null,Z=k.view.applyChanges(H,L.isPrimaryClient,ne,Ce);return Yf(L,k.targetId,Z.wa),Z.snapshot})}(n,I,S,C);let o=yield Wf(n.localStore,e,!0),a=new Vu(e,o.Ts),u=a.ma(o.documents),h=oi.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);Yf(n,t,d.wa);let p=new Mu(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function Ow(n,e,t){return y(this,null,function*(){let r=j(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!io(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Iu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&al(r.remoteStore,i.targetId),Uu(r,i.targetId)}).catch(mi))):(Uu(r,i.targetId),yield Iu(r.localStore,i.targetId,!0))})}function Vw(n,e){return y(this,null,function*(){let t=j(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),al(t.remoteStore,r.targetId))})}function Mw(n,e,t){return y(this,null,function*(){let r=$w(n);try{let i=yield function(a,u){let h=j(a),d=ve.now(),p=u.reduce((C,N)=>C.add(N.key),W()),I,S;return h.persistence.runTransaction("Locally write mutations","readwrite",C=>{let N=gt(),L=W();return h.cs.getEntries(C,p).next(k=>{N=k,N.forEach((z,K)=>{K.isValidDocument()||(L=L.add(z))})}).next(()=>h.localDocuments.getOverlayedDocuments(C,N)).next(k=>{I=k;let z=[];for(let K of u){let H=qI(K,I.get(K.key).overlayedDocument);H!=null&&z.push(new _t(K.key,H,lp(H.value.mapValue),un.exists(!0)))}return h.mutationQueue.addMutationBatch(C,d,z,u)}).next(k=>{S=k;let z=k.applyToLocalDocumentSet(I,L);return h.documentOverlayCache.saveOverlays(C,k.batchId,z)})}).then(()=>({batchId:S.batchId,changes:Ip(I)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let d=a.Ba[a.currentUser.toKey()];d||(d=new ae(X)),d=d.insert(u,h),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield yi(r,i.changes),yield co(r.remoteStore)}catch(i){let o=hl(i,"Failed to persist write");t.reject(o)}})}function Wp(n,e){return y(this,null,function*(){let t=j(n);try{let r=yield lw(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Na.get(o);a&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?te(a.va):i.removedDocuments.size>0&&(te(a.va),a.va=!1))}),yield yi(t,r,e)}catch(r){yield mi(r)}})}function Jf(n,e,t){let r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=j(a);h.onlineState=u;let d=!1;h.queries.forEach((p,I)=>{for(let S of I.j_)S.Z_(u)&&(d=!0)}),d&&dl(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Lw(n,e,t){return y(this,null,function*(){let r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let a=new ae(F.comparator);a=a.insert(o,Ge.newNoDocument(o,$.min()));let u=W().add(o),h=new xs($.min(),new Map,new ae(X),a,u);yield Wp(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),fl(r)}else yield Iu(r.localStore,e,!1).then(()=>Uu(r,e,t)).catch(mi)})}function Fw(n,e){return y(this,null,function*(){let t=j(n),r=e.batch.batchId;try{let i=yield uw(t.localStore,e);Hp(t,r,null),Kp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield yi(t,i)}catch(i){yield mi(i)}})}function Uw(n,e,t){return y(this,null,function*(){let r=j(n);try{let i=yield function(a,u){let h=j(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(I=>(te(I!==null),p=I.keys(),h.mutationQueue.removeMutationBatch(d,I))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);Hp(r,e,t),Kp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield yi(r,i)}catch(i){yield mi(i)}})}function Kp(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Hp(n,e,t){let r=j(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Uu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Qp(n,r)})}function Qp(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(al(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),fl(n))}function Yf(n,e,t){for(let r of t)r instanceof Ws?(n.La.addReference(r.key,e),Bw(n,r)):r instanceof Ks?(M("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Qp(n,r.key)):B()}function Bw(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(M("SyncEngine","New document in limbo: "+t),n.xa.add(r),fl(n))}function fl(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new F(se.fromString(e)),r=n.qa.next();n.Na.set(r,new Lu(t)),n.Oa=n.Oa.insert(t,r),Up(n.remoteStore,new ai(et(il(t.path)),r,"TargetPurposeLimboResolution",op.oe))}}function yi(n,e,t){return y(this,null,function*(){let r=j(n),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,h)=>{a.push(r.Ka(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let I=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,I?"current":"not-current")}if(d){i.push(d);let I=gu.Wi(h.targetId,d);o.push(I)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(h,d){return y(this,null,function*(){let p=j(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>P.forEach(d,S=>P.forEach(S.$i,C=>p.persistence.referenceDelegate.addReference(I,S.targetId,C)).next(()=>P.forEach(S.Ui,C=>p.persistence.referenceDelegate.removeReference(I,S.targetId,C)))))}catch(I){if(!gi(I))throw I;M("LocalStore","Failed to update sequence numbers: "+I)}for(let I of d){let S=I.targetId;if(!I.fromCache){let C=p.os.get(S),N=C.snapshotVersion,L=C.withLastLimboFreeSnapshotVersion(N);p.os=p.os.insert(S,L)}}})}(r.localStore,o))})}function qw(n,e){return y(this,null,function*(){let t=j(n);if(!t.currentUser.isEqual(e)){M("SyncEngine","User change. New user:",e.toKey());let r=yield Lp(t.localStore,e);t.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(h=>{h.reject(new O(R.CANCELLED,a))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield yi(t,r.hs)}})}function jw(n,e){let t=j(n),r=t.Na.get(e);if(r&&r.va)return W().add(r.key);{let i=W(),o=t.Ma.get(e);if(!o)return i;for(let a of o){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function Jp(n){let e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Wp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=jw.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Lw.bind(null,e),e.Ca.d_=Pw.bind(null,e.eventManager),e.Ca.$a=Dw.bind(null,e.eventManager),e}function $w(n){let e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Fw.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Uw.bind(null,e),e}var Hs=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=oo(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return cw(this.persistence,new yu,e.initialUser,this.serializer)}createPersistence(e){return new fu(mu.Zr,this.serializer)}createSharedClientState(e){return new wu}terminate(){return y(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Bu=class{initialize(e,t){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Jf(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=qw.bind(null,this.syncEngine),yield Sw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Nu}()}createDatastore(e){let t=oo(e.databaseInfo.databaseId),r=function(o){return new Au(o)}(e.databaseInfo);return function(o,a,u,h){return new Ru(o,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,a,u){return new Pu(r,i,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>Jf(this.syncEngine,t,0),function(){return Bs.D()?new Bs:new Eu}())}createSyncEngine(e,t){return function(i,o,a,u,h,d,p){let I=new Fu(i,o,a,u,h,d);return p&&(I.Qa=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return y(this,null,function*(){var e,t;yield function(i){return y(this,null,function*(){let o=j(i);M("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield _i(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};var qu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):pt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var ju=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=me.UNAUTHENTICATED,this.clientId=Ss.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,o=>y(this,null,function*(){M("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(M("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new O(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ft;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=hl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function gc(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield Lp(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Xf(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Gw(n);M("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Kf(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Kf(e.remoteStore,i)),n._onlineComponents=e})}function zw(n){return n.name==="FirebaseError"?n.code===R.FAILED_PRECONDITION||n.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function Gw(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{yield gc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!zw(t))throw t;Jn("Error using user provided cache. Falling back to memory cache: "+t),yield gc(n,new Hs)}}else M("FirestoreClient","Using default OfflineComponentProvider"),yield gc(n,new Hs);return n._offlineComponents})}function Yp(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),yield Xf(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),yield Xf(n,new Bu))),n._onlineComponents})}function Ww(n){return Yp(n).then(e=>e.syncEngine)}function Zf(n){return y(this,null,function*(){let e=yield Yp(n),t=e.eventManager;return t.onListen=kw.bind(null,e.syncEngine),t.onUnlisten=Ow.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Nw.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Vw.bind(null,e.syncEngine),t})}function Xp(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var ep=new Map;function Zp(n,e,t){if(!t)throw new O(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Kw(n,e,t,r){if(e===!0&&r===!0)throw new O(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function tp(n){if(!F.isDocumentKey(n))throw new O(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function np(n){if(F.isDocumentKey(n))throw new O(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function uo(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B()}function ni(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new O(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=uo(n);throw new O(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Qs=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new O(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new O(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Kw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Xp((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new O(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new O(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new O(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},or=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qs({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new O(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new O(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qs(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new _c;switch(r.type){case"firstParty":return new wc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new O(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=ep.get(t);r&&(M("ComponentProvider","Removing Datastore"),ep.delete(t),r.terminate())}(this),Promise.resolve()}};function em(n,e,t,r={}){var i;let o=(n=ni(n,or))._getSettings(),a=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==a&&Jn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=me.MOCK_USER;else{u=Xh(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new O(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new me(d)}n._authCredentials=new yc(new bs(u,h))}}var _n=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Me=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Bt=class n extends _n{constructor(e,t,r){super(e,t,il(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new F(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function tm(n,e,...t){if(n=ye(n),Zp("collection","path",e),n instanceof or){let r=se.fromString(e,...t);return np(r),new Bt(n,null,r)}{if(!(n instanceof Me||n instanceof Bt))throw new O(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(se.fromString(e,...t));return np(r),new Bt(n.firestore,null,r)}}function nm(n,e,...t){if(n=ye(n),arguments.length===1&&(e=Ss.newId()),Zp("doc","path",e),n instanceof or){let r=se.fromString(e,...t);return tp(r),new Me(n,null,new F(r))}{if(!(n instanceof Me||n instanceof Bt))throw new O(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(se.fromString(e,...t));return tp(r),new Me(n.firestore,n instanceof Bt?n.converter:null,new F(r))}}var $u=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new qs(this,"async_queue_retry"),this.Eu=()=>{let t=mc();t&&M("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=mc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=mc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new ft;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return y(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!gi(e))throw e;M("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw pt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=Du.createAndSchedule(this,e,t,r,o=>this.Vu(o));return this.lu.push(i),i}du(){this.hu&&B()}verifyOperationInProgress(){}mu(){return y(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function rp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var ar=class extends or{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new $u}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||sm(this),this._firestoreClient.terminate()}};function rm(n,e){let t=typeof n=="object"?n:Ln(),r=typeof n=="string"?n:e||"(default)",i=Fr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Yh("firestore");o&&em(i,...o)}return i}function im(n){return n._firestoreClient||sm(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function sm(n){var e,t,r;let i=n._freezeSettings(),o=function(u,h,d,p){return new Sc(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Xp(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new ju(n._authCredentials,n._appCheckCredentials,n._queue,o),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var li=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Re.fromBase64String(e))}catch(t){throw new O(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Re.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var hi=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new O(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Js=class{constructor(e){this._methodName=e}};var di=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new O(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new O(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}};var fi=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var Hw=/^__.*__$/,zu=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new _t(e,this.data,this.fieldMask,t,this.fieldTransforms):new gn(e,this.data,t,this.fieldTransforms)}};function om(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}var Gu=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.yu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return Ys(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(om(this.wu)&&Hw.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},Wu=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||oo(e)}Nu(e,t,r,i=!1){return new Gu({wu:e,methodName:t,Ou:r,path:Ve.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function am(n){let e=n._freezeSettings(),t=oo(n._databaseId);return new Wu(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Qw(n,e,t,r,i,o={}){let a=n.Nu(o.merge||o.mergeFields?2:0,e,t,i);lm("Data must be an object, but it was:",a,r);let u=cm(r,a),h,d;if(o.merge)h=new Xe(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let p=[];for(let I of o.mergeFields){let S=Yw(e,I,t);if(!a.contains(S))throw new O(R.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);Zw(p,S)||p.push(S)}h=new Xe(p),d=a.fieldTransforms.filter(I=>h.covers(I.field))}else h=null,d=a.fieldTransforms;return new zu(new ze(u),h,d)}function Jw(n,e,t,r=!1){return pl(t,n.Nu(r?4:3,e))}function pl(n,e){if(um(n=ye(n)))return lm("Unsupported field value:",e,n),cm(n,e);if(n instanceof Js)return function(r,i){if(!om(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let u of r){let h=pl(u,i.Fu(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return MI(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ve.fromDate(r);return{timestampValue:Ls(i.serializer,o)}}if(r instanceof ve){let o=new ve(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ls(i.serializer,o)}}if(r instanceof di)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof li)return{bytesValue:Dp(i.serializer,r._byteString)};if(r instanceof Me){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:ol(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof fi)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Mu("VectorValues must only contain numeric values.");return sl(u.serializer,h)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${uo(r)}`)}(n,e)}function cm(n,e){let t={};return ap(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ur(n,(r,i)=>{let o=pl(i,e.bu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function um(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ve||n instanceof di||n instanceof li||n instanceof Me||n instanceof Js||n instanceof fi)}function lm(n,e,t){if(!um(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=uo(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function Yw(n,e,t){if((e=ye(e))instanceof hi)return e._internalPath;if(typeof e=="string")return hm(n,e);throw Ys("Field path arguments must be of type string or ",n,!1,void 0,t)}var Xw=new RegExp("[~\\*/\\[\\]]");function hm(n,e,t){if(e.search(Xw)>=0)throw Ys(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new hi(...e.split("."))._internalPath}catch{throw Ys(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ys(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new O(R.INVALID_ARGUMENT,u+n+h)}function Zw(n,e){return n.some(t=>t.isEqual(e))}var Xs=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Ku(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(lo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ku=class extends Xs{data(){return super.data()}};function lo(n,e){return typeof e=="string"?hm(n,e):e instanceof hi?e._internalPath:e._delegate._internalPath}function eE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new O(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var pi=class{},Zs=class extends pi{};function dm(n,e,...t){let r=[];e instanceof pi&&r.push(e),r=r.concat(t),function(o){let a=o.filter(h=>h instanceof Hu).length,u=o.filter(h=>h instanceof eo).length;if(a>1||a>0&&u>0)throw new O(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var eo=class n extends Zs{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return mm(e._query,t),new _n(e.firestore,e.converter,Uc(e._query,t))}_parse(e){let t=am(e.firestore);return function(o,a,u,h,d,p,I){let S;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new O(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){sp(I,p);let C=[];for(let N of I)C.push(ip(h,o,N));S={arrayValue:{values:C}}}else S=ip(h,o,I)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||sp(I,p),S=Jw(u,a,I,p==="in"||p==="not-in");return le.create(d,p,S)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function fm(n,e,t){let r=e,i=lo("where",n);return eo._create(i,r,t)}var Hu=class n extends pi{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:We.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let a=i,u=o.getFlattenedFilters();for(let h of u)mm(a,h),a=Uc(a,h)}(e._query,t),new _n(e.firestore,e.converter,Uc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Qu=class n extends Zs{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,a){if(i.startAt!==null)throw new O(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new O(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fn(o,a)}(e._query,this._field,this._direction);return new _n(e.firestore,e.converter,function(i,o){let a=i.explicitOrderBy.concat([o]);return new jt(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function pm(n,e="asc"){let t=e,r=lo("orderBy",n);return Qu._create(r,t)}function ip(n,e,t){if(typeof(t=ye(t))=="string"){if(t==="")throw new O(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gp(e)&&t.indexOf("/")!==-1)throw new O(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(se.fromString(t));if(!F.isDocumentKey(r))throw new O(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Pf(n,new F(r))}if(t instanceof Me)return Pf(n,t._key);throw new O(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uo(t)}.`)}function sp(n,e){if(!Array.isArray(n)||n.length===0)throw new O(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function mm(n,e){let t=function(i,o){for(let a of i)for(let u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new O(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new O(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Ju=class{convertValue(e,t="none"){switch(dn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ie(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(qt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return ur(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ie(a.doubleValue));return new fi(o)}convertGeoPoint(e){return new di(ie(e.latitude),ie(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=el(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ii(e));default:return null}}convertTimestamp(e){let t=mt(e);return new ve(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=se.fromString(e);te(Mp(r));let i=new Ds(r.get(1),r.get(3)),o=new F(r.popFirst(5));return i.isEqual(t)||pt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function tE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var cn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},to=class extends Xs{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Qn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(lo("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Qn=class extends to{data(e={}){return super.data(e)}},Yu=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new cn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Qn(this._firestore,this._userDataWriter,r.key,r,new cn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new O(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new Qn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new cn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new Qn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new cn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:nE(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function nE(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B()}}var no=class extends Ju{constructor(e){super(),this.firestore=e}convertBytes(e){return new li(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}};function gm(n,e){let t=ni(n.firestore,ar),r=nm(n),i=tE(n.converter,e);return rE(t,[Qw(am(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,un.exists(!1))]).then(()=>r)}function ml(n,...e){var t,r,i;n=ye(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||rp(e[a])||(o=e[a],a++);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(rp(e[a])){let I=e[a];e[a]=(t=I.next)===null||t===void 0?void 0:t.bind(I),e[a+1]=(r=I.error)===null||r===void 0?void 0:r.bind(I),e[a+2]=(i=I.complete)===null||i===void 0?void 0:i.bind(I)}let h,d,p;if(n instanceof Me)d=ni(n.firestore,ar),p=il(n._key.path),h={next:I=>{e[a]&&e[a](iE(d,n,I))},error:e[a+1],complete:e[a+2]};else{let I=ni(n,_n);d=ni(I.firestore,ar),p=I._query;let S=new no(d);h={next:C=>{e[a]&&e[a](new Yu(d,S,I,C))},error:e[a+1],complete:e[a+2]},eE(n._query)}return function(S,C,N,L){let k=new qu(L),z=new Ou(C,k,N);return S.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Rw(yield Zf(S),z)})),()=>{k.za(),S.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Cw(yield Zf(S),z)}))}}(im(d),p,u,h)}function rE(n,e){return function(r,i){let o=new ft;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Mw(yield Ww(r),i,o)})),o.promise}(im(n),e)}function iE(n,e,t){let r=t.docs.get(e._key),i=new no(n);return new to(n,i,e._key,r,new cn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){cr=i})(xt),Nt(new Be("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new ar(new vc(r.getProvider("auth-internal")),new Tc(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new O(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ds(d.options.projectId,p)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),fe(bf,"4.7.1",e),fe(bf,"4.7.1","esm2017")})();var ho=function(){return ho=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ho.apply(this,arguments)};var aE={includeMetadataChanges:!1};function _m(n,e){return e===void 0&&(e=aE),new kr(function(t){var r=ml(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function ym(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:ho(ho({},r),(t={},t[e.idField]=n.id,t))}function vm(n){return _m(n,{includeMetadataChanges:!0}).pipe(Ho(function(e){return e.docs}))}function Im(n,e){return e===void 0&&(e={}),vm(n).pipe(Ho(function(t){return t.map(function(r){return ym(r,e)})}))}var vn=class{constructor(e){return e}},wm="firestore",gl=class{constructor(){return Ur(wm)}};var _l=new bn("angularfire2.firestore-instances");function cE(n,e){let t=Yi(wm,n,e);return t&&new vn(t)}function uE(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new vn(r)}}var lE={provide:gl,deps:[[new Le,_l]]},hE={provide:vn,useFactory:cE,deps:[[new Le,_l],ct]};function Em(n,...e){return fe("angularfire",Zt.full,"fst"),Sn([hE,lE,{provide:_l,useFactory:uE(n),multi:!0,deps:[bt,Rn,Bn,en,[new Le,Hr],[new Le,Un],...e]}])}var yl=ke(Im,!0);var vl=ke(gm,!0);var vi=ke(tm,!0);var Tm=ke(rm,!0);var Am=ke(pm,!0);var Il=ke(dm,!0);var bm=ke(fm,!0);var Gt=class n{constructor(e){this.firestore=e;this.GetChat()}loginsCollection=[];countLogins=0;sub;chatsSubject=new Fi([]);chats$=this.chatsSubject.asObservable();subChat;LoginReg(e){let t=vi(this.firestore,"logins");vl(t,{fecha:new Date,user:e})}GetDataReg(){let e=vi(this.firestore,"logins"),t=Il(e),r=yl(t);this.sub=r.subscribe(i=>{this.loginsCollection=i,this.countLogins=this.loginsCollection.length,console.log(i)})}escribirChat(e,t){let r=vi(this.firestore,"chat");vl(r,{fecha:new Date,user:e,mensaje:t})}GetChat(){let e=vi(this.firestore,"chat"),r=Il(e,bm("fecha",">=",new Date),Am("fecha","desc")),i=yl(r);this.subChat=i.subscribe(o=>{this.chatsSubject.next(o)})}static \u0275fac=function(t){return new(t||n)(Ui(vn))};static \u0275prov=An({token:n,factory:n.\u0275fac,providedIn:"root"})};function fE(n,e){if(n&1&&(Dh(0),x(1,"strong",8),q(2),V(),kh()),n&2){let t=Ae().$implicit;Q(2),xr(t.user)}}function pE(n,e){if(n&1&&(x(0,"div")(1,"div",6),je(2,fE,3,1,"ng-container",7),x(3,"small"),q(4),xh(5,"date"),V(),x(6,"p"),q(7),V()()()),n&2){let t=e.$implicit,r=Ae();Q(),he("ngClass",t.user===r.user?"mi-mensaje":"otro-mensaje"),Q(),he("ngIf",t.user!==r.user),Q(2),Cn("(",Oh(5,4,t.fecha.seconds*1e3,"hh:mm a, dd-MM-yy"),")"),Q(3),xr(t.mensaje)}}var fo=class n{constructor(e,t){this.chat=e;this.auth=t}chats=[];user=null;mensaje="";ngOnInit(){this.user=this.auth.currentUser?.email,this.chat.chats$.subscribe(e=>{this.chats=e})}enviarMensaje(){this.chat.escribirChat(this.user,this.mensaje),this.mensaje=""}static \u0275fac=function(t){return new(t||n)(_e(Gt),_e(Oe))};static \u0275cmp=Fe({type:n,selectors:[["app-chat"]],standalone:!0,features:[Ue],decls:7,vars:2,consts:[[1,"chat-container"],[1,"mensajes"],[4,"ngFor","ngForOf"],[1,"chat-input"],["placeholder","Escribe tu mensaje...",3,"ngModelChange","ngModel"],[3,"click"],[3,"ngClass"],[4,"ngIf"],[1,"text-success"]],template:function(t,r){t&1&&(x(0,"div",0)(1,"div",1),je(2,pE,8,7,"div",2),V(),x(3,"div",3)(4,"input",4),Ct("ngModelChange",function(o){return Rt(r.mensaje,o)||(r.mensaje=o),o}),V(),x(5,"button",5),Ke("click",function(){return r.enviarMensaje()}),q(6,"Enviar"),V()()()),t&2&&(Q(2),he("ngForOf",r.chats),Q(2),St("ngModel",r.mensaje))},dependencies:[Dn,Fh,Uh,Pn,Bh,On,kn,Nn,xn],styles:[".chat-container[_ngcontent-%COMP%]{height:calc(100vh - 80px);display:flex;flex-direction:column}.mensajes[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto;width:100%;padding:10px;border:1px solid #ccc;display:flex;flex-direction:column-reverse}.chat-input[_ngcontent-%COMP%]{width:100%;padding:10px;border-top:1px solid #ccc;display:flex;margin-top:auto}.chat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:5px}.chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;margin-left:5px}.mi-mensaje[_ngcontent-%COMP%]{background-color:#90ee90;text-align:right;margin-left:auto;max-width:80%}.otro-mensaje[_ngcontent-%COMP%]{background-color:#add8e6;text-align:left;margin-right:auto;max-width:80%}p[_ngcontent-%COMP%]{padding:10px;border-radius:5px}"]})};var po=class n{miDataSubject=new Fi("");miData$=this.miDataSubject.asObservable();setMiData(e){this.miDataSubject.next(e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=An({token:n,factory:n.\u0275fac,providedIn:"root"})};var gE=()=>["/home"];function _E(n,e){n&1&&(x(0,"div")(1,"div",14)(2,"div")(3,"button",15),q(4,"Login"),V()(),x(5,"div")(6,"button",15),q(7,"Resgistrarse"),V()()()()),n&2&&(Q(3),he("routerLink","./login"),Q(3),he("routerLink","./registro"))}function yE(n,e){if(n&1){let t=Bi();x(0,"div",14)(1,"p",16),q(2),V(),x(3,"button",17),Ke("click",function(){Tt(t);let i=Ae();return At(i.CloseSession())}),q(4,"Logout"),V(),x(5,"button",17),Ke("click",function(){Tt(t);let i=Ae();return At(i.abrirChat())}),q(6,"Chat"),V()()}if(n&2){let t=Ae();Q(2),Cn("Usuario: ",t.auth.currentUser==null?null:t.auth.currentUser.email,"")}}function vE(n,e){n&1&&(x(0,"div",18)(1,"div",19)(2,"span",20),q(3,"Cargando..."),V()()())}function IE(n,e){n&1&&(x(0,"div"),de(1,"router-outlet"),V())}function wE(n,e){n&1&&(x(0,"div")(1,"div",21)(2,"div",22)(3,"div",9)(4,"div",23)(5,"div",24),de(6,"img",25),x(7,"div",26)(8,"h5",27),q(9,"El Ahorcado"),V(),x(10,"p",28),q(11,"Some quick example text to build on the card title and make up the bulk of the card's content."),V(),x(12,"button",15),q(13,"Cargar"),V()()()(),x(14,"div",23)(15,"div",24),de(16,"img",29),x(17,"div",26)(18,"h5",27),q(19,"Mayor o Menor"),V(),x(20,"p",28),q(21,"Some quick example text to build on the card title and make up the bulk of the card's content."),V(),x(22,"button",15),q(23,"Cargar"),V()()()(),x(24,"div",23)(25,"div",24),de(26,"img",30),x(27,"div",26)(28,"h5",27),q(29,"Preguntados"),V(),x(30,"p",28),q(31,"Some quick example text to build on the card title and make up the bulk of the card's content."),V(),x(32,"button",15),q(33,"Cargar"),V()()()(),x(34,"div",23)(35,"div",24),de(36,"img",31),x(37,"div",26)(38,"h5",27),q(39,"Chat-Room"),V(),x(40,"p",28),q(41,"Some quick example text to build on the card title and make up the bulk of the card's content."),V(),x(42,"button",15),q(43,"Cargar"),V()()()(),x(44,"div",23)(45,"div",24),de(46,"img",32),x(47,"div",26)(48,"h5",27),q(49,"Quien soy"),V(),x(50,"p",28),q(51,"Some quick example text to build on the card title and make up the bulk of the card's content."),V(),x(52,"button",15),q(53,"Cargar"),V()()()()()()()()),n&2&&(Q(12),he("routerLink","./juegos/ahorcado"),Q(10),he("routerLink","./juegos/mayoromenor"),Q(10),he("routerLink","./juegos/preguntados"),Q(10),he("routerLink","./juegos/simon"),Q(10),he("routerLink","./juegos/quiensoy"))}function EE(n,e){n&1&&(x(0,"div",13),de(1,"app-chat"),V())}var mo=class n{constructor(e,t,r){this.dataService=e;this.auth=t;this.router=r;this.router.events.subscribe(i=>{i instanceof $h?this.cargando=!0:(i instanceof Qo||i instanceof zh||i instanceof Gh)&&(this.cargando=!1)})}isUserLoggedIn=!0;usuario="";login="login";logout="logout";isChildActive=!1;chat=!1;cargando=!1;ngOnInit(){this.dataService.miData$.subscribe(e=>{this.usuario=e}),this.router.events.subscribe(e=>{e instanceof Qo&&(this.isChildActive=e.url!=="/home")})}CloseSession(){_s(this.auth).then(()=>{this.router.navigate(["/home"]),this.chat=!1})}abrirChat(){this.chat=!this.chat}toggleChat(){this.chat=!this.chat}static \u0275fac=function(t){return new(t||n)(_e(po),_e(Oe),_e(Pt))};static \u0275cmp=Fe({type:n,selectors:[["app-home"]],standalone:!0,features:[Ue],decls:19,vars:8,consts:[["elseBlock",""],[1,"navbar"],[1,"container"],[1,"d-flex"],["href","#",1,"navbar-brand"],["src","../../../assets/img/logo.png","alt","sala de juegos","width","30","height","24",1,"mt-2"],[1,"texto-blanco","silkscreen-regular",2,"cursor","pointer",3,"routerLink"],[4,"ngIf","ngIfElse"],[1,"container-fluid","overflow-hidden"],[1,"row"],[1,"col","mt-3"],["class","d-flex justify-content-center align-items-center","style","position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: rgba(255, 255, 255, 0.8); z-index: 1000;",4,"ngIf"],[4,"ngIf"],[1,"contenedor-chat","col-3"],[1,"div-botones","d-flex"],["type","button",1,"btn","btn-primary","texto-blanco","silkscreen-regular",3,"routerLink"],[1,"mt-2","text-center","texto-blanco"],[1,"boton","btn","texto-blanco","mx-2","mt-3",3,"click"],[1,"d-flex","justify-content-center","align-items-center",2,"position","fixed","top","0","left","0","width","100%","height","100vh","background","rgba(255, 255, 255, 0.8)","z-index","1000"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"container-fluid"],[1,"contenedor"],[1,"col","div-card"],[1,"card","contenedor-fijo"],["src","../../../assets/img/elahorcado.png","alt","...",1,"card-img-top"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["src","../../../assets/img/mayoromenor.jpg","alt","...",1,"card-img-top"],["src","../../../assets/img/preguntados.png","alt","...",1,"card-img-top"],["src","../../../assets/img/chatroom.jpg","alt","...",1,"card-img-top"],["src","../../../assets/img/usericon.jpg","alt","...",1,"card-img-top"]],template:function(t,r){if(t&1&&(x(0,"div")(1,"nav",1)(2,"div",2)(3,"div",3)(4,"a",4),de(5,"img",5),V(),x(6,"h1",6),q(7,"Sala de Juegos"),V()(),x(8,"div"),je(9,_E,8,2,"div",7)(10,yE,7,1,"ng-template",null,0,ji),V()()()(),x(12,"div",8)(13,"div",9)(14,"div",10),je(15,vE,4,0,"div",11)(16,IE,2,0,"div",12)(17,wE,54,5,"div",12),V(),je(18,EE,2,0,"div",13),V()()),t&2){let i=qi(11);Q(6),he("routerLink",Nh(7,gE)),Q(3),he("ngIf",!(r.auth.currentUser!=null&&r.auth.currentUser.email))("ngIfElse",i),Q(6),he("ngIf",r.cargando),Q(),he("ngIf",r.isChildActive&&!r.cargando),Q(),he("ngIf",!r.isChildActive),Q(),Nr(r.chat?18:-1)}},dependencies:[Dn,Pn,$i,Wh,fo],styles:["div[_ngcontent-%COMP%]{--fondo: #3F3F43;--colorBoton: rgb(112, 230, 112);--colorBotonHover:green}nav[_ngcontent-%COMP%]{background-color:var(--fondo);height:80px}.div-botones[_ngcontent-%COMP%]{width:250px;justify-content:space-between}.btn[_ngcontent-%COMP%]{background:var(--colorBoton);border:none;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus{background:var(--colorBotonHover)}.texto-blanco[_ngcontent-%COMP%]{color:#fff}.silkscreen-regular[_ngcontent-%COMP%]{font-family:Silkscreen,sans-serif;font-weight:400;font-style:normal}.boton[_ngcontent-%COMP%]{width:70px;height:40px}.div-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.card[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}.card-body[_ngcontent-%COMP%]{padding-bottom:50px}.contenedor-fijo[_ngcontent-%COMP%]{width:220px;height:450px;overflow:hidden;border:1px solid #ddd;position:relative}.contenedor-fijo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:60%}.contenedor-chat[_ngcontent-%COMP%]{width:300px;height:auto;background-color:var(--fondo);color:#fff}"]})};function TE(n,e){n&1&&(x(0,"div",9)(1,"div",10)(2,"span",11),q(3,"Cargando..."),V()()())}function AE(n,e){if(n&1){let t=Bi();x(0,"div",12)(1,"div",13)(2,"div",14)(3,"div")(4,"div",15)(5,"h2",16),q(6,"Ingresar usuario"),V(),de(7,"img",17),V(),x(8,"div",18)(9,"div")(10,"input",19),Ct("ngModelChange",function(i){Tt(t);let o=Ae();return Rt(o.userMail,i)||(o.userMail=i),At(i)}),V()(),x(11,"div")(12,"input",20),Ct("ngModelChange",function(i){Tt(t);let o=Ae();return Rt(o.userPWD,i)||(o.userPWD=i),At(i)}),V()(),x(13,"div")(14,"button",21),Ke("click",function(){Tt(t);let i=Ae();return At(i.Login())}),q(15,"Login"),V()(),x(16,"div")(17,"button",21),Ke("click",function(){Tt(t);let i=Ae();return At(i.AccesoRapido())}),q(18,"Acceso Rapido"),V()()()()()()()}if(n&2){let t=Ae();Q(10),St("ngModel",t.userMail),Q(2),St("ngModel",t.userPWD)}}var go=class n{constructor(e,t,r){this.router=e;this.auth=t;this.loginsReg=r;setTimeout(()=>{this.cargando=!1},2e3)}title="Login";userMail="";userPWD="";loggedUser="";cargando=!0;ngOnInit(){setTimeout(()=>{this.cargando=!1},3e3)}Login(){Ef(this.auth,this.userMail,this.userPWD).then(e=>{e.user.email!==null&&(this.loggedUser=e.user.email),this.loginsReg.LoginReg(this.loggedUser),this.loginsReg.GetDataReg(),this.router.navigate(["/home"])}).catch(e=>{switch(e.code){case"auth/invalid-credential":this.toastCredenciales();break;case"auth/email-already-in-use":break;case"auth/invalid-email":this.toastEmail();break;default:this.toastDefault();break}})}CloseSession(){_s(this.auth).then(()=>{this.router.navigate(["/home"])})}toastCredenciales(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="Email o contrase\xF1a incorrectos",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastEmail(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="El usuario debe ser de tipo e-mal",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastDefault(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="No fue posible logearse",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}AccesoRapido(){this.userMail="lolo@gmail.com",this.userPWD="123321"}static \u0275fac=function(t){return new(t||n)(_e(Pt),_e(Oe),_e(Gt))};static \u0275cmp=Fe({type:n,selectors:[["app-login"]],standalone:!0,features:[Ue],decls:12,vars:2,consts:[["elseBlock",""],[1,"contenedor","position-relative"],["class","spinner-overlay",4,"ngIf","ngIfElse"],["id","miTostada","role","alert","aria-live","assertive","aria-atomic","true",1,"toast",2,"position","absolute","top","20px","right","20px"],[1,"toast-header"],["src","../../../assets/img/admiracion.png","alt","...",1,"rounded","me-2"],[1,"me-auto"],["type","button","data-bs-dismiss","toast","aria-label","Close",1,"btn-close"],[1,"toast-body"],[1,"spinner-overlay"],["role","status",1,"spinner-border","text-succes"],[1,"visually-hidden"],[1,"d-flex","justify-content-center"],[1,"row","login","inner-content"],[1,"col"],[1,"container","d-flex","justify-content-between","mt-5","mb-4"],[1,"text-left","texto-blanco"],["src","assets/img/logo.png","alt","logo",1,"logo"],[1,"d-grid","gap-3"],["placeholder","Usuario - Email","type","email","required","",1,"form-control","my-2",3,"ngModelChange","ngModel"],["required","","placeholder","Contrase\xF1a","type","password",1,"form-control","my-2",3,"ngModelChange","ngModel"],[1,"btn","form-control","mb-5","texto-blanco",3,"click"]],template:function(t,r){if(t&1&&(x(0,"div",1),je(1,TE,4,0,"div",2)(2,AE,19,2,"ng-template",null,0,ji),V(),x(4,"div",3)(5,"div",4),de(6,"img",5),x(7,"strong",6),q(8,"Atencion!"),V(),de(9,"button",7),V(),x(10,"div",8),q(11," Hello, world! This is a toast message. "),V()()),t&2){let i=qi(3);Q(),he("ngIf",r.cargando)("ngIfElse",i)}},dependencies:[On,kn,Nn,zi,xn,Dn,Pn],styles:["div[_ngcontent-%COMP%]{--fondo: #3F3F43;--colorBoton: rgb(112, 230, 112);--colorBotonHover:green}.texto-blanco[_ngcontent-%COMP%]{color:#fff;font-family:Gothic A1,sans-serif;font-weight:800;font-style:normal}.logo[_ngcontent-%COMP%]{height:30px;width:40px;margin-top:7px}.login[_ngcontent-%COMP%]{background-color:var(--fondo);border-radius:10px;box-shadow:0 0 10px #0000001a;margin-top:3rem;margin-bottom:3rem}.btn[_ngcontent-%COMP%]{background:var(--colorBoton);border:none;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus{background:var(--colorBotonHover)}input[_ngcontent-%COMP%]:focus{border-color:green;outline:none}.gothic-a1-extrabold[_ngcontent-%COMP%]{font-family:Gothic A1,sans-serif;font-weight:800;font-style:normal}.inner-content[_ngcontent-%COMP%]{max-width:450px;width:100%}.spinner-overlay[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1000;display:flex;justify-content:center;align-items:center;width:100%;height:100%}.contenedor[_ngcontent-%COMP%]{position:relative;width:100%;height:calc(100vh - 150px);overflow-y:auto}"]})};function bE(n,e){if(n&1&&(x(0,"h2",11),q(1),V()),n&2){let t=Ae();Q(),Cn("Usuario registrado: ",t.loggedUser,"")}}function SE(n,e){if(n&1&&(x(0,"p",11),q(1),V()),n&2){let t=Ae();Q(),xr(t.msjError)}}var _o=class n{constructor(e,t,r){this.auth=e;this.router=t;this.loginsReg=r}newUserMail="";newUserPWD="";loggedUser="";flagError=!1;msjError="";small="";strong="";Register(){If(this.auth,this.newUserMail,this.newUserPWD).then(e=>{e.user.email!==null&&(this.loggedUser=e.user.email),this.flagError=!1,this.loginsReg.LoginReg(this.loggedUser),this.router.navigate(["/home"])}).catch(e=>{switch(this.flagError=!0,e.code){case"auth/invalid-email":this.toastEmailInvalido();break;case"auth/email-already-in-use":this.toastEmailYaEnUso();break;case"auth/weak-password":this.toastPassword();break;default:this.toastDefault();break}})}toastEmailYaEnUso(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="Email ya en uso",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastEmailInvalido(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="El usuario debe ser un Email",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastPassword(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="El password debe tener al menos 6 caracteres",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastDefault(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="No fue posible registrar la cuenta",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}showToast(){var e=document.getElementById("miTostada"),t=new bootstrap.Toast(e);t.show()}static \u0275fac=function(t){return new(t||n)(_e(Oe),_e(Pt),_e(Gt))};static \u0275cmp=Fe({type:n,selectors:[["app-registro"]],standalone:!0,features:[Ue],decls:27,vars:4,consts:[[1,"d-flex","justify-content-center"],[1,"row","login","inner-content"],[1,"col"],[1,"container","d-flex","justify-content-between","mt-5","mb-4"],[1,"text-center","texto-blanco"],["src","assets/img/logo.png","alt","logo",1,"logo"],[1,"d-grid","gap-3"],["placeholder","Usuario - Email",1,"form-control","my-2",3,"ngModelChange","ngModel"],["required","","placeholder","Contrase\xF1a","type","password",1,"form-control","my-2",3,"ngModelChange","ngModel"],[1,"d-grid","gap-2"],[1,"btn","form-control","mb-5","texto-blanco",3,"click"],[1,"text-center","text-primary"],["id","miTostada","role","alert","aria-live","assertive","aria-atomic","true",1,"toast",2,"position","absolute","top","20px","right","20px"],[1,"toast-header"],["src","../../../assets/img/admiracion.png","alt","...",1,"rounded","me-2"],[1,"me-auto"],["type","button","data-bs-dismiss","toast","aria-label","Close",1,"btn-close"],[1,"toast-body"]],template:function(t,r){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"h2",4),q(6,"Registrar usuario"),V(),de(7,"img",5),V(),x(8,"div",6)(9,"div")(10,"input",7),Ct("ngModelChange",function(o){return Rt(r.newUserMail,o)||(r.newUserMail=o),o}),V()(),x(11,"div")(12,"input",8),Ct("ngModelChange",function(o){return Rt(r.newUserPWD,o)||(r.newUserPWD=o),o}),V()(),x(13,"div")(14,"div",9)(15,"button",10),Ke("click",function(){return r.Register()}),q(16,"Registrarse"),V()(),je(17,bE,2,1,"h2",11)(18,SE,2,1,"p",11),V()()()()()(),x(19,"div",12)(20,"div",13),de(21,"img",14),x(22,"strong",15),q(23,"Atencion!"),V(),de(24,"button",16),V(),x(25,"div",17),q(26," Hello, world! This is a toast message. "),V()()),t&2&&(Q(10),St("ngModel",r.newUserMail),Q(2),St("ngModel",r.newUserPWD),Q(5),Nr(r.loggedUser!=""?17:-1),Q(),Nr(r.flagError?18:-1))},dependencies:[On,kn,Nn,zi,xn],styles:["div[_ngcontent-%COMP%]{--fondo: #3F3F43;--colorBoton: rgb(112, 230, 112);--colorBotonHover:green}.texto-blanco[_ngcontent-%COMP%]{color:#fff;font-family:Gothic A1,sans-serif;font-weight:800;font-style:normal}.logo[_ngcontent-%COMP%]{height:30px;width:40px;margin-top:7px}.login[_ngcontent-%COMP%]{background-color:var(--fondo);border-radius:10px;box-shadow:0 0 10px #0000001a;margin-top:3rem;margin-bottom:3rem}.btn[_ngcontent-%COMP%]{background:var(--colorBoton);border:none;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus{background:var(--colorBotonHover)}input[_ngcontent-%COMP%]:focus{border-color:green;outline:none}.inner-content[_ngcontent-%COMP%]{max-width:450px;width:100%}.img-toas[_ngcontent-%COMP%]{width:10px;height:10px}"]})};var yo=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Fe({type:n,selectors:[["app-page-not-found"]],standalone:!0,features:[Ue],decls:2,vars:0,template:function(t,r){t&1&&(x(0,"p"),q(1,"page-not-found works!"),V())}})};var Cm=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home/juegos",redirectTo:"/home",pathMatch:"full"},{path:"home",component:mo,children:[{path:"login",component:go},{path:"registro",component:_o},{path:"juegos",loadChildren:()=>import("./chunk-GC7GV6NB.js").then(n=>n.JuegosModule)}]},{path:"**",component:yo}];var Pm={projectId:"saladejuegos-f162c",appId:"1:427218264835:web:a5a676bfcd8bba0b83bf36",storageBucket:"saladejuegos-f162c.appspot.com",apiKey:"AIzaSyBUvgRVekAkiMeQF-S55lTfwjXw5JEkoeo",authDomain:"saladejuegos-f162c.firebaseapp.com",messagingSenderId:"427218264835"};var Dm={providers:[Lh({eventCoalescing:!0}),Kh(Cm),wd(()=>Ed(Pm)),vf(()=>wf()),Em(()=>Tm()),qh()]};var hr=class{nombre;clave;constructor(e,t){this.nombre=e,this.clave=t}};var vo=class n{constructor(e){this.router=e}title="Sala de Juegos";usuario1=new hr("juan","1234");usuario2=new hr("pedro","1234");usuario3=new hr("laura","1234");ngOnInit(){this.guardarUsuarios()}guardarUsuarios(){let e=[this.usuario1,this.usuario2,this.usuario3],t=JSON.stringify(e);localStorage.setItem("usuarios",t)}static \u0275fac=function(t){return new(t||n)(_e(Pt))};static \u0275cmp=Fe({type:n,selectors:[["app-root"]],standalone:!0,features:[Ue],decls:2,vars:0,template:function(t,r){t&1&&(x(0,"div"),de(1,"router-outlet"),V())},dependencies:[$i],styles:["[_nghost-%COMP%]{display:block;min-height:100vh;background-color:#bbb;margin:0;width:100%}[_ngcontent-%COMP%]:root{--colorFondo: rgb(187, 187, 187)}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100%}"]})};jh(vo,Dm).catch(n=>console.error(n));
