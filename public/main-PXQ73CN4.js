import{$ as rs,A as Vn,Aa as Cd,B as Ia,Ba as Mn,C as Rt,D as Pt,Da as Sd,E as wa,Ea as Rd,F as nn,Fa as Pd,G as es,Ga as Sa,H as Dt,Ha as Dd,I as Ea,Ia as kd,J as fd,Ja as cs,Ka as xt,L as X,La as Nd,M as Z,Ma as Vd,N as Ta,O as ts,P as xn,Q as Je,R as pd,S as _e,T as md,U as Br,V as x,W as O,X as de,Y as ns,Z as qe,_ as Ve,a as ke,aa as q,b as Le,ba as gd,c as Ct,ca as On,d as y,da as _d,e as Lr,ea as kt,f as cd,fa as Nt,g as Yi,ga as Vt,h as ud,ha as is,i as ld,ia as $e,j as pa,ja as yd,k as ma,l as ga,la as vd,m as _a,ma as Id,n as Ur,na as ss,o as hd,oa as ba,p as dd,pa as wd,q as Xi,qa as Ed,r as tn,ra as Td,s as ya,sa as bd,t as Ue,ta as Aa,u as Zi,ua as os,va as rn,w as Be,wa as Ca,x as je,y as va,ya as Ad,z as St,za as as}from"./chunk-U5OQ4OM6.js";var Od=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},g_=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Md={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=s>>2,I=(s&3)<<4|u>>4,C=(u&15)<<2|d>>6,R=d&63;h||(R=64,a||(C=64)),r.push(t[p],t[I],t[C],t[R])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Od(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):g_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let I=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||I==null)throw new Pa;let C=s<<2|u>>4;if(r.push(C),d!==64){let R=u<<4&240|d>>2;if(r.push(R),I!==64){let N=d<<6&192|I;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Pa=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},__=function(n){let e=Od(n);return Md.encodeByteArray(e,!0)},jr=function(n){return __(n).replace(/\./g,"")},ka=function(n){try{return Md.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function y_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var v_=()=>y_().__FIREBASE_DEFAULTS__,I_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},w_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&ka(n[1]);return e&&JSON.parse(e)},ls=()=>{try{return v_()||I_()||w_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Na=n=>{var e,t;return(t=(e=ls())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Fd=n=>{let e=Na(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Va=()=>{var n;return(n=ls())===null||n===void 0?void 0:n.config},xa=n=>{var e;return(e=ls())===null||e===void 0?void 0:e[`_${n}`]};var us=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Ld(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[jr(JSON.stringify(t)),jr(JSON.stringify(a)),""].join(".")}function pe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ud(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pe())}function E_(){var n;let e=(n=ls())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Bd(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function jd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function qd(){let n=pe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function $d(){return!E_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Oa(){try{return typeof indexedDB=="object"}catch{return!1}}function Gd(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var T_="FirebaseError",xe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=T_,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ut.prototype.create)}},ut=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?b_(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new xe(i,u,r)}};function b_(n,e){return n.replace(A_,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var A_=/\{\$([^}]+)}/g;function zd(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function sn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(xd(s)&&xd(a)){if(!sn(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function xd(n){return n!==null&&typeof n=="object"}function qr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Fn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ln(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Wd(n,e){let t=new Da(n,e);return t.subscribe.bind(t)}var Da=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");C_(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ra),i.error===void 0&&(i.error=Ra),i.complete===void 0&&(i.complete=Ra);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function C_(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ra(){}var u0=4*60*60*1e3;function ye(n){return n&&n._delegate?n._delegate:n}var Ge=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var on="[DEFAULT]";var Ma=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new us;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(R_(e))try{this.getOrInitializeService({instanceIdentifier:on})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=on){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=on){return this.instances.has(e)}getOptions(e=on){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:S_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=on){return this.component?this.component.multipleInstances?e:on:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function S_(n){return n===on?void 0:n}function R_(n){return n.instantiationMode==="EAGER"}var hs=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Ma(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var P_=[],z=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(z||{}),D_={debug:z.DEBUG,verbose:z.VERBOSE,info:z.INFO,warn:z.WARN,error:z.ERROR,silent:z.SILENT},k_=z.INFO,N_={[z.DEBUG]:"log",[z.VERBOSE]:"log",[z.INFO]:"info",[z.WARN]:"warn",[z.ERROR]:"error"},V_=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=N_[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ot=class{constructor(e){this.name=e,this._logLevel=k_,this._logHandler=V_,this._userLogHandler=null,P_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in z))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?D_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,z.DEBUG,...e),this._logHandler(this,z.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,z.VERBOSE,...e),this._logHandler(this,z.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,z.INFO,...e),this._logHandler(this,z.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,z.WARN,...e),this._logHandler(this,z.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,z.ERROR,...e),this._logHandler(this,z.ERROR,...e)}};var x_=(n,e)=>e.some(t=>n instanceof t),Hd,Kd;function O_(){return Hd||(Hd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function M_(){return Kd||(Kd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Qd=new WeakMap,La=new WeakMap,Jd=new WeakMap,Fa=new WeakMap,Ba=new WeakMap;function F_(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Ye(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Qd.set(t,n)}).catch(()=>{}),Ba.set(e,n),e}function L_(n){if(La.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});La.set(n,e)}var Ua={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return La.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Jd.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ye(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Yd(n){Ua=n(Ua)}function U_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ds(this),e,...t);return Jd.set(r,e.sort?e.sort():[e]),Ye(r)}:M_().includes(n)?function(...e){return n.apply(ds(this),e),Ye(Qd.get(this))}:function(...e){return Ye(n.apply(ds(this),e))}}function B_(n){return typeof n=="function"?U_(n):(n instanceof IDBTransaction&&L_(n),x_(n,O_())?new Proxy(n,Ua):n)}function Ye(n){if(n instanceof IDBRequest)return F_(n);if(Fa.has(n))return Fa.get(n);let e=B_(n);return e!==n&&(Fa.set(n,e),Ba.set(e,n)),e}var ds=n=>Ba.get(n);function Zd(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),u=Ye(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Ye(a.result),h.oldVersion,h.newVersion,Ye(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var j_=["get","getKey","getAll","getAllKeys","count"],q_=["put","add","delete","clear"],ja=new Map;function Xd(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ja.get(e))return ja.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=q_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||j_.includes(t)))return;let s=function(a,...u){return y(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return ja.set(e,s),s}Yd(n=>Le(ke({},n),{get:(e,t,r)=>Xd(e,t)||n.get(e,t,r),has:(e,t)=>!!Xd(e,t)||n.has(e,t)}));var $a=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if($_(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function $_(n){let e=n.getComponent();return e?.type==="VERSION"}var Ga="@firebase/app",ef="0.10.10";var lt=new Ot("@firebase/app"),G_="@firebase/app-compat",z_="@firebase/analytics-compat",W_="@firebase/analytics",H_="@firebase/app-check-compat",K_="@firebase/app-check",Q_="@firebase/auth",J_="@firebase/auth-compat",Y_="@firebase/database",X_="@firebase/database-compat",Z_="@firebase/functions",ey="@firebase/functions-compat",ty="@firebase/installations",ny="@firebase/installations-compat",ry="@firebase/messaging",iy="@firebase/messaging-compat",sy="@firebase/performance",oy="@firebase/performance-compat",ay="@firebase/remote-config",cy="@firebase/remote-config-compat",uy="@firebase/storage",ly="@firebase/storage-compat",hy="@firebase/firestore",dy="@firebase/vertexai-preview",fy="@firebase/firestore-compat",py="firebase",my="10.13.1";var za="[DEFAULT]",gy={[Ga]:"fire-core",[G_]:"fire-core-compat",[W_]:"fire-analytics",[z_]:"fire-analytics-compat",[K_]:"fire-app-check",[H_]:"fire-app-check-compat",[Q_]:"fire-auth",[J_]:"fire-auth-compat",[Y_]:"fire-rtdb",[X_]:"fire-rtdb-compat",[Z_]:"fire-fn",[ey]:"fire-fn-compat",[ty]:"fire-iid",[ny]:"fire-iid-compat",[ry]:"fire-fcm",[iy]:"fire-fcm-compat",[sy]:"fire-perf",[oy]:"fire-perf-compat",[ay]:"fire-rc",[cy]:"fire-rc-compat",[uy]:"fire-gcs",[ly]:"fire-gcs-compat",[hy]:"fire-fst",[fy]:"fire-fst-compat",[dy]:"fire-vertex","fire-js":"fire-js",[py]:"fire-js-all"};var $r=new Map,_y=new Map,Wa=new Map;function tf(n,e){try{n.container.addComponent(e)}catch(t){lt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ft(n){let e=n.name;if(Wa.has(e))return lt.debug(`There were multiple attempts to register component ${e}.`),!1;Wa.set(e,n);for(let t of $r.values())tf(t,n);for(let t of _y.values())tf(t,n);return!0}function zr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function We(n){return n.settings!==void 0}var yy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mt=new ut("app","Firebase",yy);var Ha=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ge("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mt.create("app-deleted",{appName:this._name})}};var Lt=my;function Ja(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:za,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Mt.create("bad-app-name",{appName:String(i)});if(t||(t=Va()),!t)throw Mt.create("no-options");let s=$r.get(i);if(s){if(sn(t,s.options)&&sn(r,s.config))return s;throw Mt.create("duplicate-app",{appName:i})}let a=new hs(i);for(let h of Wa.values())a.addComponent(h);let u=new Ha(t,r,a);return $r.set(i,u),u}function Un(n=za){let e=$r.get(n);if(!e&&n===za&&Va())return Ja();if(!e)throw Mt.create("no-app",{appName:n});return e}function fs(){return Array.from($r.values())}function fe(n,e,t){var r;let i=(r=gy[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),lt.warn(u.join(" "));return}Ft(new Ge(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var vy="firebase-heartbeat-database",Iy=1,Gr="firebase-heartbeat-store",qa=null;function of(){return qa||(qa=Zd(vy,Iy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Gr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Mt.create("idb-open",{originalErrorMessage:n.message})})),qa}function wy(n){return y(this,null,function*(){try{let t=(yield of()).transaction(Gr),r=yield t.objectStore(Gr).get(af(n));return yield t.done,r}catch(e){if(e instanceof xe)lt.warn(e.message);else{let t=Mt.create("idb-get",{originalErrorMessage:e?.message});lt.warn(t.message)}}})}function nf(n,e){return y(this,null,function*(){try{let r=(yield of()).transaction(Gr,"readwrite");yield r.objectStore(Gr).put(e,af(n)),yield r.done}catch(t){if(t instanceof xe)lt.warn(t.message);else{let r=Mt.create("idb-set",{originalErrorMessage:t?.message});lt.warn(r.message)}}})}function af(n){return`${n.name}!${n.options.appId}`}var Ey=1024,Ty=30*24*60*60*1e3,Ka=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Qa(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=rf();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=Ty}),this._storage.overwrite(this._heartbeatsCache))}catch(r){lt.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=rf(),{heartbeatsToSend:r,unsentEntries:i}=by(this._heartbeatsCache.heartbeats),s=jr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return lt.warn(t),""}})}};function rf(){return new Date().toISOString().substring(0,10)}function by(n,e=Ey){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),sf(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),sf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Qa=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return Oa()?Gd().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield wy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return nf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return nf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function sf(n){return jr(JSON.stringify({version:2,heartbeats:n})).length}function Ay(n){Ft(new Ge("platform-logger",e=>new $a(e),"PRIVATE")),Ft(new Ge("heartbeat",e=>new Ka(e),"PRIVATE")),fe(Ga,ef,n),fe(Ga,ef,"esm2017"),fe("fire-js","")}Ay("");var Cy="firebase",Sy="10.13.1";fe(Cy,Sy,"app");var cn=new ba("ANGULARFIRE2_VERSION");function ms(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Wr=(n,e)=>{let t=e?[e]:fs(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},jn=class{constructor(){return Wr(Ry)}},Ry="app-check";function Bn(){}var ps=class{zone;delegate;constructor(e,t=ld){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,r)}},Ya=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Bn,{},Bn,Bn)),t.pipe(dd({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},qn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new ps(Zone.current)),this.insideAngular=t.run(()=>new ps(Zone.current,ud)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Zi(Dt))};static \u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gs(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Py(n){return gs().ngZone.runOutsideAngular(()=>n())}function an(n){return gs().ngZone.run(()=>n())}function Dy(n){return ky(gs())(n)}function ky(n){return function(t){return t=t.lift(new Ya(n.ngZone)),t.pipe(ga(n.outsideAngular),ma(n.insideAngular))}}var Ny=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),an(()=>n.apply(void 0,r))},De=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=an(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Bn,{},Bn,Bn))),r[s]=Ny(r[s],t));let i=Py(()=>n.apply(this,r));if(!e)if(i instanceof Lr){let s=gs();return i.pipe(ga(s.outsideAngular),ma(s.insideAngular))}else return an(()=>i);return i instanceof Lr?i.pipe(Dy):i instanceof Promise?an(()=>new Promise((s,a)=>i.then(u=>an(()=>s(u)),u=>an(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:an(()=>i)};var dt=class{constructor(e){return e}},un=class{constructor(){return fs()}};function Vy(n){return n&&n.length===1?n[0]:new dt(Un())}var Xa=new Ue("angularfire2._apps"),xy={provide:dt,useFactory:Vy,deps:[[new Be,Xa]]},Oy={provide:un,deps:[[new Be,Xa]]};function My(n){return(e,t)=>{let r=t.get(fd);fe("angularfire",cn.full,"core"),fe("angularfire",cn.full,"app"),fe("angular",wd.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new dt(i)}}function cf(n,...e){return Vn([xy,Oy,{provide:Xa,useFactory:My(n),multi:!0,deps:[Dt,nn,qn,...e]}])}var uf=De(Ja,!0);function Cf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Sf=Cf,Rf=new ut("auth","Firebase",Cf());var Es=new Ot("@firebase/auth");function Fy(n,...e){Es.logLevel<=z.WARN&&Es.warn(`Auth (${Lt}): ${n}`,...e)}function ys(n,...e){Es.logLevel<=z.ERROR&&Es.error(`Auth (${Lt}): ${n}`,...e)}function Ze(n,...e){throw wc(n,...e)}function ln(n,...e){return wc(n,...e)}function Pf(n,e,t){let r=Object.assign(Object.assign({},Sf()),{[e]:t});return new ut("auth","Firebase",r).create(e,{appName:n.name})}function mt(n){return Pf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Rf.create(n,...e)}function U(n,e,...t){if(!n)throw wc(e,...t)}function ft(n){let e="INTERNAL ASSERTION FAILED: "+n;throw ys(e),new Error(e)}function Bt(n,e){n||ft(e)}function nc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Ly(){return lf()==="http:"||lf()==="https:"}function lf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Uy(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ly()||Bd()||"connection"in navigator)?navigator.onLine:!0}function By(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var hn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Bt(t>e,"Short delay should be less than long delay!"),this.isMobile=Ud()||jd()}get(){return Uy()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Ec(n,e){Bt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ts=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ft("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ft("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ft("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var jy={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var qy=new hn(3e4,6e4);function jt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function qt(s,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){return Df(n,i,()=>y(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let I=qr(Object.assign({key:n.config.apiKey},p)).slice(1),C=yield n._getAdditionalHeaders();return C["Content-Type"]="application/json",n.languageCode&&(C["X-Firebase-Locale"]=n.languageCode),Ts.fetch()(kf(n,n.config.apiHost,t,I),Object.assign({method:e,headers:C,referrerPolicy:"no-referrer"},d))}))})}function Df(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},jy),e);try{let i=new rc(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw _s(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let u=s.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw _s(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw _s(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw _s(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Pf(n,p,d);Ze(n,p)}}catch(i){if(i instanceof xe)throw i;Ze(n,"network-request-failed",{message:String(i)})}})}function ei(s,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield qt(n,e,t,r,i);return"mfaPendingCredential"in d&&Ze(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function kf(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Ec(n.config,i):`${n.config.apiScheme}://${i}`}function $y(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var rc=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ln(this.auth,"network-request-failed")),qy.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function _s(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=ln(n,e,r);return i.customData._tokenResponse=t,i}function hf(n){return n!==void 0&&n.enterprise!==void 0}var ic=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return $y(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function Gy(n,e){return y(this,null,function*(){return qt(n,"GET","/v2/recaptchaConfig",jt(n,e))})}function zy(n,e){return y(this,null,function*(){return qt(n,"POST","/v1/accounts:delete",e)})}function Nf(n,e){return y(this,null,function*(){return qt(n,"POST","/v1/accounts:lookup",e)})}function Hr(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Tc(n,e=!1){return y(this,null,function*(){let t=ye(n),r=yield t.getIdToken(e),i=bc(r);U(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Hr(Za(i.auth_time)),issuedAtTime:Hr(Za(i.iat)),expirationTime:Hr(Za(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Za(n){return Number(n)*1e3}function bc(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ys("JWT malformed, contained fewer than 3 sections"),null;try{let i=ka(t);return i?JSON.parse(i):(ys("Failed to decode base64 JWT payload"),null)}catch(i){return ys("Caught error parsing JWT payload as JSON",i?.toString()),null}}function df(n){let e=bc(n);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Qr(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof xe&&Wy(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function Wy({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var sc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Jr=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hr(this.lastLoginAt),this.creationTime=Hr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function bs(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Qr(n,Nf(t,{idToken:r}));U(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Vf(s.providerUserInfo):[],u=Hy(n.providerData,a),h=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!u?.length,p=h?d:!1,I={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new Jr(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,I)})}function Ac(n){return y(this,null,function*(){let e=ye(n);yield bs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Hy(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Vf(n){return n.map(e=>{var{providerId:t}=e,r=pa(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Ky(n,e){return y(this,null,function*(){let t=yield Df(n,{},()=>y(this,null,function*(){let r=qr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=kf(n,i,"/v1/token",`key=${s}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Ts.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function Qy(n,e){return y(this,null,function*(){return qt(n,"POST","/v2/accounts:revokeToken",jt(n,e))})}var Kr=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):df(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(e.length!==0,"internal-error");let t=df(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield Ky(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(U(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(U(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ft("not implemented")}};function Ut(n,e){U(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var $n=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=pa(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Jr(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield Qr(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Tc(this,e)}reload(){return Ac(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield bs(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(We(this.auth.app))return Promise.reject(mt(this.auth));let e=yield this.getIdToken();return yield Qr(this,zy(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,u,h,d,p;let I=(r=t.displayName)!==null&&r!==void 0?r:void 0,C=(i=t.email)!==null&&i!==void 0?i:void 0,R=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,N=(a=t.photoURL)!==null&&a!==void 0?a:void 0,F=(u=t.tenantId)!==null&&u!==void 0?u:void 0,k=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,G=(d=t.createdAt)!==null&&d!==void 0?d:void 0,H=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:K,emailVerified:re,isAnonymous:Se,providerData:ee,stsTokenManager:w}=t;U(K&&w,e,"internal-error");let m=Kr.fromJSON(this.name,w);U(typeof K=="string",e,"internal-error"),Ut(I,e.name),Ut(C,e.name),U(typeof re=="boolean",e,"internal-error"),U(typeof Se=="boolean",e,"internal-error"),Ut(R,e.name),Ut(N,e.name),Ut(F,e.name),Ut(k,e.name),Ut(G,e.name),Ut(H,e.name);let _=new n({uid:K,auth:e,email:C,emailVerified:re,displayName:I,isAnonymous:Se,photoURL:N,phoneNumber:R,tenantId:F,stsTokenManager:m,createdAt:G,lastLoginAt:H});return ee&&Array.isArray(ee)&&(_.providerData=ee.map(v=>Object.assign({},v))),k&&(_._redirectEventId=k),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new Kr;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield bs(s),s})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];U(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Vf(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,u=new Kr;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Jr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(h,d),h})}};var ff=new Map;function pt(n){Bt(n instanceof Function,"Expected a class definition");let e=ff.get(n);return e?(Bt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ff.set(n,e),e)}var Jy=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),oc=Jy;function vs(n,e,t){return`firebase:${n}:${e}:${t}`}var As=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=vs(this.userKey,i.apiKey,s),this.fullPersistenceKey=vs("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?$n._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(pt(oc),e,r);let i=(yield Promise.all(t.map(d=>y(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||pt(oc),a=vs(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let I=$n._fromJSON(e,p);d!==s&&(u=I),s=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new n(s,e,r):(s=h[0],u&&(yield s._set(a,u.toJSON())),yield Promise.all(t.map(d=>y(this,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function pf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ff(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Uf(e))return"Blackberry";if(Bf(e))return"Webos";if(Of(e))return"Safari";if((e.includes("chrome/")||Mf(e))&&!e.includes("edge/"))return"Chrome";if(Lf(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function xf(n=pe()){return/firefox\//i.test(n)}function Of(n=pe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Mf(n=pe()){return/crios\//i.test(n)}function Ff(n=pe()){return/iemobile/i.test(n)}function Lf(n=pe()){return/android/i.test(n)}function Uf(n=pe()){return/blackberry/i.test(n)}function Bf(n=pe()){return/webos/i.test(n)}function Cc(n=pe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Yy(n=pe()){var e;return Cc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Xy(){return qd()&&document.documentMode===10}function jf(n=pe()){return Cc(n)||Lf(n)||Bf(n)||Uf(n)||/windows phone/i.test(n)||Ff(n)}function qf(n,e=[]){let t;switch(n){case"Browser":t=pf(pe());break;case"Worker":t=`${pf(pe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Lt}/${r}`}var ac=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,u)=>{try{let h=e(s);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function Zy(t){return y(this,arguments,function*(n,e={}){return qt(n,"GET","/v2/passwordPolicy",jt(n,e))})}var ev=6,cc=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:ev,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var uc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Cs(this),this.idTokenSubscription=new Cs(this),this.beforeStateQueue=new ac(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Rf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pt(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield As.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield Nf(this,{idToken:e}),r=yield $n._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(We(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield bs(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=By()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(We(this.app))return Promise.reject(mt(this));let t=e?ye(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return We(this.app)?Promise.reject(mt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return We(this.app)?Promise.reject(mt(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(pt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield Zy(this),t=new cc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ut("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield Qy(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&pt(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=yield As.create(this,[pt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Fy(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function fn(n){return ye(n)}var Cs=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Wd(t=>this.observer=t)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Vs={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tv(n){Vs=n}function $f(n){return Vs.loadJS(n)}function nv(){return Vs.recaptchaEnterpriseScript}function rv(){return Vs.gapiScript}function Gf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var iv="recaptcha-enterprise",sv="NO_RECAPTCHA",lc=class{constructor(e){this.type=iv,this.auth=fn(e)}verify(e="verify",t=!1){return y(this,null,function*(){function r(s){return y(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,u)=>y(this,null,function*(){Gy(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new ic(h);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(h=>{u(h)})}))})}function i(s,a,u){let h=window.grecaptcha;hf(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(sv)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(u=>{if(!t&&hf(window.grecaptcha))i(u,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=nv();h.length!==0&&(h+=u),$f(h).then(()=>{i(u,s,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})})}};function mf(n,e,t,r=!1){return y(this,null,function*(){let i=new lc(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function hc(n,e,t,r){return y(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield mf(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>y(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=yield mf(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)}))})}function Sc(n,e){let t=zr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(sn(s,e??{}))return i;Ze(i,"already-initialized")}return t.initialize({options:e})}function ov(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(pt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Rc(n,e,t){let r=fn(n);U(r._canInitEmulator,r,"emulator-config-failed"),U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=zf(e),{host:a,port:u}=av(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||cv()}function zf(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function av(n){let e=zf(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:gf(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:gf(a)}}}function gf(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function cv(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Yr=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ft("not implemented")}_getIdTokenResponse(e){return ft("not implemented")}_linkToIdToken(e,t){return ft("not implemented")}_getReauthenticationResolver(e){return ft("not implemented")}};function uv(n,e){return y(this,null,function*(){return qt(n,"POST","/v1/accounts:signUp",e)})}function lv(n,e){return y(this,null,function*(){return ei(n,"POST","/v1/accounts:signInWithPassword",jt(n,e))})}function hv(n,e){return y(this,null,function*(){return ei(n,"POST","/v1/accounts:signInWithEmailLink",jt(n,e))})}function dv(n,e){return y(this,null,function*(){return ei(n,"POST","/v1/accounts:signInWithEmailLink",jt(n,e))})}var Xr=class n extends Yr{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hc(e,t,"signInWithPassword",lv);case"emailLink":return hv(e,{email:this._email,oobCode:this._password});default:Ze(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hc(e,r,"signUpPassword",uv);case"emailLink":return dv(e,{idToken:t,email:this._email,oobCode:this._password});default:Ze(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function ec(n,e){return y(this,null,function*(){return ei(n,"POST","/v1/accounts:signInWithIdp",jt(n,e))})}function fv(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function pv(n){let e=Fn(Ln(n)).link,t=e?Fn(Ln(e)).deep_link_id:null,r=Fn(Ln(n)).deep_link_id;return(r?Fn(Ln(r)).link:null)||r||t||e||n}var Ss=class n{constructor(e){var t,r,i,s,a,u;let h=Fn(Ln(e)),d=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,I=fv((i=h.mode)!==null&&i!==void 0?i:null);U(d&&p&&I,"argument-error"),this.apiKey=d,this.operation=I,this.code=p,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=pv(e);try{return new n(t)}catch{return null}}};var Wf=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Xr._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Ss.parseLink(r);return U(i,"argument-error"),Xr._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Rs=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var dc=class extends Rs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function mv(n,e){return y(this,null,function*(){return ei(n,"POST","/v1/accounts:signUp",jt(n,e))})}var Gn=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let s=yield $n._fromIdTokenResponse(e,r,i),a=_f(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=_f(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function _f(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var fc=class n extends xe{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Hf(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?fc._fromErrorAndOperation(n,s,e,r):s})}function gv(n,e,t=!1){return y(this,null,function*(){let r=yield Qr(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Gn._forOperation(n,"link",r)})}function _v(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(We(r.app))return Promise.reject(mt(r));let i="reauthenticate";try{let s=yield Qr(n,Hf(r,i,e,n),t);U(s.idToken,r,"internal-error");let a=bc(s.idToken);U(a,r,"internal-error");let{sub:u}=a;return U(n.uid===u,r,"user-mismatch"),Gn._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ze(r,"user-mismatch"),s}})}function Kf(n,e,t=!1){return y(this,null,function*(){if(We(n.app))return Promise.reject(mt(n));let r="signIn",i=yield Hf(n,r,e),s=yield Gn._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Pc(n,e){return y(this,null,function*(){return Kf(fn(n),e)})}function Qf(n){return y(this,null,function*(){let e=fn(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function Dc(n,e,t){return y(this,null,function*(){if(We(n.app))return Promise.reject(mt(n));let r=fn(n),a=yield hc(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",mv).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&Qf(n),h}),u=yield Gn._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(u.user),u})}function kc(n,e,t){return We(n.app)?Promise.reject(mt(n)):Pc(ye(n),Wf.credential(e,t)).catch(r=>y(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Qf(n),r}))}function Nc(n,e,t,r){return ye(n).onIdTokenChanged(e,t,r)}function Vc(n,e,t){return ye(n).beforeAuthStateChanged(e,t)}function xc(n){return ye(n).signOut()}var Ps="__sak";var Ds=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ps,"1"),this.storage.removeItem(Ps),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var yv=1e3,vv=10,Iv=(()=>{class n extends Ds{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jf(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);Xy()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,vv):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},yv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Ct(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Ct(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Ct(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Jf=Iv;var wv=(()=>{class n extends Ds{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Oc=wv;function Ev(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var Tv=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,u=this.handlersMap[s];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let h=Array.from(u).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield Ev(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Yf(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var pc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((u,h)=>{let d=Yf("",20);i.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(I){let C=I;if(C.data.eventId===d)switch(C.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(C.data.response);break;default:clearTimeout(p),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function Xe(){return window}function bv(n){Xe().location.href=n}function Xf(){return typeof Xe().WorkerGlobalScope<"u"&&typeof Xe().importScripts=="function"}function Av(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function Cv(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Sv(){return Xf()?self:null}var Zf="firebaseLocalStorageDb",Rv=1,ks="firebaseLocalStorage",ep="fbase_key",dn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function xs(n,e){return n.transaction([ks],e?"readwrite":"readonly").objectStore(ks)}function Pv(){let n=indexedDB.deleteDatabase(Zf);return new dn(n).toPromise()}function mc(){let n=indexedDB.open(Zf,Rv);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(ks,{keyPath:ep})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(ks)?e(r):(r.close(),yield Pv(),e(yield mc()))}))})}function yf(n,e,t){return y(this,null,function*(){let r=xs(n,!0).put({[ep]:e,value:t});return new dn(r).toPromise()})}function Dv(n,e){return y(this,null,function*(){let t=xs(n,!1).get(e),r=yield new dn(t).toPromise();return r===void 0?null:r.value})}function vf(n,e){let t=xs(n,!0).delete(e);return new dn(t).toPromise()}var kv=800,Nv=3,Vv=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield mc(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Nv)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return Xf()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=Tv._getInstance(Sv()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield Av(),!this.activeServiceWorker)return;this.sender=new pc(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||Cv()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield mc();return yield yf(t,Ps,"1"),yield vf(t,Ps),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>yf(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>Dv(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>vf(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(s=>{let a=xs(s,!1).getAll();return new dn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),kv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),tp=Vv;var nb=Gf("rcb"),rb=new hn(3e4,6e4);function xv(n,e){return e?pt(e):(U(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Zr=class extends Yr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ec(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ec(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ec(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Ov(n){return Kf(n.auth,new Zr(n),n.bypassAuthState)}function Mv(n){let{auth:e,user:t}=n;return U(t,e,"internal-error"),_v(t,new Zr(n),n.bypassAuthState)}function Fv(n){return y(this,null,function*(){let{auth:e,user:t}=n;return U(t,e,"internal-error"),gv(t,new Zr(n),n.bypassAuthState)})}var gc=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ov;case"linkViaPopup":case"linkViaRedirect":return Fv;case"reauthViaPopup":case"reauthViaRedirect":return Mv;default:Ze(this.auth,"internal-error")}}resolve(e){Bt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var ib=new hn(2e3,1e4);var Lv="pendingRedirect",Is=new Map,_c=class n extends gc{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=Is.get(this.auth._key());if(!e){try{let r=(yield Uv(this.resolver,this.auth))?yield Ct(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Is.set(this.auth._key(),e)}return this.bypassAuthState||Is.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Ct(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Ct(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function Uv(n,e){return y(this,null,function*(){let t=qv(e),r=jv(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Bv(n,e){Is.set(n._key(),e)}function jv(n){return pt(n._redirectPersistence)}function qv(n){return vs(Lv,n.config.apiKey,n.name)}function $v(n,e,t=!1){return y(this,null,function*(){if(We(n.app))return Promise.reject(mt(n));let r=fn(n),i=xv(r,e),a=yield new _c(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var Gv=10*60*1e3,yc=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zv(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!np(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ln(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Gv&&this.cachedEventUids.clear(),this.cachedEventUids.has(If(e))}saveEventToCache(e){this.cachedEventUids.add(If(e)),this.lastProcessedEventTime=Date.now()}};function If(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function np({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function zv(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return np(n);default:return!1}}function Wv(t){return y(this,arguments,function*(n,e={}){return qt(n,"GET","/v1/projects",e)})}var Hv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Kv=/^https?/;function Qv(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield Wv(n);for(let t of e)try{if(Jv(t))return}catch{}Ze(n,"unauthorized-domain")})}function Jv(n){let e=nc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!Kv.test(t))return!1;if(Hv.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Yv=new hn(3e4,6e4);function wf(){let n=Xe().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Xv(n){return new Promise((e,t)=>{var r,i,s;function a(){wf(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wf(),t(ln(n,"network-request-failed"))},timeout:Yv.get()})}if(!((i=(r=Xe().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Xe().gapi)===null||s===void 0)&&s.load)a();else{let u=Gf("iframefcb");return Xe()[u]=()=>{gapi.load?a():t(ln(n,"network-request-failed"))},$f(`${rv()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw ws=null,e})}var ws=null;function Zv(n){return ws=ws||Xv(n),ws}var eI=new hn(5e3,15e3),tI="__/auth/iframe",nI="emulator/auth/iframe",rI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sI(n){let e=n.config;U(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Ec(e,nI):`https://${n.config.authDomain}/${tI}`,r={apiKey:e.apiKey,appName:n.name,v:Lt},i=iI.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${qr(r).slice(1)}`}function oI(n){return y(this,null,function*(){let e=yield Zv(n),t=Xe().gapi;return U(t,n,"internal-error"),e.open({where:document.body,url:sI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rI,dontclear:!0},r=>new Promise((i,s)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=ln(n,"network-request-failed"),u=Xe().setTimeout(()=>{s(a)},eI.get());function h(){Xe().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{s(a)})})))})}var aI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},cI=500,uI=600,lI="_blank",hI="http://localhost",Ns=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function dI(n,e,t,r=cI,i=uI){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",h=Object.assign(Object.assign({},aI),{width:r.toString(),height:i.toString(),top:s,left:a}),d=pe().toLowerCase();t&&(u=Mf(d)?lI:t),xf(d)&&(e=e||hI,h.scrollbars="yes");let p=Object.entries(h).reduce((C,[R,N])=>`${C}${R}=${N},`,"");if(Yy(d)&&u!=="_self")return fI(e||"",u),new Ns(null);let I=window.open(e||"",u,p);U(I,n,"popup-blocked");try{I.focus()}catch{}return new Ns(I)}function fI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var pI="__/auth/handler",mI="emulator/auth/handler",gI=encodeURIComponent("fac");function Ef(n,e,t,r,i,s){return y(this,null,function*(){U(n.config.authDomain,n,"auth-domain-config-required"),U(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Lt,eventId:i};if(e instanceof Rs){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",zd(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,I]of Object.entries(s||{}))a[p]=I}if(e instanceof dc){let p=e.getScopes().filter(I=>I!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let h=yield n._getAppCheckToken(),d=h?`#${gI}=${encodeURIComponent(h)}`:"";return`${_I(n)}?${qr(u).slice(1)}${d}`})}function _I({config:n}){return n.emulator?Ec(n,mI):`https://${n.authDomain}/${pI}`}var tc="webStorageSupport",vc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Oc,this._completeRedirectFn=$v,this._overrideRedirectResult=Bv}_openPopup(e,t,r,i){return y(this,null,function*(){var s;Bt((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield Ef(e,t,r,nc(),i);return dI(e,a,Yf())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let s=yield Ef(e,t,r,nc(),i);return bv(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Bt(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield oI(e),r=new yc(e);return t.register("authEvent",i=>(U(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(tc,{type:tc},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[tc];a!==void 0&&t(!!a),Ze(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Qv(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jf()||Of()||Cc()}},rp=vc;var Tf="@firebase/auth",bf="1.7.8";var Ic=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function yI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vI(n){Ft(new Ge("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;U(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qf(n)},d=new uc(r,i,s,h);return ov(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ft(new Ge("auth-internal",e=>{let t=fn(e.getProvider("auth").getImmediate());return(r=>new Ic(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fe(Tf,bf,yI(n)),fe(Tf,bf,"esm2017")}var II=5*60,wI=xa("authIdTokenMaxAge")||II,Af=null,EI=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>wI)return;let i=t?.token;Af!==i&&(Af=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Mc(n=Un()){let e=zr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Sc(n,{popupRedirectResolver:rp,persistence:[tp,Jf,Oc]}),r=xa("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=EI(s.toString());Vc(t,a,()=>a(t.currentUser)),Nc(t,u=>a(u))}}let i=Na("auth");return i&&Rc(t,`http://${i}`),t}function TI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}tv({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=ln("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",TI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vI("Browser");var ip="auth",Oe=class{constructor(e){return e}},ti=class{constructor(){return Wr(ip)}};var Fc=new Ue("angularfire2.auth-instances");function fw(n,e){let t=ms(ip,n,e);return t&&new Oe(t)}function pw(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Oe(r)}}var mw={provide:ti,deps:[[new Be,Fc]]},gw={provide:Oe,useFactory:fw,deps:[[new Be,Fc],dt]};function sp(n,...e){return fe("angularfire",cn.full,"auth"),Vn([gw,mw,{provide:Fc,useFactory:pw(n),multi:!0,deps:[Dt,nn,qn,un,[new Be,jn],...e]}])}var op=De(Dc,!0);var ap=De(Mc,!0);var cp=De(kc,!0);var Os=De(xc,!0);var _p=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(Z(Ta),Z(Ea))},e.\u0275dir=St({type:e});let n=e;return n})(),_w=(()=>{let e=class e extends _p{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=wa(e)))(s||e)}})(),e.\u0275dir=St({type:e,features:[xn]});let n=e;return n})(),yp=new Ue("");var yw={provide:yp,useExisting:Xi(()=>$t),multi:!0};function vw(){let n=Ca()?Ca().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var Iw=new Ue(""),$t=(()=>{let e=class e extends _p{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!vw())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(Z(Ta),Z(Ea),Z(Iw,8))},e.\u0275dir=St({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&qe("input",function(u){return s._handleInput(u.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(u){return s._compositionEnd(u.target.value)})},features:[is([yw]),xn]});let n=e;return n})();function ww(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var vp=new Ue(""),Ew=new Ue("");function Tw(n){return ww(n.value)?{required:!0}:null}function up(n){return null}function Ip(n){return n!=null}function wp(n){return Ed(n)?_a(n):n}function Ep(n){let e={};return n.forEach(t=>{e=t!=null?ke(ke({},e),t):e}),Object.keys(e).length===0?null:e}function Tp(n,e){return e.map(t=>t(n))}function bw(n){return!n.validate}function bp(n){return n.map(e=>bw(e)?e:t=>e.validate(t))}function Aw(n){if(!n)return null;let e=n.filter(Ip);return e.length==0?null:function(t){return Ep(Tp(t,e))}}function Ap(n){return n!=null?Aw(bp(n)):null}function Cw(n){if(!n)return null;let e=n.filter(Ip);return e.length==0?null:function(t){let r=Tp(t,e).map(wp);return hd(r).pipe(Ur(Ep))}}function Cp(n){return n!=null?Cw(bp(n)):null}function lp(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Sw(n){return n._rawValidators}function Rw(n){return n._rawAsyncValidators}function Lc(n){return n?Array.isArray(n)?n:[n]:[]}function Ls(n,e){return Array.isArray(n)?n.includes(e):n===e}function hp(n,e){let t=Lc(e);return Lc(n).forEach(i=>{Ls(t,i)||t.push(i)}),t}function dp(n,e){return Lc(e).filter(t=>!Ls(n,t))}var Us=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ap(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Cp(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Uc=class extends Us{get formDirective(){return null}get path(){return null}},oi=class extends Us{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Bc=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Pw={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},sA=Le(ke({},Pw),{"[class.ng-submitted]":"isSubmitted"}),Kn=(()=>{let e=class e extends Bc{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Z(oi,2))},e.\u0275dir=St({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&md("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[xn]});let n=e;return n})();var ni="VALID",Fs="INVALID",zn="PENDING",ri="DISABLED",Hn=class{},Bs=class extends Hn{constructor(e,t){super(),this.value=e,this.source=t}},ii=class extends Hn{constructor(e,t){super(),this.pristine=e,this.source=t}},si=class extends Hn{constructor(e,t){super(),this.touched=e,this.source=t}},Wn=class extends Hn{constructor(e,t){super(),this.status=e,this.source=t}};function Dw(n){return(js(n)?n.validators:n)||null}function kw(n){return Array.isArray(n)?Ap(n):n||null}function Nw(n,e){return(js(e)?e.asyncValidators:n)||null}function Vw(n){return Array.isArray(n)?Cp(n):n||null}function js(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var jc=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=os(()=>this.statusReactive()),this.statusReactive=ts(void 0),this._pristine=os(()=>this.pristineReactive()),this.pristineReactive=ts(!0),this._touched=os(()=>this.touchedReactive()),this.touchedReactive=ts(!1),this._events=new cd,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return rn(this.statusReactive)}set status(e){rn(()=>this.statusReactive.set(e))}get valid(){return this.status===ni}get invalid(){return this.status===Fs}get pending(){return this.status==zn}get disabled(){return this.status===ri}get enabled(){return this.status!==ri}get pristine(){return rn(this.pristineReactive)}set pristine(e){rn(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return rn(this.touchedReactive)}set touched(e){rn(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(hp(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(hp(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(dp(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(dp(e,this._rawAsyncValidators))}hasValidator(e){return Ls(this._rawValidators,e)}hasAsyncValidator(e){return Ls(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Le(ke({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new si(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new si(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Le(ke({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new ii(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new ii(!0,r))}markAsPending(e={}){this.status=zn;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Wn(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Le(ke({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ri,this.errors=null,this._forEachChild(i=>{i.disable(Le(ke({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Bs(this.value,r)),this._events.next(new Wn(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Le(ke({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ni,this._forEachChild(r=>{r.enable(Le(ke({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Le(ke({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ni||this.status===zn)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Bs(this.value,t)),this._events.next(new Wn(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Le(ke({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ri:ni}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=zn,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=wp(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Wn(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new es,this.statusChanges=new es}_calculateStatus(){return this._allControlsDisabled()?ri:this.errors?Fs:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(zn)?zn:this._anyControlsHaveStatus(Fs)?Fs:ni}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new ii(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new si(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){js(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=kw(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Vw(this._rawAsyncValidators)}};var Sp=new Ue("CallSetDisabledState",{providedIn:"root",factory:()=>qc}),qc="always";function xw(n,e){return[...e.path,n]}function Ow(n,e,t=qc){Fw(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),Lw(n,e),Bw(n,e),Uw(n,e),Mw(n,e)}function fp(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Mw(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Fw(n,e){let t=Sw(n);e.validator!==null?n.setValidators(lp(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=Rw(n);e.asyncValidator!==null?n.setAsyncValidators(lp(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();fp(e._rawValidators,i),fp(e._rawAsyncValidators,i)}function Lw(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Rp(n,e)})}function Uw(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Rp(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Rp(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Bw(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function jw(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function qw(n){return Object.getPrototypeOf(n.constructor)===_w}function $w(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===$t?t=s:qw(s)?r=s:i=s}),i||r||t||null}function pp(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function mp(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Gw=class extends jc{constructor(e=null,t,r){super(Dw(t),Nw(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),js(t)&&(t.nonNullable||t.initialValueIsDefault)&&(mp(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){pp(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){pp(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){mp(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var zw={provide:oi,useExisting:Xi(()=>pn)},gp=Promise.resolve(),pn=(()=>{let e=class e extends oi{constructor(r,i,s,a,u,h){super(),this._changeDetectorRef=u,this.callSetDisabledState=h,this.control=new Gw,this._registered=!1,this.name="",this.update=new es,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=$w(this,a)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),jw(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Ow(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){gp.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Aa(i);gp.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?xw(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(Z(Uc,9),Z(vp,10),Z(Ew,10),Z(yp,10),Z(bd,8),Z(Sp,8))},e.\u0275dir=St({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[is([zw]),xn,Ia]});let n=e;return n})();var Ww=(()=>{let e=class e{constructor(){this._validator=up}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):up,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=St({type:e,features:[Ia]});let n=e;return n})();var Hw={provide:vp,useExisting:Xi(()=>ai),multi:!0};var ai=(()=>{let e=class e extends Ww{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Aa,this.createValidator=r=>Tw}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=wa(e)))(s||e)}})(),e.\u0275dir=St({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&pd("required",s._enabled?"":null)},inputs:{required:"required"},features:[is([Hw]),xn]});let n=e;return n})();var Kw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=va({type:e}),e.\u0275inj=ya({});let n=e;return n})();var Qn=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:Sp,useValue:r.callSetDisabledState??qc}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=va({type:e}),e.\u0275inj=ya({imports:[Kw]});let n=e;return n})();var Pp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Dp={};var Gt,Gc;(function(){var n;function e(w,m){function _(){}_.prototype=m.prototype,w.D=m.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(v,E,b){for(var g=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)g[ot-2]=arguments[ot];return m.prototype[E].apply(v,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,m,_){_||(_=0);var v=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)v[E]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(E=0;16>E;++E)v[E]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=w.g[0],_=w.g[1],E=w.g[2];var b=w.g[3],g=m+(b^_&(E^b))+v[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=b+(E^m&(_^E))+v[1]+3905402710&4294967295,b=m+(g<<12&4294967295|g>>>20),g=E+(_^b&(m^_))+v[2]+606105819&4294967295,E=b+(g<<17&4294967295|g>>>15),g=_+(m^E&(b^m))+v[3]+3250441966&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(b^_&(E^b))+v[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(E^m&(_^E))+v[5]+1200080426&4294967295,b=m+(g<<12&4294967295|g>>>20),g=E+(_^b&(m^_))+v[6]+2821735955&4294967295,E=b+(g<<17&4294967295|g>>>15),g=_+(m^E&(b^m))+v[7]+4249261313&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(b^_&(E^b))+v[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(E^m&(_^E))+v[9]+2336552879&4294967295,b=m+(g<<12&4294967295|g>>>20),g=E+(_^b&(m^_))+v[10]+4294925233&4294967295,E=b+(g<<17&4294967295|g>>>15),g=_+(m^E&(b^m))+v[11]+2304563134&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(b^_&(E^b))+v[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(E^m&(_^E))+v[13]+4254626195&4294967295,b=m+(g<<12&4294967295|g>>>20),g=E+(_^b&(m^_))+v[14]+2792965006&4294967295,E=b+(g<<17&4294967295|g>>>15),g=_+(m^E&(b^m))+v[15]+1236535329&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(E^b&(_^E))+v[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^E&(m^_))+v[6]+3225465664&4294967295,b=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(b^m))+v[11]+643717713&4294967295,E=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(E^b))+v[0]+3921069994&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^b&(_^E))+v[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^E&(m^_))+v[10]+38016083&4294967295,b=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(b^m))+v[15]+3634488961&4294967295,E=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(E^b))+v[4]+3889429448&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^b&(_^E))+v[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^E&(m^_))+v[14]+3275163606&4294967295,b=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(b^m))+v[3]+4107603335&4294967295,E=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(E^b))+v[8]+1163531501&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^b&(_^E))+v[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^E&(m^_))+v[2]+4243563512&4294967295,b=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(b^m))+v[7]+1735328473&4294967295,E=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(E^b))+v[12]+2368359562&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(_^E^b)+v[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^E)+v[8]+2272392833&4294967295,b=m+(g<<11&4294967295|g>>>21),g=E+(b^m^_)+v[11]+1839030562&4294967295,E=b+(g<<16&4294967295|g>>>16),g=_+(E^b^m)+v[14]+4259657740&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^b)+v[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^E)+v[4]+1272893353&4294967295,b=m+(g<<11&4294967295|g>>>21),g=E+(b^m^_)+v[7]+4139469664&4294967295,E=b+(g<<16&4294967295|g>>>16),g=_+(E^b^m)+v[10]+3200236656&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^b)+v[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^E)+v[0]+3936430074&4294967295,b=m+(g<<11&4294967295|g>>>21),g=E+(b^m^_)+v[3]+3572445317&4294967295,E=b+(g<<16&4294967295|g>>>16),g=_+(E^b^m)+v[6]+76029189&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^b)+v[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^E)+v[12]+3873151461&4294967295,b=m+(g<<11&4294967295|g>>>21),g=E+(b^m^_)+v[15]+530742520&4294967295,E=b+(g<<16&4294967295|g>>>16),g=_+(E^b^m)+v[2]+3299628645&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(E^(_|~b))+v[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~E))+v[7]+1126891415&4294967295,b=m+(g<<10&4294967295|g>>>22),g=E+(m^(b|~_))+v[14]+2878612391&4294967295,E=b+(g<<15&4294967295|g>>>17),g=_+(b^(E|~m))+v[5]+4237533241&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~b))+v[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~E))+v[3]+2399980690&4294967295,b=m+(g<<10&4294967295|g>>>22),g=E+(m^(b|~_))+v[10]+4293915773&4294967295,E=b+(g<<15&4294967295|g>>>17),g=_+(b^(E|~m))+v[1]+2240044497&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~b))+v[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~E))+v[15]+4264355552&4294967295,b=m+(g<<10&4294967295|g>>>22),g=E+(m^(b|~_))+v[6]+2734768916&4294967295,E=b+(g<<15&4294967295|g>>>17),g=_+(b^(E|~m))+v[13]+1309151649&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~b))+v[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~E))+v[11]+3174756917&4294967295,b=m+(g<<10&4294967295|g>>>22),g=E+(m^(b|~_))+v[2]+718787259&4294967295,E=b+(g<<15&4294967295|g>>>17),g=_+(b^(E|~m))+v[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(E+(g<<21&4294967295|g>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+b&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var _=m-this.blockSize,v=this.B,E=this.h,b=0;b<m;){if(E==0)for(;b<=_;)i(this,w,b),b+=this.blockSize;if(typeof w=="string"){for(;b<m;)if(v[E++]=w.charCodeAt(b++),E==this.blockSize){i(this,v),E=0;break}}else for(;b<m;)if(v[E++]=w[b++],E==this.blockSize){i(this,v),E=0;break}}this.h=E,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var _=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=_&255,_/=256;for(this.u(w),w=Array(16),m=_=0;4>m;++m)for(var v=0;32>v;v+=8)w[_++]=this.g[m]>>>v&255;return w};function s(w,m){var _=u;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=m(w)}function a(w,m){this.h=m;for(var _=[],v=!0,E=w.length-1;0<=E;E--){var b=w[E]|0;v&&b==m||(_[E]=b,v=!1)}this.g=_}var u={};function h(w){return-128<=w&&128>w?s(w,function(m){return new a([m|0],0>m?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return I;if(0>w)return k(d(-w));for(var m=[],_=1,v=0;w>=_;v++)m[v]=w/_|0,_*=4294967296;return new a(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return k(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),v=I,E=0;E<w.length;E+=8){var b=Math.min(8,w.length-E),g=parseInt(w.substring(E,E+b),m);8>b?(b=d(Math.pow(m,b)),v=v.j(b).add(d(g))):(v=v.j(_),v=v.add(d(g)))}return v}var I=h(0),C=h(1),R=h(16777216);n=a.prototype,n.m=function(){if(F(this))return-k(this).m();for(var w=0,m=1,_=0;_<this.g.length;_++){var v=this.i(_);w+=(0<=v?v:4294967296+v)*m,m*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(N(this))return"0";if(F(this))return"-"+k(this).toString(w);for(var m=d(Math.pow(w,6)),_=this,v="";;){var E=re(_,m).g;_=G(_,E.j(m));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=E,N(_))return b+v;for(;6>b.length;)b="0"+b;v=b+v}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function N(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function F(w){return w.h==-1}n.l=function(w){return w=G(this,w),F(w)?-1:N(w)?0:1};function k(w){for(var m=w.g.length,_=[],v=0;v<m;v++)_[v]=~w.g[v];return new a(_,~w.h).add(C)}n.abs=function(){return F(this)?k(this):this},n.add=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0,E=0;E<=m;E++){var b=v+(this.i(E)&65535)+(w.i(E)&65535),g=(b>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);v=g>>>16,b&=65535,g&=65535,_[E]=g<<16|b}return new a(_,_[_.length-1]&-2147483648?-1:0)};function G(w,m){return w.add(k(m))}n.j=function(w){if(N(this)||N(w))return I;if(F(this))return F(w)?k(this).j(k(w)):k(k(this).j(w));if(F(w))return k(this.j(k(w)));if(0>this.l(R)&&0>w.l(R))return d(this.m()*w.m());for(var m=this.g.length+w.g.length,_=[],v=0;v<2*m;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(var E=0;E<w.g.length;E++){var b=this.i(v)>>>16,g=this.i(v)&65535,ot=w.i(E)>>>16,vr=w.i(E)&65535;_[2*v+2*E]+=g*vr,H(_,2*v+2*E),_[2*v+2*E+1]+=b*vr,H(_,2*v+2*E+1),_[2*v+2*E+1]+=g*ot,H(_,2*v+2*E+1),_[2*v+2*E+2]+=b*ot,H(_,2*v+2*E+2)}for(v=0;v<m;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=m;v<2*m;v++)_[v]=0;return new a(_,0)};function H(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function K(w,m){this.g=w,this.h=m}function re(w,m){if(N(m))throw Error("division by zero");if(N(w))return new K(I,I);if(F(w))return m=re(k(w),m),new K(k(m.g),k(m.h));if(F(m))return m=re(w,k(m)),new K(k(m.g),m.h);if(30<w.g.length){if(F(w)||F(m))throw Error("slowDivide_ only works with positive integers.");for(var _=C,v=m;0>=v.l(w);)_=Se(_),v=Se(v);var E=ee(_,1),b=ee(v,1);for(v=ee(v,2),_=ee(_,2);!N(v);){var g=b.add(v);0>=g.l(w)&&(E=E.add(_),b=g),v=ee(v,1),_=ee(_,1)}return m=G(w,E.j(m)),new K(E,m)}for(E=I;0<=w.l(m);){for(_=Math.max(1,Math.floor(w.m()/m.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),b=d(_),g=b.j(m);F(g)||0<g.l(w);)_-=v,b=d(_),g=b.j(m);N(b)&&(b=C),E=E.add(b),w=G(w,g)}return new K(E,w)}n.A=function(w){return re(this,w).h},n.and=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)&w.i(v);return new a(_,this.h&w.h)},n.or=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)|w.i(v);return new a(_,this.h|w.h)},n.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)^w.i(v);return new a(_,this.h^w.h)};function Se(w){for(var m=w.g.length+1,_=[],v=0;v<m;v++)_[v]=w.i(v)<<1|w.i(v-1)>>>31;return new a(_,w.h)}function ee(w,m){var _=m>>5;m%=32;for(var v=w.g.length-_,E=[],b=0;b<v;b++)E[b]=0<m?w.i(b+_)>>>m|w.i(b+_+1)<<32-m:w.i(b+_);return new a(E,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Gc=Dp.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Gt=Dp.Integer=a}).apply(typeof Pp<"u"?Pp:typeof self<"u"?self:typeof window<"u"?window:{});var qs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gt={};var zc,Wc,Jn,Hc,ci,$s,Kc,Qc,Jc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,l){return o==Array.prototype||o==Object.prototype||(o[c]=l.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof qs=="object"&&qs];for(var c=0;c<o.length;++c){var l=o[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(o,c){if(c)e:{var l=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var T=o[f];if(!(T in l))break e;l=l[T]}o=o[o.length-1],f=l[o],c=c(f),c!=f&&c!=null&&e(l,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var l=0,f=!1,T={next:function(){if(!f&&l<o.length){var A=l++;return{value:c(A,o[A]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(o){return o||function(){return s(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function d(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,l){return o.call.apply(o.bind,arguments)}function I(o,c,l){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),o.apply(c,T)}}return function(){return o.apply(c,arguments)}}function C(o,c,l){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:I,C.apply(null,arguments)}function R(o,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function N(o,c){function l(){}l.prototype=c.prototype,o.aa=c.prototype,o.prototype=new l,o.prototype.constructor=o,o.Qb=function(f,T,A){for(var D=Array(arguments.length-2),te=2;te<arguments.length;te++)D[te-2]=arguments[te];return c.prototype[T].apply(f,D)}}function F(o){let c=o.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=o[f];return l}return[]}function k(o,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let T=o.length||0,A=f.length||0;o.length=T+A;for(let D=0;D<A;D++)o[T+D]=f[D]}else o.push(f)}}class G{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function H(o){return/^[\s\xa0]*$/.test(o)}function K(){var o=u.navigator;return o&&(o=o.userAgent)?o:""}function re(o){return re[" "](o),o}re[" "]=function(){};var Se=K().indexOf("Gecko")!=-1&&!(K().toLowerCase().indexOf("webkit")!=-1&&K().indexOf("Edge")==-1)&&!(K().indexOf("Trident")!=-1||K().indexOf("MSIE")!=-1)&&K().indexOf("Edge")==-1;function ee(o,c,l){for(let f in o)c.call(l,o[f],f,o)}function w(o,c){for(let l in o)c.call(void 0,o[l],l,o)}function m(o){let c={};for(let l in o)c[l]=o[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(o,c){let l,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(l in f)o[l]=f[l];for(let A=0;A<_.length;A++)l=_[A],Object.prototype.hasOwnProperty.call(f,l)&&(o[l]=f[l])}}function E(o){var c=1;o=o.split(":");let l=[];for(;0<c&&o.length;)l.push(o.shift()),c--;return o.length&&l.push(o.join(":")),l}function b(o){u.setTimeout(()=>{throw o},0)}function g(){var o=$o;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class ot{constructor(){this.h=this.g=null}add(c,l){let f=vr.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var vr=new G(()=>new Mg,o=>o.reset());class Mg{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let Ir,wr=!1,$o=new ot,ah=()=>{let o=u.Promise.resolve(void 0);Ir=()=>{o.then(Fg)}};var Fg=()=>{for(var o;o=g();){try{o.h.call(o.g)}catch(l){b(l)}var c=vr;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}wr=!1};function Et(){this.s=this.s,this.C=this.C}Et.prototype.s=!1,Et.prototype.ma=function(){this.s||(this.s=!0,this.N())},Et.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ie(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}Ie.prototype.h=function(){this.defaultPrevented=!0};var Lg=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return o}();function Er(o,c){if(Ie.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var l=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(Se){e:{try{re(c.nodeName);var T=!0;break e}catch{}T=!1}T||(c=null)}}else l=="mouseover"?c=o.fromElement:l=="mouseout"&&(c=o.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:Ug[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Er.aa.h.call(this)}}N(Er,Ie);var Ug={2:"touch",3:"pen",4:"mouse"};Er.prototype.h=function(){Er.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Tr="closure_listenable_"+(1e6*Math.random()|0),Bg=0;function jg(o,c,l,f,T){this.listener=o,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=T,this.key=++Bg,this.da=this.fa=!1}function xi(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Oi(o){this.src=o,this.g={},this.h=0}Oi.prototype.add=function(o,c,l,f,T){var A=o.toString();o=this.g[A],o||(o=this.g[A]=[],this.h++);var D=zo(o,c,f,T);return-1<D?(c=o[D],l||(c.fa=!1)):(c=new jg(c,this.src,A,!!f,T),c.fa=l,o.push(c)),c};function Go(o,c){var l=c.type;if(l in o.g){var f=o.g[l],T=Array.prototype.indexOf.call(f,c,void 0),A;(A=0<=T)&&Array.prototype.splice.call(f,T,1),A&&(xi(c),o.g[l].length==0&&(delete o.g[l],o.h--))}}function zo(o,c,l,f){for(var T=0;T<o.length;++T){var A=o[T];if(!A.da&&A.listener==c&&A.capture==!!l&&A.ha==f)return T}return-1}var Wo="closure_lm_"+(1e6*Math.random()|0),Ho={};function ch(o,c,l,f,T){if(f&&f.once)return lh(o,c,l,f,T);if(Array.isArray(c)){for(var A=0;A<c.length;A++)ch(o,c[A],l,f,T);return null}return l=Yo(l),o&&o[Tr]?o.K(c,l,d(f)?!!f.capture:!!f,T):uh(o,c,l,!1,f,T)}function uh(o,c,l,f,T,A){if(!c)throw Error("Invalid event type");var D=d(T)?!!T.capture:!!T,te=Qo(o);if(te||(o[Wo]=te=new Oi(o)),l=te.add(c,l,f,D,A),l.proxy)return l;if(f=qg(),l.proxy=f,f.src=o,f.listener=l,o.addEventListener)Lg||(T=D),T===void 0&&(T=!1),o.addEventListener(c.toString(),f,T);else if(o.attachEvent)o.attachEvent(dh(c.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function qg(){function o(l){return c.call(o.src,o.listener,l)}let c=$g;return o}function lh(o,c,l,f,T){if(Array.isArray(c)){for(var A=0;A<c.length;A++)lh(o,c[A],l,f,T);return null}return l=Yo(l),o&&o[Tr]?o.L(c,l,d(f)?!!f.capture:!!f,T):uh(o,c,l,!0,f,T)}function hh(o,c,l,f,T){if(Array.isArray(c))for(var A=0;A<c.length;A++)hh(o,c[A],l,f,T);else f=d(f)?!!f.capture:!!f,l=Yo(l),o&&o[Tr]?(o=o.i,c=String(c).toString(),c in o.g&&(A=o.g[c],l=zo(A,l,f,T),-1<l&&(xi(A[l]),Array.prototype.splice.call(A,l,1),A.length==0&&(delete o.g[c],o.h--)))):o&&(o=Qo(o))&&(c=o.g[c.toString()],o=-1,c&&(o=zo(c,l,f,T)),(l=-1<o?c[o]:null)&&Ko(l))}function Ko(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[Tr])Go(c.i,o);else{var l=o.type,f=o.proxy;c.removeEventListener?c.removeEventListener(l,f,o.capture):c.detachEvent?c.detachEvent(dh(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=Qo(c))?(Go(l,o),l.h==0&&(l.src=null,c[Wo]=null)):xi(o)}}}function dh(o){return o in Ho?Ho[o]:Ho[o]="on"+o}function $g(o,c){if(o.da)o=!0;else{c=new Er(c,this);var l=o.listener,f=o.ha||o.src;o.fa&&Ko(o),o=l.call(f,c)}return o}function Qo(o){return o=o[Wo],o instanceof Oi?o:null}var Jo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Yo(o){return typeof o=="function"?o:(o[Jo]||(o[Jo]=function(c){return o.handleEvent(c)}),o[Jo])}function we(){Et.call(this),this.i=new Oi(this),this.M=this,this.F=null}N(we,Et),we.prototype[Tr]=!0,we.prototype.removeEventListener=function(o,c,l,f){hh(this,o,c,l,f)};function Re(o,c){var l,f=o.F;if(f)for(l=[];f;f=f.F)l.push(f);if(o=o.M,f=c.type||c,typeof c=="string")c=new Ie(c,o);else if(c instanceof Ie)c.target=c.target||o;else{var T=c;c=new Ie(f,o),v(c,T)}if(T=!0,l)for(var A=l.length-1;0<=A;A--){var D=c.g=l[A];T=Mi(D,f,!0,c)&&T}if(D=c.g=o,T=Mi(D,f,!0,c)&&T,T=Mi(D,f,!1,c)&&T,l)for(A=0;A<l.length;A++)D=c.g=l[A],T=Mi(D,f,!1,c)&&T}we.prototype.N=function(){if(we.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var l=o.g[c],f=0;f<l.length;f++)xi(l[f]);delete o.g[c],o.h--}}this.F=null},we.prototype.K=function(o,c,l,f){return this.i.add(String(o),c,!1,l,f)},we.prototype.L=function(o,c,l,f){return this.i.add(String(o),c,!0,l,f)};function Mi(o,c,l,f){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var T=!0,A=0;A<c.length;++A){var D=c[A];if(D&&!D.da&&D.capture==l){var te=D.listener,ge=D.ha||D.src;D.fa&&Go(o.i,D),T=te.call(ge,f)!==!1&&T}}return T&&!f.defaultPrevented}function fh(o,c,l){if(typeof o=="function")l&&(o=C(o,l));else if(o&&typeof o.handleEvent=="function")o=C(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(o,c||0)}function ph(o){o.g=fh(()=>{o.g=null,o.i&&(o.i=!1,ph(o))},o.l);let c=o.h;o.h=null,o.m.apply(null,c)}class Gg extends Et{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:ph(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function br(o){Et.call(this),this.h=o,this.g={}}N(br,Et);var mh=[];function gh(o){ee(o.g,function(c,l){this.g.hasOwnProperty(l)&&Ko(c)},o),o.g={}}br.prototype.N=function(){br.aa.N.call(this),gh(this)},br.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xo=u.JSON.stringify,zg=u.JSON.parse,Wg=class{stringify(o){return u.JSON.stringify(o,void 0)}parse(o){return u.JSON.parse(o,void 0)}};function Zo(){}Zo.prototype.h=null;function _h(o){return o.h||(o.h=o.i())}function yh(){}var Ar={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ea(){Ie.call(this,"d")}N(ea,Ie);function ta(){Ie.call(this,"c")}N(ta,Ie);var Yt={},vh=null;function Fi(){return vh=vh||new we}Yt.La="serverreachability";function Ih(o){Ie.call(this,Yt.La,o)}N(Ih,Ie);function Cr(o){let c=Fi();Re(c,new Ih(c))}Yt.STAT_EVENT="statevent";function wh(o,c){Ie.call(this,Yt.STAT_EVENT,o),this.stat=c}N(wh,Ie);function Pe(o){let c=Fi();Re(c,new wh(c,o))}Yt.Ma="timingevent";function Eh(o,c){Ie.call(this,Yt.Ma,o),this.size=c}N(Eh,Ie);function Sr(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){o()},c)}function Rr(){this.g=!0}Rr.prototype.xa=function(){this.g=!1};function Hg(o,c,l,f,T,A){o.info(function(){if(o.g)if(A)for(var D="",te=A.split("&"),ge=0;ge<te.length;ge++){var J=te[ge].split("=");if(1<J.length){var Ee=J[0];J=J[1];var Te=Ee.split("_");D=2<=Te.length&&Te[1]=="type"?D+(Ee+"="+J+"&"):D+(Ee+"=redacted&")}}else D=null;else D=A;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+c+`
`+l+`
`+D})}function Kg(o,c,l,f,T,A,D){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+c+`
`+l+`
`+A+" "+D})}function Pn(o,c,l,f){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+Jg(o,l)+(f?" "+f:"")})}function Qg(o,c){o.info(function(){return"TIMEOUT: "+c})}Rr.prototype.info=function(){};function Jg(o,c){if(!o.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(o=0;o<l.length;o++)if(Array.isArray(l[o])){var f=l[o];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var A=T[0];if(A!="noop"&&A!="stop"&&A!="close")for(var D=1;D<T.length;D++)T[D]=""}}}}return Xo(l)}catch{return c}}var Li={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Th={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},na;function Ui(){}N(Ui,Zo),Ui.prototype.g=function(){return new XMLHttpRequest},Ui.prototype.i=function(){return{}},na=new Ui;function Tt(o,c,l,f){this.j=o,this.i=c,this.l=l,this.R=f||1,this.U=new br(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new bh}function bh(){this.i=null,this.g="",this.h=!1}var Ah={},ra={};function ia(o,c,l){o.L=1,o.v=$i(at(c)),o.m=l,o.P=!0,Ch(o,null)}function Ch(o,c){o.F=Date.now(),Bi(o),o.A=at(o.v);var l=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),Bh(l.i,"t",f),o.C=0,l=o.j.J,o.h=new bh,o.g=id(o.j,l?c:null,!o.m),0<o.O&&(o.M=new Gg(C(o.Y,o,o.g),o.O)),c=o.U,l=o.g,f=o.ca;var T="readystatechange";Array.isArray(T)||(T&&(mh[0]=T.toString()),T=mh);for(var A=0;A<T.length;A++){var D=ch(l,T[A],f||c.handleEvent,!1,c.h||c);if(!D)break;c.g[D.key]=D}c=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),Cr(),Hg(o.i,o.u,o.A,o.l,o.R,o.m)}Tt.prototype.ca=function(o){o=o.target;let c=this.M;c&&ct(o)==3?c.j():this.Y(o)},Tt.prototype.Y=function(o){try{if(o==this.g)e:{let Te=ct(this.g);var c=this.g.Ba();let Nn=this.g.Z();if(!(3>Te)&&(Te!=3||this.g&&(this.h.h||this.g.oa()||Hh(this.g)))){this.J||Te!=4||c==7||(c==8||0>=Nn?Cr(3):Cr(2)),sa(this);var l=this.g.Z();this.X=l;t:if(Sh(this)){var f=Hh(this.g);o="";var T=f.length,A=ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Xt(this),Pr(this);var D="";break t}this.h.i=new u.TextDecoder}for(c=0;c<T;c++)this.h.h=!0,o+=this.h.i.decode(f[c],{stream:!(A&&c==T-1)});f.length=0,this.h.g+=o,this.C=0,D=this.h.g}else D=this.g.oa();if(this.o=l==200,Kg(this.i,this.u,this.A,this.l,this.R,Te,l),this.o){if(this.T&&!this.K){t:{if(this.g){var te,ge=this.g;if((te=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(te)){var J=te;break t}}J=null}if(l=J)Pn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,oa(this,l);else{this.o=!1,this.s=3,Pe(12),Xt(this),Pr(this);break e}}if(this.P){l=!0;let ze;for(;!this.J&&this.C<D.length;)if(ze=Yg(this,D),ze==ra){Te==4&&(this.s=4,Pe(14),l=!1),Pn(this.i,this.l,null,"[Incomplete Response]");break}else if(ze==Ah){this.s=4,Pe(15),Pn(this.i,this.l,D,"[Invalid Chunk]"),l=!1;break}else Pn(this.i,this.l,ze,null),oa(this,ze);if(Sh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Te!=4||D.length!=0||this.h.h||(this.s=1,Pe(16),l=!1),this.o=this.o&&l,!l)Pn(this.i,this.l,D,"[Invalid Chunked Response]"),Xt(this),Pr(this);else if(0<D.length&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.ba&&!Ee.M&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),da(Ee),Ee.M=!0,Pe(11))}}else Pn(this.i,this.l,D,null),oa(this,D);Te==4&&Xt(this),this.o&&!this.J&&(Te==4?ed(this.j,this):(this.o=!1,Bi(this)))}else p_(this.g),l==400&&0<D.indexOf("Unknown SID")?(this.s=3,Pe(12)):(this.s=0,Pe(13)),Xt(this),Pr(this)}}}catch{}finally{}};function Sh(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Yg(o,c){var l=o.C,f=c.indexOf(`
`,l);return f==-1?ra:(l=Number(c.substring(l,f)),isNaN(l)?Ah:(f+=1,f+l>c.length?ra:(c=c.slice(f,f+l),o.C=f+l,c)))}Tt.prototype.cancel=function(){this.J=!0,Xt(this)};function Bi(o){o.S=Date.now()+o.I,Rh(o,o.I)}function Rh(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Sr(C(o.ba,o),c)}function sa(o){o.B&&(u.clearTimeout(o.B),o.B=null)}Tt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(Qg(this.i,this.A),this.L!=2&&(Cr(),Pe(17)),Xt(this),this.s=2,Pr(this)):Rh(this,this.S-o)};function Pr(o){o.j.G==0||o.J||ed(o.j,o)}function Xt(o){sa(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,gh(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function oa(o,c){try{var l=o.j;if(l.G!=0&&(l.g==o||aa(l.h,o))){if(!o.K&&aa(l.h,o)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<o.F)Ki(l),Wi(l);else break e;ha(l),Pe(18)}}else l.za=T[1],0<l.za-l.T&&37500>T[2]&&l.F&&l.v==0&&!l.C&&(l.C=Sr(C(l.Za,l),6e3));if(1>=kh(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else en(l,11)}else if((o.K||l.g==o)&&Ki(l),!H(c))for(T=l.Da.g.parse(c),c=0;c<T.length;c++){let J=T[c];if(l.T=J[0],J=J[1],l.G==2)if(J[0]=="c"){l.K=J[1],l.ia=J[2];let Ee=J[3];Ee!=null&&(l.la=Ee,l.j.info("VER="+l.la));let Te=J[4];Te!=null&&(l.Aa=Te,l.j.info("SVER="+l.Aa));let Nn=J[5];Nn!=null&&typeof Nn=="number"&&0<Nn&&(f=1.5*Nn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let ze=o.g;if(ze){let Ji=ze.g?ze.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ji){var A=f.h;A.g||Ji.indexOf("spdy")==-1&&Ji.indexOf("quic")==-1&&Ji.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(ca(A,A.h),A.h=null))}if(f.D){let fa=ze.g?ze.g.getResponseHeader("X-HTTP-Session-Id"):null;fa&&(f.ya=fa,ie(f.I,f.D,fa))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-o.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var D=o;if(f.qa=rd(f,f.J?f.ia:null,f.W),D.K){Nh(f.h,D);var te=D,ge=f.L;ge&&(te.I=ge),te.B&&(sa(te),Bi(te)),f.g=D}else Xh(f);0<l.i.length&&Hi(l)}else J[0]!="stop"&&J[0]!="close"||en(l,7);else l.G==3&&(J[0]=="stop"||J[0]=="close"?J[0]=="stop"?en(l,7):la(l):J[0]!="noop"&&l.l&&l.l.ta(J),l.v=0)}}Cr(4)}catch{}}var Xg=class{constructor(o,c){this.g=o,this.map=c}};function Ph(o){this.l=o||10,u.PerformanceNavigationTiming?(o=u.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Dh(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function kh(o){return o.h?1:o.g?o.g.size:0}function aa(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function ca(o,c){o.g?o.g.add(c):o.h=c}function Nh(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Ph.prototype.cancel=function(){if(this.i=Vh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Vh(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(let l of o.g.values())c=c.concat(l.D);return c}return F(o.i)}function Zg(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(h(o)){for(var c=[],l=o.length,f=0;f<l;f++)c.push(o[f]);return c}c=[],l=0;for(f in o)c[l++]=o[f];return c}function e_(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(h(o)||typeof o=="string"){var c=[];o=o.length;for(var l=0;l<o;l++)c.push(l);return c}c=[],l=0;for(let f in o)c[l++]=f;return c}}}function xh(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(h(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var l=e_(o),f=Zg(o),T=f.length,A=0;A<T;A++)c.call(void 0,f[A],l&&l[A],o)}var Oh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function t_(o,c){if(o){o=o.split("&");for(var l=0;l<o.length;l++){var f=o[l].indexOf("="),T=null;if(0<=f){var A=o[l].substring(0,f);T=o[l].substring(f+1)}else A=o[l];c(A,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Zt(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Zt){this.h=o.h,ji(this,o.j),this.o=o.o,this.g=o.g,qi(this,o.s),this.l=o.l;var c=o.i,l=new Nr;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),Mh(this,l),this.m=o.m}else o&&(c=String(o).match(Oh))?(this.h=!1,ji(this,c[1]||"",!0),this.o=Dr(c[2]||""),this.g=Dr(c[3]||"",!0),qi(this,c[4]),this.l=Dr(c[5]||"",!0),Mh(this,c[6]||"",!0),this.m=Dr(c[7]||"")):(this.h=!1,this.i=new Nr(null,this.h))}Zt.prototype.toString=function(){var o=[],c=this.j;c&&o.push(kr(c,Fh,!0),":");var l=this.g;return(l||c=="file")&&(o.push("//"),(c=this.o)&&o.push(kr(c,Fh,!0),"@"),o.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&o.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&o.push("/"),o.push(kr(l,l.charAt(0)=="/"?i_:r_,!0))),(l=this.i.toString())&&o.push("?",l),(l=this.m)&&o.push("#",kr(l,o_)),o.join("")};function at(o){return new Zt(o)}function ji(o,c,l){o.j=l?Dr(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function qi(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function Mh(o,c,l){c instanceof Nr?(o.i=c,a_(o.i,o.h)):(l||(c=kr(c,s_)),o.i=new Nr(c,o.h))}function ie(o,c,l){o.i.set(c,l)}function $i(o){return ie(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Dr(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function kr(o,c,l){return typeof o=="string"?(o=encodeURI(o).replace(c,n_),l&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function n_(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Fh=/[#\/\?@]/g,r_=/[#\?:]/g,i_=/[#\?]/g,s_=/[#\?@]/g,o_=/#/g;function Nr(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function bt(o){o.g||(o.g=new Map,o.h=0,o.i&&t_(o.i,function(c,l){o.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=Nr.prototype,n.add=function(o,c){bt(this),this.i=null,o=Dn(this,o);var l=this.g.get(o);return l||this.g.set(o,l=[]),l.push(c),this.h+=1,this};function Lh(o,c){bt(o),c=Dn(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function Uh(o,c){return bt(o),c=Dn(o,c),o.g.has(c)}n.forEach=function(o,c){bt(this),this.g.forEach(function(l,f){l.forEach(function(T){o.call(c,T,f,this)},this)},this)},n.na=function(){bt(this);let o=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let T=o[f];for(let A=0;A<T.length;A++)l.push(c[f])}return l},n.V=function(o){bt(this);let c=[];if(typeof o=="string")Uh(this,o)&&(c=c.concat(this.g.get(Dn(this,o))));else{o=Array.from(this.g.values());for(let l=0;l<o.length;l++)c=c.concat(o[l])}return c},n.set=function(o,c){return bt(this),this.i=null,o=Dn(this,o),Uh(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function Bh(o,c,l){Lh(o,c),0<l.length&&(o.i=null,o.g.set(Dn(o,c),F(l)),o.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let A=encodeURIComponent(String(f)),D=this.V(f);for(f=0;f<D.length;f++){var T=A;D[f]!==""&&(T+="="+encodeURIComponent(String(D[f]))),o.push(T)}}return this.i=o.join("&")};function Dn(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function a_(o,c){c&&!o.j&&(bt(o),o.i=null,o.g.forEach(function(l,f){var T=f.toLowerCase();f!=T&&(Lh(this,f),Bh(this,T,l))},o)),o.j=c}function c_(o,c){let l=new Rr;if(u.Image){let f=new Image;f.onload=R(At,l,"TestLoadImage: loaded",!0,c,f),f.onerror=R(At,l,"TestLoadImage: error",!1,c,f),f.onabort=R(At,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=R(At,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else c(!1)}function u_(o,c){let l=new Rr,f=new AbortController,T=setTimeout(()=>{f.abort(),At(l,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:f.signal}).then(A=>{clearTimeout(T),A.ok?At(l,"TestPingServer: ok",!0,c):At(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),At(l,"TestPingServer: error",!1,c)})}function At(o,c,l,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(l)}catch{}}function l_(){this.g=new Wg}function h_(o,c,l){let f=l||"";try{xh(o,function(T,A){let D=T;d(T)&&(D=Xo(T)),c.push(f+A+"="+encodeURIComponent(D))})}catch(T){throw c.push(f+"type="+encodeURIComponent("_badmap")),T}}function Vr(o){this.l=o.Ub||null,this.j=o.eb||!1}N(Vr,Zo),Vr.prototype.g=function(){return new Gi(this.l,this.j)},Vr.prototype.i=function(o){return function(){return o}}({});function Gi(o,c){we.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(Gi,we),n=Gi.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Or(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xr(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Or(this)),this.g&&(this.readyState=3,Or(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;jh(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function jh(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?xr(this):Or(this),this.readyState==3&&jh(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,xr(this))},n.Qa=function(o){this.g&&(this.response=o,xr(this))},n.ga=function(){this.g&&xr(this)};function xr(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Or(o)}n.setRequestHeader=function(o,c){this.u.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,o.push(l[0]+": "+l[1]),l=c.next();return o.join(`\r
`)};function Or(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Gi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function qh(o){let c="";return ee(o,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function ua(o,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=qh(l),typeof o=="string"?l!=null&&encodeURIComponent(String(l)):ie(o,c,l))}function ae(o){we.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(ae,we);var d_=/^https?$/i,f_=["POST","PUT"];n=ae.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():na.g(),this.v=this.o?_h(this.o):_h(na),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(A){$h(this,A);return}if(o=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)l.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let A of f.keys())l.set(A,f.get(A));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(A=>A.toLowerCase()=="content-type"),T=u.FormData&&o instanceof u.FormData,!(0<=Array.prototype.indexOf.call(f_,c,void 0))||f||T||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,D]of l)this.g.setRequestHeader(A,D);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wh(this),this.u=!0,this.g.send(o),this.u=!1}catch(A){$h(this,A)}};function $h(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,Gh(o),zi(o)}function Gh(o){o.A||(o.A=!0,Re(o,"complete"),Re(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Re(this,"complete"),Re(this,"abort"),zi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zi(this,!0)),ae.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?zh(this):this.bb())},n.bb=function(){zh(this)};function zh(o){if(o.h&&typeof a<"u"&&(!o.v[1]||ct(o)!=4||o.Z()!=2)){if(o.u&&ct(o)==4)fh(o.Ea,0,o);else if(Re(o,"readystatechange"),ct(o)==4){o.h=!1;try{let D=o.Z();e:switch(D){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=D===0){var T=String(o.D).match(Oh)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),f=!d_.test(T?T.toLowerCase():"")}l=f}if(l)Re(o,"complete"),Re(o,"success");else{o.m=6;try{var A=2<ct(o)?o.g.statusText:""}catch{A=""}o.l=A+" ["+o.Z()+"]",Gh(o)}}finally{zi(o)}}}}function zi(o,c){if(o.g){Wh(o);let l=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||Re(o,"ready");try{l.onreadystatechange=f}catch{}}}function Wh(o){o.I&&(u.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function ct(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<ct(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),zg(c)}};function Hh(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function p_(o){let c={};o=(o.g&&2<=ct(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(H(o[f]))continue;var l=E(o[f]);let T=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let A=c[T]||[];c[T]=A,A.push(l)}w(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mr(o,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[o]||c}function Kh(o){this.Aa=0,this.i=[],this.j=new Rr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Mr("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Mr("baseRetryDelayMs",5e3,o),this.cb=Mr("retryDelaySeedMs",1e4,o),this.Wa=Mr("forwardChannelMaxRetries",2,o),this.wa=Mr("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Ph(o&&o.concurrentRequestLimit),this.Da=new l_,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Kh.prototype,n.la=8,n.G=1,n.connect=function(o,c,l,f){Pe(0),this.W=o,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=rd(this,null,this.W),Hi(this)};function la(o){if(Qh(o),o.G==3){var c=o.U++,l=at(o.I);if(ie(l,"SID",o.K),ie(l,"RID",c),ie(l,"TYPE","terminate"),Fr(o,l),c=new Tt(o,o.j,c),c.L=2,c.v=$i(at(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=id(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Bi(c)}nd(o)}function Wi(o){o.g&&(da(o),o.g.cancel(),o.g=null)}function Qh(o){Wi(o),o.u&&(u.clearTimeout(o.u),o.u=null),Ki(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&u.clearTimeout(o.s),o.s=null)}function Hi(o){if(!Dh(o.h)&&!o.s){o.s=!0;var c=o.Ga;Ir||ah(),wr||(Ir(),wr=!0),$o.add(c,o),o.B=0}}function m_(o,c){return kh(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Sr(C(o.Ga,o,c),td(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let T=new Tt(this,this.j,o),A=this.o;if(this.S&&(A?(A=m(A),v(A,this.S)):A=this.S),this.m!==null||this.O||(T.H=A,A=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=Yh(this,T,c),l=at(this.I),ie(l,"RID",o),ie(l,"CVER",22),this.D&&ie(l,"X-HTTP-Session-Id",this.D),Fr(this,l),A&&(this.O?c="headers="+encodeURIComponent(String(qh(A)))+"&"+c:this.m&&ua(l,this.m,A)),ca(this.h,T),this.Ua&&ie(l,"TYPE","init"),this.P?(ie(l,"$req",c),ie(l,"SID","null"),T.T=!0,ia(T,l,null)):ia(T,l,c),this.G=2}}else this.G==3&&(o?Jh(this,o):this.i.length==0||Dh(this.h)||Jh(this))};function Jh(o,c){var l;c?l=c.l:l=o.U++;let f=at(o.I);ie(f,"SID",o.K),ie(f,"RID",l),ie(f,"AID",o.T),Fr(o,f),o.m&&o.o&&ua(f,o.m,o.o),l=new Tt(o,o.j,l,o.B+1),o.m===null&&(l.H=o.o),c&&(o.i=c.D.concat(o.i)),c=Yh(o,l,1e3),l.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),ca(o.h,l),ia(l,f,c)}function Fr(o,c){o.H&&ee(o.H,function(l,f){ie(c,f,l)}),o.l&&xh({},function(l,f){ie(c,f,l)})}function Yh(o,c,l){l=Math.min(o.i.length,l);var f=o.l?C(o.l.Na,o.l,o):null;e:{var T=o.i;let A=-1;for(;;){let D=["count="+l];A==-1?0<l?(A=T[0].g,D.push("ofs="+A)):A=0:D.push("ofs="+A);let te=!0;for(let ge=0;ge<l;ge++){let J=T[ge].g,Ee=T[ge].map;if(J-=A,0>J)A=Math.max(0,T[ge].g-100),te=!1;else try{h_(Ee,D,"req"+J+"_")}catch{f&&f(Ee)}}if(te){f=D.join("&");break e}}}return o=o.i.splice(0,l),c.D=o,f}function Xh(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;Ir||ah(),wr||(Ir(),wr=!0),$o.add(c,o),o.v=0}}function ha(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Sr(C(o.Fa,o),td(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,Zh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Sr(C(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Pe(10),Wi(this),Zh(this))};function da(o){o.A!=null&&(u.clearTimeout(o.A),o.A=null)}function Zh(o){o.g=new Tt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=at(o.qa);ie(c,"RID","rpc"),ie(c,"SID",o.K),ie(c,"AID",o.T),ie(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&ie(c,"TO",o.ja),ie(c,"TYPE","xmlhttp"),Fr(o,c),o.m&&o.o&&ua(c,o.m,o.o),o.L&&(o.g.I=o.L);var l=o.g;o=o.ia,l.L=1,l.v=$i(at(c)),l.m=null,l.P=!0,Ch(l,o)}n.Za=function(){this.C!=null&&(this.C=null,Wi(this),ha(this),Pe(19))};function Ki(o){o.C!=null&&(u.clearTimeout(o.C),o.C=null)}function ed(o,c){var l=null;if(o.g==c){Ki(o),da(o),o.g=null;var f=2}else if(aa(o.h,c))l=c.D,Nh(o.h,c),f=1;else return;if(o.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var T=o.B;f=Fi(),Re(f,new Eh(f,l)),Hi(o)}else Xh(o);else if(T=c.s,T==3||T==0&&0<c.X||!(f==1&&m_(o,c)||f==2&&ha(o)))switch(l&&0<l.length&&(c=o.h,c.i=c.i.concat(l)),T){case 1:en(o,5);break;case 4:en(o,10);break;case 3:en(o,6);break;default:en(o,2)}}}function td(o,c){let l=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(l*=2),l*c}function en(o,c){if(o.j.info("Error code "+c),c==2){var l=C(o.fb,o),f=o.Xa;let T=!f;f=new Zt(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||ji(f,"https"),$i(f),T?c_(f.toString(),l):u_(f.toString(),l)}else Pe(2);o.G=0,o.l&&o.l.sa(c),nd(o),Qh(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Pe(2)):(this.j.info("Failed to ping google.com"),Pe(1))};function nd(o){if(o.G=0,o.ka=[],o.l){let c=Vh(o.h);(c.length!=0||o.i.length!=0)&&(k(o.ka,c),k(o.ka,o.i),o.h.i.length=0,F(o.i),o.i.length=0),o.l.ra()}}function rd(o,c,l){var f=l instanceof Zt?at(l):new Zt(l);if(f.g!="")c&&(f.g=c+"."+f.g),qi(f,f.s);else{var T=u.location;f=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;var A=new Zt(null);f&&ji(A,f),c&&(A.g=c),T&&qi(A,T),l&&(A.l=l),f=A}return l=o.D,c=o.ya,l&&c&&ie(f,l,c),ie(f,"VER",o.la),Fr(o,f),f}function id(o,c,l){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new ae(new Vr({eb:l})):new ae(o.pa),c.Ha(o.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function sd(){}n=sd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Qi(){}Qi.prototype.g=function(o,c){return new Ne(o,c)};function Ne(o,c){we.call(this),this.g=new Kh(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!H(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!H(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new kn(this)}N(Ne,we),Ne.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ne.prototype.close=function(){la(this.g)},Ne.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var l={};l.__data__=o,o=l}else this.u&&(l={},l.__data__=Xo(o),o=l);c.i.push(new Xg(c.Ya++,o)),c.G==3&&Hi(c)},Ne.prototype.N=function(){this.g.l=null,delete this.j,la(this.g),delete this.g,Ne.aa.N.call(this)};function od(o){ea.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(let l in c){o=l;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}N(od,ea);function ad(){ta.call(this),this.status=1}N(ad,ta);function kn(o){this.g=o}N(kn,sd),kn.prototype.ua=function(){Re(this.g,"a")},kn.prototype.ta=function(o){Re(this.g,new od(o))},kn.prototype.sa=function(o){Re(this.g,new ad)},kn.prototype.ra=function(){Re(this.g,"b")},Qi.prototype.createWebChannel=Qi.prototype.g,Ne.prototype.send=Ne.prototype.o,Ne.prototype.open=Ne.prototype.m,Ne.prototype.close=Ne.prototype.close,Jc=gt.createWebChannelTransport=function(){return new Qi},Qc=gt.getStatEventTarget=function(){return Fi()},Kc=gt.Event=Yt,$s=gt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Li.NO_ERROR=0,Li.TIMEOUT=8,Li.HTTP_ERROR=6,ci=gt.ErrorCode=Li,Th.COMPLETE="complete",Hc=gt.EventType=Th,yh.EventType=Ar,Ar.OPEN="a",Ar.CLOSE="b",Ar.ERROR="c",Ar.MESSAGE="d",we.prototype.listen=we.prototype.K,Jn=gt.WebChannel=yh,Wc=gt.FetchXmlHttpFactory=Vr,ae.prototype.listenOnce=ae.prototype.L,ae.prototype.getLastError=ae.prototype.Ka,ae.prototype.getLastErrorCode=ae.prototype.Ba,ae.prototype.getStatus=ae.prototype.Z,ae.prototype.getResponseJson=ae.prototype.Oa,ae.prototype.getResponseText=ae.prototype.oa,ae.prototype.send=ae.prototype.ea,ae.prototype.setWithCredentials=ae.prototype.Ha,zc=gt.XhrIo=ae}).apply(typeof qs<"u"?qs:typeof self<"u"?self:typeof window<"u"?window:{});var kp="@firebase/firestore";var me=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};me.UNAUTHENTICATED=new me(null),me.GOOGLE_CREDENTIALS=new me("google-credentials-uid"),me.FIRST_PARTY=new me("first-party-uid"),me.MOCK_USER=new me("mock-user");var mr="10.13.1";var vn=new Ot("@firebase/firestore");function ui(){return vn.logLevel}function M(n,...e){if(vn.logLevel<=z.DEBUG){let t=e.map(Ml);vn.debug(`Firestore (${mr}): ${n}`,...t)}}function yt(n,...e){if(vn.logLevel<=z.ERROR){let t=e.map(Ml);vn.error(`Firestore (${mr}): ${n}`,...t)}}function rr(n,...e){if(vn.logLevel<=z.WARN){let t=e.map(Ml);vn.warn(`Firestore (${mr}): ${n}`,...t)}}function Ml(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function B(n="Unexpected state"){let e=`FIRESTORE (${mr}) INTERNAL ASSERTION FAILED: `+n;throw yt(e),new Error(e)}function ne(n,e){n||B()}function j(n,e){return n}var S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},V=class extends xe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var _t=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Ks=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},tu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(me.UNAUTHENTICATED))}shutdown(){}},nu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},ru=class{constructor(e){this.t=e,this.currentUser=me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),s=new _t;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new _t,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=s;e.enqueueRetryable(()=>y(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new _t)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ne(typeof r.accessToken=="string"),new Ks(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ne(e===null||typeof e=="string"),new me(e)}},iu=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=me.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},su=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new iu(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(me.FIRST_PARTY))}shutdown(){}invalidateToken(){}},ou=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},au=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ne(typeof t.token=="string"),this.R=t.token,new ou(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function Qw(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Qs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Qw(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function Y(n,e){return n<e?-1:n>e?1:0}function ir(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var ve=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new V(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var $=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ve(0,0))}static max(){return new n(new ve(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Js=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(),r===void 0?r=e.length-t:r>e.length-t&&B(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},oe=class n extends Js{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new V(S.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},Jw=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Me=class n extends Js{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return Jw.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new V(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new V(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new V(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new V(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(oe.fromString(e))}static fromName(e){return new n(oe.fromString(e).popFirst(5))}static empty(){return new n(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new oe(e.slice()))}};var cu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};cu.UNKNOWN_ID=-1;function Yw(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=$.fromTimestamp(r===1e9?new ve(t+1,0):new ve(t,r));return new In(i,L.empty(),e)}function Xw(n){return new In(n.readTime,n.key,-1)}var In=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n($.min(),L.empty(),-1)}static max(){return new n($.max(),L.empty(),-1)}};function Zw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:Y(n.largestBatchId,e.largestBatchId))}var eE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",uu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ri(n){return y(this,null,function*(){if(n.code!==S.FAILED_PRECONDITION||n.message!==eE)throw n;M("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&t()},h=>r(h))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),u=0;for(let h=0;h<s;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function tE(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Pi(n){return n.name==="IndexedDbTransactionError"}var dm=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function So(n){return n==null}function gi(n){return n===0&&1/n==-1/0}function nE(n){return typeof n=="number"&&Number.isInteger(n)&&!gi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var rE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],vA=[...rE,"documentOverlays"],iE=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],sE=iE,oE=[...sE,"indexConfiguration","indexState","indexEntries"];var IA=[...oE,"globals"];function Np(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function gr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function fm(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ce=class n{constructor(e,t){this.comparator=e,this.root=t||nt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,nt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new er(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new er(this.root,e,this.comparator,!1)}getReverseIterator(){return new er(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new er(this.root,e,this.comparator,!0)}},er=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},nt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();let e=this.left.check();if(e!==this.right.check())throw B();return e+(this.isRed()?0:1)}};nt.EMPTY=null,nt.RED=!0,nt.BLACK=!1;nt.EMPTY=new class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(e,t,r,i,s){return this}insert(e,t,r){return new nt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ae=class n{constructor(e){this.comparator=e,this.data=new ce(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ys(this.data.getIterator())}getIteratorFrom(e){return new Ys(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Ys=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var tt=class n{constructor(e){this.fields=e,e.sort(Me.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ae(Me.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ir(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Xs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ce=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Xs("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ce.EMPTY_BYTE_STRING=new Ce("");var aE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vt(n){if(ne(!!n),typeof n=="string"){let e=0,t=aE.exec(n);if(ne(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:se(n.seconds),nanos:se(n.nanos)}}function se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Wt(n){return typeof n=="string"?Ce.fromBase64String(n):Ce.fromUint8Array(n)}function Fl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ll(n){let e=n.mapValue.fields.__previous_value__;return Fl(e)?Ll(e):e}function _i(n){let e=vt(n.mapValue.fields.__local_write_time__.timestampValue);return new ve(e.seconds,e.nanos)}var lu=class{constructor(e,t,r,i,s,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d}},Zs=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Gs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function wn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fl(n)?4:mm(n)?9007199254740991:pm(n)?10:11:B()}function st(n,e){if(n===e)return!0;let t=wn(n);if(t!==wn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return _i(n).isEqual(_i(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=vt(i.timestampValue),u=vt(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Wt(i.bytesValue).isEqual(Wt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return se(i.geoPointValue.latitude)===se(s.geoPointValue.latitude)&&se(i.geoPointValue.longitude)===se(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return se(i.integerValue)===se(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=se(i.doubleValue),u=se(s.doubleValue);return a===u?gi(a)===gi(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return ir(n.arrayValue.values||[],e.arrayValue.values||[],st);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(Np(a)!==Np(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!st(a[h],u[h])))return!1;return!0}(n,e);default:return B()}}function yi(n,e){return(n.values||[]).find(t=>st(t,e))!==void 0}function sr(n,e){if(n===e)return 0;let t=wn(n),r=wn(e);if(t!==r)return Y(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Y(n.booleanValue,e.booleanValue);case 2:return function(s,a){let u=se(s.integerValue||s.doubleValue),h=se(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return Vp(n.timestampValue,e.timestampValue);case 4:return Vp(_i(n),_i(e));case 5:return Y(n.stringValue,e.stringValue);case 6:return function(s,a){let u=Wt(s),h=Wt(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let u=s.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=Y(u[d],h[d]);if(p!==0)return p}return Y(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let u=Y(se(s.latitude),se(a.latitude));return u!==0?u:Y(se(s.longitude),se(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return xp(n.arrayValue,e.arrayValue);case 10:return function(s,a){var u,h,d,p;let I=s.fields||{},C=a.fields||{},R=(u=I.value)===null||u===void 0?void 0:u.arrayValue,N=(h=C.value)===null||h===void 0?void 0:h.arrayValue,F=Y(((d=R?.values)===null||d===void 0?void 0:d.length)||0,((p=N?.values)===null||p===void 0?void 0:p.length)||0);return F!==0?F:xp(R,N)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===Gs.mapValue&&a===Gs.mapValue)return 0;if(s===Gs.mapValue)return 1;if(a===Gs.mapValue)return-1;let u=s.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let I=0;I<h.length&&I<p.length;++I){let C=Y(h[I],p[I]);if(C!==0)return C;let R=sr(u[h[I]],d[p[I]]);if(R!==0)return R}return Y(h.length,p.length)}(n.mapValue,e.mapValue);default:throw B()}}function Vp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Y(n,e);let t=vt(n),r=vt(e),i=Y(t.seconds,r.seconds);return i!==0?i:Y(t.nanos,r.nanos)}function xp(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=sr(t[i],r[i]);if(s)return s}return Y(t.length,r.length)}function or(n){return hu(n)}function hu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=vt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Wt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return L.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=hu(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${hu(t.fields[a])}`;return i+"}"}(n.mapValue):B()}function Op(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function du(n){return!!n&&"integerValue"in n}function Ul(n){return!!n&&"arrayValue"in n}function Mp(n){return!!n&&"nullValue"in n}function Fp(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ws(n){return!!n&&"mapValue"in n}function pm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function hi(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return gr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=hi(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hi(n.arrayValue.values[t]);return e}return Object.assign({},n)}function mm(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var He=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ws(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hi(t)}setAll(e){let t=Me.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=hi(a):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Ws(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return st(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ws(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){gr(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(hi(this.value))}};function gm(n){let e=[];return gr(n.fields,(t,r)=>{let i=new Me([t]);if(Ws(r)){let s=gm(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new tt(e)}var Ke=class n{constructor(e,t,r,i,s,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,$.min(),$.min(),$.min(),He.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,$.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,$.min(),$.min(),He.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,$.min(),$.min(),He.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=He.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=He.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ar=class{constructor(e,t){this.position=e,this.inclusive=t}};function Lp(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),t.key):r=sr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Up(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!st(n.position[t],e.position[t]))return!1;return!0}var En=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function cE(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var eo=class{},he=class n extends eo{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new pu(e,t,r):t==="array-contains"?new _u(e,r):t==="in"?new yu(e,r):t==="not-in"?new vu(e,r):t==="array-contains-any"?new Iu(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new mu(e,r):new gu(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(sr(t,this.value)):t!==null&&wn(this.value)===wn(t)&&this.matchesComparison(sr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Qe=class n extends eo{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return _m(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function _m(n){return n.op==="and"}function ym(n){return uE(n)&&_m(n)}function uE(n){for(let e of n.filters)if(e instanceof Qe)return!1;return!0}function fu(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+or(n.value);if(ym(n))return n.filters.map(e=>fu(e)).join(",");{let e=n.filters.map(t=>fu(t)).join(",");return`${n.op}(${e})`}}function vm(n,e){return n instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&st(r.value,i.value)}(n,e):n instanceof Qe?function(r,i){return i instanceof Qe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&vm(a,i.filters[u]),!0):!1}(n,e):void B()}function Im(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${or(t.value)}`}(n):n instanceof Qe?function(t){return t.op.toString()+" {"+t.getFilters().map(Im).join(" ,")+"}"}(n):"Filter"}var pu=class extends he{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},mu=class extends he{constructor(e,t){super(e,"in",t),this.keys=wm("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},gu=class extends he{constructor(e,t){super(e,"not-in",t),this.keys=wm("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function wm(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var _u=class extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ul(t)&&yi(t.arrayValue,this.value)}},yu=class extends he{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&yi(this.value.arrayValue,t)}},vu=class extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(yi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!yi(this.value.arrayValue,t)}},Iu=class extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ul(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>yi(this.value.arrayValue,r))}};var wu=class{constructor(e,t=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.ue=null}};function Bp(n,e=null,t=[],r=[],i=null,s=null,a=null){return new wu(n,e,t,r,i,s,a)}function Bl(n){let e=j(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>fu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),So(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>or(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>or(r)).join(",")),e.ue=t}return e.ue}function jl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!cE(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!vm(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Up(n.startAt,e.startAt)&&Up(n.endAt,e.endAt)}function Eu(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Ht=class{constructor(e,t=null,r=[],i=[],s=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function lE(n,e,t,r,i,s,a,u){return new Ht(n,e,t,r,i,s,a,u)}function ql(n){return new Ht(n)}function jp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Em(n){return n.collectionGroup!==null}function di(n){let e=j(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Ae(Me.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new En(s,r))}),t.has(Me.keyField().canonicalString())||e.ce.push(new En(Me.keyField(),r))}return e.ce}function rt(n){let e=j(n);return e.le||(e.le=hE(e,di(n))),e.le}function hE(n,e){if(n.limitType==="F")return Bp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new En(i.field,s)});let t=n.endAt?new ar(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ar(n.startAt.position,n.startAt.inclusive):null;return Bp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Tu(n,e){let t=n.filters.concat([e]);return new Ht(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function bu(n,e,t){return new Ht(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ro(n,e){return jl(rt(n),rt(e))&&n.limitType===e.limitType}function Tm(n){return`${Bl(rt(n))}|lt:${n.limitType}`}function Yn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Im(i)).join(", ")}]`),So(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>or(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>or(i)).join(",")),`Target(${r})`}(rt(n))}; limitType=${n.limitType})`}function Po(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):L.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of di(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=Lp(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,di(r),i)||r.endAt&&!function(a,u,h){let d=Lp(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,di(r),i))}(n,e)}function dE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function bm(n){return(e,t)=>{let r=!1;for(let i of di(n)){let s=fE(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function fE(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):function(s,a,u){let h=a.data.field(s),d=u.data.field(s);return h!==null&&d!==null?sr(h,d):B()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B()}}var Kt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){gr(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return fm(this.inner)}size(){return this.innerSize}};var pE=new ce(L.comparator);function It(){return pE}var Am=new ce(L.comparator);function li(...n){let e=Am;for(let t of n)e=e.insert(t.key,t);return e}function Cm(n){let e=Am;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function mn(){return fi()}function Sm(){return fi()}function fi(){return new Kt(n=>n.toString(),(n,e)=>n.isEqual(e))}var mE=new ce(L.comparator),gE=new Ae(L.comparator);function W(...n){let e=gE;for(let t of n)e=e.add(t);return e}var _E=new Ae(Y);function yE(){return _E}function $l(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function Rm(n){return{integerValue:""+n}}function vE(n,e){return nE(e)?Rm(e):$l(n,e)}var cr=class{constructor(){this._=void 0}};function IE(n,e,t){return n instanceof ur?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Fl(s)&&(s=Ll(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof Tn?Dm(n,e):n instanceof bn?km(n,e):function(i,s){let a=Pm(i,s),u=qp(a)+qp(i.Pe);return du(a)&&du(i.Pe)?Rm(u):$l(i.serializer,u)}(n,e)}function wE(n,e,t){return n instanceof Tn?Dm(n,e):n instanceof bn?km(n,e):t}function Pm(n,e){return n instanceof lr?function(r){return du(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var ur=class extends cr{},Tn=class extends cr{constructor(e){super(),this.elements=e}};function Dm(n,e){let t=Nm(e);for(let r of n.elements)t.some(i=>st(i,r))||t.push(r);return{arrayValue:{values:t}}}var bn=class extends cr{constructor(e){super(),this.elements=e}};function km(n,e){let t=Nm(e);for(let r of n.elements)t=t.filter(i=>!st(i,r));return{arrayValue:{values:t}}}var lr=class extends cr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function qp(n){return se(n.integerValue||n.doubleValue)}function Nm(n){return Ul(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function EE(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Tn&&i instanceof Tn||r instanceof bn&&i instanceof bn?ir(r.elements,i.elements,st):r instanceof lr&&i instanceof lr?st(r.Pe,i.Pe):r instanceof ur&&i instanceof ur}(n.transform,e.transform)}var Au=class{constructor(e,t){this.version=e,this.transformResults=t}},yn=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Hs(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var hr=class{};function Vm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new to(n.key,yn.none()):new An(n.key,n.data,yn.none());{let t=n.data,r=He.empty(),i=new Ae(Me.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new wt(n.key,r,new tt(i.toArray()),yn.none())}}function TE(n,e,t){n instanceof An?function(i,s,a){let u=i.value.clone(),h=Gp(i.fieldTransforms,s,a.transformResults);u.setAll(h),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof wt?function(i,s,a){if(!Hs(i.precondition,s))return void s.convertToUnknownDocument(a.version);let u=Gp(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(xm(i)),h.setAll(u),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function pi(n,e,t,r){return n instanceof An?function(s,a,u,h){if(!Hs(s.precondition,a))return u;let d=s.value.clone(),p=zp(s.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof wt?function(s,a,u,h){if(!Hs(s.precondition,a))return u;let d=zp(s.fieldTransforms,h,a),p=a.data;return p.setAll(xm(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(I=>I.field))}(n,e,t,r):function(s,a,u){return Hs(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function bE(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Pm(r.transform,i||null);s!=null&&(t===null&&(t=He.empty()),t.set(r.field,s))}return t||null}function $p(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ir(r,i,(s,a)=>EE(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var An=class extends hr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},wt=class extends hr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function xm(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Gp(n,e,t){let r=new Map;ne(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,wE(a,u,t[i]))}return r}function zp(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,IE(s,a,e))}return r}var to=class extends hr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Cu=class extends hr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Su=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&TE(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=pi(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=pi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Sm();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,u=this.applyToLocalView(a,s.mutatedFields);u=t.has(i.key)?null:u;let h=Vm(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument($.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),W())}isEqual(e){return this.batchId===e.batchId&&ir(this.mutations,e.mutations,(t,r)=>$p(t,r))&&ir(this.baseMutations,e.baseMutations,(t,r)=>$p(t,r))}},Ru=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ne(e.mutations.length===r.length);let i=function(){return mE}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var Pu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Du=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ue,Q;function AE(n){switch(n){default:return B();case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0}}function Om(n){if(n===void 0)return yt("GRPC error has no .code"),S.UNKNOWN;switch(n){case ue.OK:return S.OK;case ue.CANCELLED:return S.CANCELLED;case ue.UNKNOWN:return S.UNKNOWN;case ue.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case ue.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case ue.INTERNAL:return S.INTERNAL;case ue.UNAVAILABLE:return S.UNAVAILABLE;case ue.UNAUTHENTICATED:return S.UNAUTHENTICATED;case ue.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case ue.NOT_FOUND:return S.NOT_FOUND;case ue.ALREADY_EXISTS:return S.ALREADY_EXISTS;case ue.PERMISSION_DENIED:return S.PERMISSION_DENIED;case ue.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case ue.ABORTED:return S.ABORTED;case ue.OUT_OF_RANGE:return S.OUT_OF_RANGE;case ue.UNIMPLEMENTED:return S.UNIMPLEMENTED;case ue.DATA_LOSS:return S.DATA_LOSS;default:return B()}}(Q=ue||(ue={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";var Wp=null;function CE(){return new TextEncoder}var SE=new Gt([4294967295,4294967295],0);function Hp(n){let e=CE().encode(n),t=new Gc;return t.update(e),new Uint8Array(t.digest())}function Kp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Gt([t,r],0),new Gt([i,s],0)]}var ku=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new gn(`Invalid padding: ${t}`);if(r<0)throw new gn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new gn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new gn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Gt.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Gt.fromNumber(r)));return i.compare(SE)===1&&(i=new Gt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Hp(e),[r,i]=Kp(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=Hp(e),[r,i]=Kp(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},gn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var no=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,vi.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n($.min(),i,new ce(Y),It(),W())}},vi=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,W(),W(),W())}};var tr=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},ro=class{constructor(e,t){this.targetId=e,this.me=t}},io=class{constructor(e,t,r=Ce.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},so=class{constructor(){this.fe=0,this.ge=Jp(),this.pe=Ce.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=W(),t=W(),r=W();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:B()}}),new vi(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Jp()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ne(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Nu=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=It(),this.qe=Qp(),this.Qe=new ce(Y)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:B()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Eu(s))if(r===0){let a=new L(s.path);this.Ue(t,a,Ke.newNoDocument(a,$.min()))}else ne(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),h=u?this.Xe(u,e,a):1;if(h!==0){this.je(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}Wp?.et(function(p,I,C,R,N){var F,k,G,H,K,re;let Se={localCacheCount:p,existenceFilterCount:I.count,databaseId:C.database,projectId:C.projectId},ee=I.unchangedNames;return ee&&(Se.bloomFilter={applied:N===0,hashCount:(F=ee?.hashCount)!==null&&F!==void 0?F:0,bitmapLength:(H=(G=(k=ee?.bits)===null||k===void 0?void 0:k.bitmap)===null||G===void 0?void 0:G.length)!==null&&H!==void 0?H:0,padding:(re=(K=ee?.bits)===null||K===void 0?void 0:K.padding)!==null&&re!==void 0?re:0,mightContain:w=>{var m;return(m=R?.mightContain(w))!==null&&m!==void 0&&m}}),Se}(a,e.me,this.Le.tt(),u,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,u;try{a=Wt(r).toUint8Array()}catch(h){if(h instanceof Xs)return rr("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new ku(a,i,s)}catch(h){return rr(h instanceof gn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let u=this.Je(a);if(u){if(s.current&&Eu(u.target)){let h=new L(u.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,Ke.newNoDocument(h,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let r=W();this.qe.forEach((s,a)=>{let u=!0;a.forEachWhile(h=>{let d=this.Je(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let i=new no(e,t,this.Qe,this.ke,r);return this.ke=It(),this.qe=Qp(),this.Qe=new ce(Y),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new so,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ae(Y),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new so),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Qp(){return new ce(L.comparator)}function Jp(){return new ce(L.comparator)}var RE={asc:"ASCENDING",desc:"DESCENDING"},PE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},DE={and:"AND",or:"OR"},Vu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function xu(n,e){return n.useProto3Json||So(e)?e:{value:e}}function oo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mm(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function kE(n,e){return oo(n,e.toTimestamp())}function it(n){return ne(!!n),$.fromTimestamp(function(t){let r=vt(t);return new ve(r.seconds,r.nanos)}(n))}function Gl(n,e){return Ou(n,e).canonicalString()}function Ou(n,e){let t=function(i){return new oe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Fm(n){let e=oe.fromString(n);return ne(qm(e)),e}function Mu(n,e){return Gl(n.databaseId,e.path)}function Yc(n,e){let t=Fm(e);if(t.get(1)!==n.databaseId.projectId)throw new V(S.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new V(S.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(Um(t))}function Lm(n,e){return Gl(n.databaseId,e)}function NE(n){let e=Fm(n);return e.length===4?oe.emptyPath():Um(e)}function Fu(n){return new oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Um(n){return ne(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Yp(n,e,t){return{name:Mu(n,e),fields:t.value.mapValue.fields}}function VE(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:B()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(ne(p===void 0||typeof p=="string"),Ce.fromBase64String(p||"")):(ne(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Ce.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?S.UNKNOWN:Om(d.code);return new V(p,d.message||"")}(a);t=new io(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Yc(n,r.document.name),s=it(r.document.updateTime),a=r.document.createTime?it(r.document.createTime):$.min(),u=new He({mapValue:{fields:r.document.fields}}),h=Ke.newFoundDocument(i,s,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new tr(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Yc(n,r.document),s=r.readTime?it(r.readTime):$.min(),a=Ke.newNoDocument(i,s),u=r.removedTargetIds||[];t=new tr([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Yc(n,r.document),s=r.removedTargetIds||[];t=new tr([],s,i,null)}else{if(!("filter"in e))return B();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new Du(i,s),u=r.targetId;t=new ro(u,a)}}return t}function xE(n,e){let t;if(e instanceof An)t={update:Yp(n,e.key,e.value)};else if(e instanceof to)t={delete:Mu(n,e.key)};else if(e instanceof wt)t={update:Yp(n,e.key,e.data),updateMask:$E(e.fieldMask)};else{if(!(e instanceof Cu))return B();t={verify:Mu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let u=a.transform;if(u instanceof ur)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Tn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof bn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof lr)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw B()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:kE(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:B()}(n,e.precondition)),t}function OE(n,e){return n&&n.length>0?(ne(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?it(i.updateTime):it(s);return a.isEqual($.min())&&(a=it(s)),new Au(a,i.transformResults||[])}(t,e))):[]}function ME(n,e){return{documents:[Lm(n,e.path)]}}function FE(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Lm(n,i);let s=function(d){if(d.length!==0)return jm(Qe.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(p=>function(C){return{field:Xn(C.field),direction:BE(C.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=xu(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function LE(n){let e=NE(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ne(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(I){let C=Bm(I);return C instanceof Qe&&ym(C)?C.getFilters():[C]}(t.where));let a=[];t.orderBy&&(a=function(I){return I.map(C=>function(N){return new En(Zn(N.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(C))}(t.orderBy));let u=null;t.limit&&(u=function(I){let C;return C=typeof I=="object"?I.value:I,So(C)?null:C}(t.limit));let h=null;t.startAt&&(h=function(I){let C=!!I.before,R=I.values||[];return new ar(R,C)}(t.startAt));let d=null;return t.endAt&&(d=function(I){let C=!I.before,R=I.values||[];return new ar(R,C)}(t.endAt)),lE(e,i,a,s,u,"F",h,d)}function UE(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Bm(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Zn(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Zn(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Zn(t.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Zn(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});default:return B()}}(n):n.fieldFilter!==void 0?function(t){return he.create(Zn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return B()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Qe.create(t.compositeFilter.filters.map(r=>Bm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B()}}(t.compositeFilter.op))}(n):B()}function BE(n){return RE[n]}function jE(n){return PE[n]}function qE(n){return DE[n]}function Xn(n){return{fieldPath:n.canonicalString()}}function Zn(n){return Me.fromServerFormat(n.fieldPath)}function jm(n){return n instanceof he?function(t){if(t.op==="=="){if(Fp(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NAN"}};if(Mp(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Fp(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NOT_NAN"}};if(Mp(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xn(t.field),op:jE(t.op),value:t.value}}}(n):n instanceof Qe?function(t){let r=t.getFilters().map(i=>jm(i));return r.length===1?r[0]:{compositeFilter:{op:qE(t.op),filters:r}}}(n):B()}function $E(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function qm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ii=class n{constructor(e,t,r,i,s=$.min(),a=$.min(),u=Ce.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Lu=class{constructor(e){this.ct=e}};function GE(n){let e=LE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?bu(e,e.limit,"L"):e}var ao=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(se(e.integerValue));else if("doubleValue"in e){let r=se(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),gi(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=vt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Wt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?mm(e)?this.dt(t,Number.MAX_SAFE_INTEGER):pm(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):B()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(se(u)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),L.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};ao.vt=new ao;var Uu=class{constructor(){this.un=new Bu}addToCollectionParentIndex(e,t){return this.un.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(In.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(In.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Bu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ae(oe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ae(oe.comparator)).toArray()}};var EA=new Uint8Array(0);var et=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};et.DEFAULT_COLLECTION_PERCENTILE=10,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,et.DEFAULT=new et(41943040,et.DEFAULT_COLLECTION_PERCENTILE,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),et.DISABLED=new et(-1,0,0);var wi=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var ju=class{constructor(){this.changes=new Kt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ke.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var qu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var $u=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&pi(r.mutation,i,tt.empty(),ve.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,W()).next(()=>r))}getLocalViewOfDocuments(e,t,r=W()){let i=mn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=li();return s.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=mn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,W()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let s=It(),a=fi(),u=function(){return fi()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof wt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),pi(p.mutation,d,p.mutation.getFieldMask(),ve.now())):a.set(d.key,tt.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var I;return u.set(d,new qu(p,(I=a.get(d))!==null&&I!==void 0?I:null))}),u))}recalculateAndSaveOverlays(e,t){let r=fi(),i=new ce((a,u)=>a-u),s=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||tt.empty();p=u.applyToLocalView(d,p),r.set(h,p);let I=(i.get(u.batchId)||W()).add(h);i=i.insert(u.batchId,I)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,I=Sm();p.forEach(C=>{if(!s.has(C)){let R=Vm(t.get(C),r.get(C));R!==null&&I.set(C,R),s=s.add(C)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,I))}return P.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Em(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(mn()),u=-1,h=s;return a.next(d=>P.forEach(d,(p,I)=>(u<I.largestBatchId&&(u=I.largestBatchId),s.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(C=>{h=h.insert(p,C)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,h,d,W())).next(p=>({batchId:u,changes:Cm(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let i=li();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=li();return this.indexManager.getCollectionParents(e,s).next(u=>P.forEach(u,h=>{let d=function(I,C){return new Ht(C,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)}(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((I,C)=>{a=a.insert(I,C)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,Ke.newInvalidDocument(p)))});let u=li();return a.forEach((h,d)=>{let p=s.get(h);p!==void 0&&pi(p.mutation,d,tt.empty(),ve.now()),Po(t,d)&&(u=u.insert(h,d))}),u})}};var Gu=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return P.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:it(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:GE(i.bundledQuery),readTime:it(i.readTime)}}(t)),P.resolve()}};var zu=class{constructor(){this.overlays=new ce(L.comparator),this.Ir=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=mn();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=mn(),s=t.length+1,a=new L(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ce((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=mn(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=mn(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return P.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Pu(t,r));let s=this.Ir.get(t);s===void 0&&(s=W(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var Wu=class{constructor(){this.sessionToken=Ce.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var Ei=class{constructor(){this.Tr=new Ae(le.Er),this.dr=new Ae(le.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new le(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new le(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new L(new oe([])),r=new le(t,e),i=new le(t,e+1),s=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new L(new oe([])),r=new le(t,e),i=new le(t,e+1),s=W();return this.dr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new le(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},le=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return L.comparator(e.key,t.key)||Y(e.wr,t.wr)}static Ar(e,t){return Y(e.wr,t.wr)||L.comparator(e.key,t.key)}};var Hu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ae(le.Er)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Su(s,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new le(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new le(t,0),i=new le(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);s.push(u)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ae(Y);return t.forEach(i=>{let s=new le(i,0),a=new le(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],u=>{r=r.add(u.wr)})}),P.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;L.isDocumentKey(s)||(s=s.child(""));let a=new le(new L(s),0),u=new Ae(Y);return this.br.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.wr)),!0)},a),P.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ne(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return P.forEach(t.mutations,i=>{let s=new le(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new le(t,0),i=this.br.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ku=class{constructor(e){this.Mr=e,this.docs=function(){return new ce(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Ke.newInvalidDocument(t))}getEntries(e,t){let r=It();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ke.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=It(),a=t.path,u=new L(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||Zw(Xw(p),r)<=0||(i.has(p.key)||Po(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){B()}Or(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Qu(this)}getSize(e){return P.resolve(this.size)}},Qu=class extends ju{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Ju=class{constructor(e){this.persistence=e,this.Nr=new Kt(t=>Bl(t),jl),this.lastRemoteSnapshotVersion=$.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ei,this.targetCount=0,this.kr=wi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),P.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new wi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.Kn(t),P.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Br.containsKey(t))}};var Yu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new dm(0),this.Kr=!1,this.Kr=!0,this.$r=new Wu,this.referenceDelegate=e(this),this.Ur=new Ju(this),this.indexManager=new Uu,this.remoteDocumentCache=function(i){return new Ku(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Lu(t),this.Gr=new Gu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new zu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Hu(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);let i=new Xu(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return P.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Xu=class extends uu{constructor(e){super(),this.currentSequenceNumber=e}},Zu=class n{constructor(e){this.persistence=e,this.Jr=new Ei,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw B()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),P.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Xr,r=>{let i=L.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,$.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return P.or([()=>P.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var el=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=W(),i=W();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var tl=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var nl=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return $d()?8:tE(pe())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new tl;return this.Xi(e,t,a).next(u=>{if(s.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(ui()<=z.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",Yn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),P.resolve()):(ui()<=z.DEBUG&&M("QueryEngine","Query:",Yn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(ui()<=z.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",Yn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rt(t))):P.resolve())}Yi(e,t){if(jp(t))return P.resolve(null);let r=rt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=bu(t,null,"F"),r=rt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=W(...s);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ts(t,u);return this.ns(t,d,a,h.readTime)?this.Yi(e,bu(t,null,"F")):this.rs(e,d,t,h)}))})))}Zi(e,t,r,i){return jp(t)||i.isEqual($.min())?P.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let a=this.ts(t,s);return this.ns(t,a,r,i)?P.resolve(null):(ui()<=z.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Yn(t)),this.rs(e,a,t,Yw(i,-1)).next(u=>u))})}ts(e,t){let r=new Ae(bm(e));return t.forEach((i,s)=>{Po(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return ui()<=z.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",Yn(t)),this.Ji.getDocumentsMatchingQuery(e,t,In.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var rl=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ce(Y),this._s=new Kt(s=>Bl(s),jl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $u(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function zE(n,e,t,r){return new rl(n,e,t,r)}function $m(n,e){return y(this,null,function*(){let t=j(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],u=[],h=W();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of s){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function WE(n,e){let t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let I=d.batch,C=I.keys(),R=P.resolve();return C.forEach(N=>{R=R.next(()=>p.getEntry(h,N)).next(F=>{let k=d.docVersions.get(N);ne(k!==null),F.version.compareTo(k)<0&&(I.applyToRemoteDocument(F,d),F.isValidDocument()&&(F.setReadTime(d.commitVersion),p.addEntry(F)))})}),R.next(()=>u.mutationQueue.removeMutationBatch(h,I))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=W();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Gm(n){let e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function HE(n,e){let t=j(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,I)=>{let C=i.get(I);if(!C)return;u.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,I).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,I)));let R=C.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(I)!==null?R=R.withResumeToken(Ce.EMPTY_BYTE_STRING,$.min()).withLastLimboFreeSnapshotVersion($.min()):p.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(p.resumeToken,r)),i=i.insert(I,R),function(F,k,G){return F.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=3e8?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0}(C,R,p)&&u.push(t.Ur.updateTargetData(s,R))});let h=It(),d=W();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(KE(s,a,e.documentUpdates).next(p=>{h=p.Ps,d=p.Is})),!r.isEqual($.min())){let p=t.Ur.getLastRemoteSnapshotVersion(s).next(I=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return P.waitFor(u).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,h,d)).next(()=>h)}).then(s=>(t.os=i,s))}function KE(n,e,t){let r=W(),i=W();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=It();return t.forEach((u,h)=>{let d=s.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual($.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):M("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function QE(n,e){let t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function JE(n,e){let t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new Ii(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function il(n,e,t){return y(this,null,function*(){let r=j(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Pi(a))throw a;M("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Xp(n,e,t){let r=j(n),i=$.min(),s=W();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let I=j(h),C=I._s.get(p);return C!==void 0?P.resolve(I.os.get(C)):I.Ur.getTargetData(d,p)}(r,a,rt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(h=>{s=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:$.min(),t?s:W())).next(u=>(YE(r,dE(e),u),{documents:u,Ts:s})))}function YE(n,e,t){let r=n.us.get(e)||$.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}var co=class{constructor(){this.activeTargetIds=yE()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var sl=class{constructor(){this.so=new co,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new co,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var ol=class{_o(e){}shutdown(){}};var uo=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var zs=null;function Xc(){return zs===null?zs=function(){return 268435456+Math.round(2147483648*Math.random())}():zs++,"0x"+zs.toString(16)}var XE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var al=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var be="WebChannelConnection",cl=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,a){let u=Xc(),h=this.xo(t,r.toUriEncodedString());M("RestConnection",`Sending RPC '${t}' ${u}:`,h,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,a),this.No(t,h,d,i).then(p=>(M("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw rr("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",h,"request:",i),p})}Lo(t,r,i,s,a,u){return this.Mo(t,r,i,s,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,r){let i=XE[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=Xc();return new Promise((a,u)=>{let h=new zc;h.setWithCredentials(!0),h.listenOnce(Hc.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ci.NO_ERROR:let p=h.getResponseJson();M(be,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case ci.TIMEOUT:M(be,`RPC '${e}' ${s} timed out`),u(new V(S.DEADLINE_EXCEEDED,"Request time out"));break;case ci.HTTP_ERROR:let I=h.getStatus();if(M(be,`RPC '${e}' ${s} failed with status:`,I,"response text:",h.getResponseText()),I>0){let C=h.getResponseJson();Array.isArray(C)&&(C=C[0]);let R=C?.error;if(R&&R.status&&R.message){let N=function(k){let G=k.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(G)>=0?G:S.UNKNOWN}(R.status);u(new V(N,R.message))}else u(new V(S.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new V(S.UNAVAILABLE,"Connection failed."));break;default:B()}}finally{M(be,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);M(be,`RPC '${e}' ${s} sending request:`,i),h.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=Xc(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Jc(),u=Qc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.xmlHttpFactory=new Wc({})),this.Oo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=s.join("");M(be,`Creating RPC '${e}' stream ${i}: ${p}`,h);let I=a.createWebChannel(p,h),C=!1,R=!1,N=new al({Io:k=>{R?M(be,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(C||(M(be,`Opening RPC '${e}' stream ${i} transport.`),I.open(),C=!0),M(be,`RPC '${e}' stream ${i} sending:`,k),I.send(k))},To:()=>I.close()}),F=(k,G,H)=>{k.listen(G,K=>{try{H(K)}catch(re){setTimeout(()=>{throw re},0)}})};return F(I,Jn.EventType.OPEN,()=>{R||(M(be,`RPC '${e}' stream ${i} transport opened.`),N.yo())}),F(I,Jn.EventType.CLOSE,()=>{R||(R=!0,M(be,`RPC '${e}' stream ${i} transport closed`),N.So())}),F(I,Jn.EventType.ERROR,k=>{R||(R=!0,rr(be,`RPC '${e}' stream ${i} transport errored:`,k),N.So(new V(S.UNAVAILABLE,"The operation could not be completed")))}),F(I,Jn.EventType.MESSAGE,k=>{var G;if(!R){let H=k.data[0];ne(!!H);let K=H,re=K.error||((G=K[0])===null||G===void 0?void 0:G.error);if(re){M(be,`RPC '${e}' stream ${i} received error:`,re);let Se=re.status,ee=function(_){let v=ue[_];if(v!==void 0)return Om(v)}(Se),w=re.message;ee===void 0&&(ee=S.INTERNAL,w="Unknown error status: "+Se+" with message "+re.message),R=!0,N.So(new V(ee,w)),I.close()}else M(be,`RPC '${e}' stream ${i} received:`,H),N.bo(H)}}),F(u,Kc.STAT_EVENT,k=>{k.stat===$s.PROXY?M(be,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===$s.NOPROXY&&M(be,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}};function Zc(){return typeof document<"u"?document:null}function Do(n){return new Vu(n,!0)}var lo=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&M("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var ho=class{constructor(e,t,r,i,s,a,u,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new lo(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===S.RESOURCE_EXHAUSTED?(yt(t.toString()),yt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===S.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new V(S.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return M("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},ul=class extends ho{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=VE(this.serializer,e),r=function(s){if(!("targetChange"in s))return $.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?$.min():a.readTime?it(a.readTime):$.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Fu(this.serializer),t.addTarget=function(s,a){let u,h=a.target;if(u=Eu(h)?{documents:ME(s,h)}:{query:FE(s,h)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Mm(s,a.resumeToken);let d=xu(s,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo($.min())>0){u.readTime=oo(s,a.snapshotVersion.toTimestamp());let d=xu(s,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=UE(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Fu(this.serializer),t.removeTarget=e,this.a_(t)}},ll=class extends ho{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ne(!!e.streamToken),this.lastStreamToken=e.streamToken,ne(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ne(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=OE(e.writeResults,e.commitTime),r=it(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Fu(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>xE(this.serializer,r))};this.a_(t)}};var hl=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new V(S.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Ou(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new V(S.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,Ou(t,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new V(S.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},dl=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(yt(t),this.D_=!1):M("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var fl=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget(()=>y(this,null,function*(){Sn(this)&&(M("RemoteStore","Restarting streams for network reachability change."),yield function(h){return y(this,null,function*(){let d=j(h);d.L_.add(4),yield Di(d),d.q_.set("Unknown"),d.L_.delete(4),yield ko(d)})}(this))}))}),this.q_=new dl(r,i)}};function ko(n){return y(this,null,function*(){if(Sn(n))for(let e of n.B_)yield e(!0)})}function Di(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function zm(n,e){let t=j(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Kl(t)?Hl(t):_r(t).r_()&&Wl(t,e))}function zl(n,e){let t=j(n),r=_r(t);t.N_.delete(e),r.r_()&&Wm(t,e),t.N_.size===0&&(r.r_()?r.o_():Sn(t)&&t.q_.set("Unknown"))}function Wl(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}_r(n).A_(e)}function Wm(n,e){n.Q_.xe(e),_r(n).R_(e)}function Hl(n){n.Q_=new Nu({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),_r(n).start(),n.q_.v_()}function Kl(n){return Sn(n)&&!_r(n).n_()&&n.N_.size>0}function Sn(n){return j(n).L_.size===0}function Hm(n){n.Q_=void 0}function ZE(n){return y(this,null,function*(){n.q_.set("Online")})}function eT(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{Wl(n,e)})})}function tT(n,e){return y(this,null,function*(){Hm(n),Kl(n)?(n.q_.M_(e),Hl(n)):n.q_.set("Unknown")})}function nT(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof io&&e.state===2&&e.cause)try{yield function(i,s){return y(this,null,function*(){let a=s.cause;for(let u of s.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){M("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield fo(n,r)}else if(e instanceof tr?n.Q_.Ke(e):e instanceof ro?n.Q_.He(e):n.Q_.We(e),!t.isEqual($.min()))try{let r=yield Gm(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let u=s.Q_.rt(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=s.N_.get(h);if(!p)return;s.N_.set(h,p.withResumeToken(Ce.EMPTY_BYTE_STRING,p.snapshotVersion)),Wm(s,h);let I=new Ii(p.target,h,d,p.sequenceNumber);Wl(s,I)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){M("RemoteStore","Failed to raise snapshot:",r),yield fo(n,r)}})}function fo(n,e,t){return y(this,null,function*(){if(!Pi(e))throw e;n.L_.add(1),yield Di(n),n.q_.set("Offline"),t||(t=()=>Gm(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){M("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield ko(n)}))})}function Km(n,e){return e().catch(t=>fo(n,t,e))}function No(n){return y(this,null,function*(){let e=j(n),t=Qt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;rT(e);)try{let i=yield QE(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,iT(e,i)}catch(i){yield fo(e,i)}Qm(e)&&Jm(e)})}function rT(n){return Sn(n)&&n.O_.length<10}function iT(n,e){n.O_.push(e);let t=Qt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Qm(n){return Sn(n)&&!Qt(n).n_()&&n.O_.length>0}function Jm(n){Qt(n).start()}function sT(n){return y(this,null,function*(){Qt(n).p_()})}function oT(n){return y(this,null,function*(){let e=Qt(n);for(let t of n.O_)e.m_(t.mutations)})}function aT(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=Ru.from(r,e,t);yield Km(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield No(n)})}function cT(n,e){return y(this,null,function*(){e&&Qt(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(a){return AE(a)&&a!==S.ABORTED}(i.code)){let s=r.O_.shift();Qt(r).s_(),yield Km(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield No(r)}})}(n,e)),Qm(n)&&Jm(n)})}function Zp(n,e){return y(this,null,function*(){let t=j(n);t.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");let r=Sn(t);t.L_.add(3),yield Di(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield ko(t)})}function uT(n,e){return y(this,null,function*(){let t=j(n);e?(t.L_.delete(2),yield ko(t)):e||(t.L_.add(2),yield Di(t),t.q_.set("Unknown"))})}function _r(n){return n.K_||(n.K_=function(t,r,i){let s=j(t);return s.w_(),new ul(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:ZE.bind(null,n),Ro:eT.bind(null,n),mo:tT.bind(null,n),d_:nT.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),Kl(n)?Hl(n):n.q_.set("Unknown")):(yield n.K_.stop(),Hm(n))}))),n.K_}function Qt(n){return n.U_||(n.U_=function(t,r,i){let s=j(t);return s.w_(),new ll(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:sT.bind(null,n),mo:cT.bind(null,n),f_:oT.bind(null,n),g_:aT.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield No(n)):(yield n.U_.stop(),n.O_.length>0&&(M("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var pl=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new _t,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,u=new n(e,t,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new V(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ql(n,e){if(yt("AsyncQueue",`${e}: ${n}`),Pi(n))return new V(S.UNAVAILABLE,`${e}: ${n}`);throw n}var po=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||L.comparator(t.key,r.key):(t,r)=>L.comparator(t.key,r.key),this.keyedMap=li(),this.sortedSet=new ce(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var mo=class{constructor(){this.W_=new ce(L.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):B():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},dr=class n{constructor(e,t,r,i,s,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,po.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ro(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var ml=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},gl=class{constructor(){this.queries=em(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=j(t),s=i.queries;i.queries=em(),s.forEach((a,u)=>{for(let h of u.j_)h.onError(r)})})(this,new V(S.ABORTED,"Firestore shutting down"))}};function em(){return new Kt(n=>Tm(n),Ro)}function lT(n,e){return y(this,null,function*(){let t=j(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new ml,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=Ql(a,`Initialization of query '${Yn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Jl(t)})}function hT(n,e){return y(this,null,function*(){let t=j(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function dT(n,e){let t=j(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&Jl(t)}function fT(n,e,t){let r=j(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function Jl(n){n.Y_.forEach(e=>{e.next()})}var _l,tm;(tm=_l||(_l={})).ea="default",tm.Cache="cache";var yl=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new dr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=dr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==_l.Cache}};var go=class{constructor(e){this.key=e}},_o=class{constructor(e){this.key=e}},vl=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=W(),this.mutatedKeys=W(),this.Aa=bm(e),this.Ra=new po(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new mo,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,I)=>{let C=i.get(p),R=Po(this.query,I)?I:null,N=!!C&&this.mutatedKeys.has(C.key),F=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations),k=!1;C&&R?C.data.isEqual(R.data)?N!==F&&(r.track({type:3,doc:R}),k=!0):this.ga(C,R)||(r.track({type:2,doc:R}),k=!0,(h&&this.Aa(R,h)>0||d&&this.Aa(R,d)<0)&&(u=!0)):!C&&R?(r.track({type:0,doc:R}),k=!0):C&&!R&&(r.track({type:1,doc:C}),k=!0,(h||d)&&(u=!0)),k&&(R?(a=a.add(R),s=F?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,I)=>function(R,N){let F=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B()}};return F(R)-F(N)}(p.type,I.type)||this.Aa(p.doc,I.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,d=h!==this.Ea;return this.Ea=h,a.length!==0||d?{snapshot:new dr(this.query,e.Ra,s,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new mo,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=W(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new _o(r))}),this.da.forEach(r=>{e.has(r)||t.push(new go(r))}),t}ba(e){this.Ta=e.Ts,this.da=W();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return dr.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Il=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},wl=class{constructor(e){this.key=e,this.va=!1}},El=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Kt(u=>Tm(u),Ro),this.Ma=new Map,this.xa=new Set,this.Oa=new ce(L.comparator),this.Na=new Map,this.La=new Ei,this.Ba={},this.ka=new Map,this.qa=wi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function pT(n,e,t=!0){return y(this,null,function*(){let r=ng(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield Ym(r,e,t,!0),i})}function mT(n,e){return y(this,null,function*(){let t=ng(n);yield Ym(t,e,!0,!1)})}function Ym(n,e,t,r){return y(this,null,function*(){let i=yield JE(n.localStore,rt(e)),s=i.targetId,a=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",u;return r&&(u=yield gT(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&zm(n.remoteStore,i),u})}function gT(n,e,t,r,i){return y(this,null,function*(){n.Ka=(I,C,R)=>function(F,k,G,H){return y(this,null,function*(){let K=k.view.ma(G);K.ns&&(K=yield Xp(F.localStore,k.query,!1).then(({documents:w})=>k.view.ma(w,K)));let re=H&&H.targetChanges.get(k.targetId),Se=H&&H.targetMismatches.get(k.targetId)!=null,ee=k.view.applyChanges(K,F.isPrimaryClient,re,Se);return rm(F,k.targetId,ee.wa),ee.snapshot})}(n,I,C,R);let s=yield Xp(n.localStore,e,!0),a=new vl(e,s.Ts),u=a.ma(s.documents),h=vi.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);rm(n,t,d.wa);let p=new Il(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function _T(n,e,t){return y(this,null,function*(){let r=j(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(a=>!Ro(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield il(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&zl(r.remoteStore,i.targetId),Tl(r,i.targetId)}).catch(Ri))):(Tl(r,i.targetId),yield il(r.localStore,i.targetId,!0))})}function yT(n,e){return y(this,null,function*(){let t=j(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),zl(t.remoteStore,r.targetId))})}function vT(n,e,t){return y(this,null,function*(){let r=CT(n);try{let i=yield function(a,u){let h=j(a),d=ve.now(),p=u.reduce((R,N)=>R.add(N.key),W()),I,C;return h.persistence.runTransaction("Locally write mutations","readwrite",R=>{let N=It(),F=W();return h.cs.getEntries(R,p).next(k=>{N=k,N.forEach((G,H)=>{H.isValidDocument()||(F=F.add(G))})}).next(()=>h.localDocuments.getOverlayedDocuments(R,N)).next(k=>{I=k;let G=[];for(let H of u){let K=bE(H,I.get(H.key).overlayedDocument);K!=null&&G.push(new wt(H.key,K,gm(K.value.mapValue),yn.exists(!0)))}return h.mutationQueue.addMutationBatch(R,d,G,u)}).next(k=>{C=k;let G=k.applyToLocalDocumentSet(I,F);return h.documentOverlayCache.saveOverlays(R,k.batchId,G)})}).then(()=>({batchId:C.batchId,changes:Cm(I)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let d=a.Ba[a.currentUser.toKey()];d||(d=new ce(Y)),d=d.insert(u,h),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield ki(r,i.changes),yield No(r.remoteStore)}catch(i){let s=Ql(i,"Failed to persist write");t.reject(s)}})}function Xm(n,e){return y(this,null,function*(){let t=j(n);try{let r=yield HE(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Na.get(s);a&&(ne(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ne(a.va):i.removedDocuments.size>0&&(ne(a.va),a.va=!1))}),yield ki(t,r,e)}catch(r){yield Ri(r)}})}function nm(n,e,t){let r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=j(a);h.onlineState=u;let d=!1;h.queries.forEach((p,I)=>{for(let C of I.j_)C.Z_(u)&&(d=!0)}),d&&Jl(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function IT(n,e,t){return y(this,null,function*(){let r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let a=new ce(L.comparator);a=a.insert(s,Ke.newNoDocument(s,$.min()));let u=W().add(s),h=new no($.min(),new Map,new ce(Y),a,u);yield Xm(r,h),r.Oa=r.Oa.remove(s),r.Na.delete(e),Yl(r)}else yield il(r.localStore,e,!1).then(()=>Tl(r,e,t)).catch(Ri)})}function wT(n,e){return y(this,null,function*(){let t=j(n),r=e.batch.batchId;try{let i=yield WE(t.localStore,e);eg(t,r,null),Zm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ki(t,i)}catch(i){yield Ri(i)}})}function ET(n,e,t){return y(this,null,function*(){let r=j(n);try{let i=yield function(a,u){let h=j(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(I=>(ne(I!==null),p=I.keys(),h.mutationQueue.removeMutationBatch(d,I))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);eg(r,e,t),Zm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ki(r,i)}catch(i){yield Ri(i)}})}function Zm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function eg(n,e,t){let r=j(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Tl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||tg(n,r)})}function tg(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(zl(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Yl(n))}function rm(n,e,t){for(let r of t)r instanceof go?(n.La.addReference(r.key,e),TT(n,r)):r instanceof _o?(M("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||tg(n,r.key)):B()}function TT(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(M("SyncEngine","New document in limbo: "+t),n.xa.add(r),Yl(n))}function Yl(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new L(oe.fromString(e)),r=n.qa.next();n.Na.set(r,new wl(t)),n.Oa=n.Oa.insert(t,r),zm(n.remoteStore,new Ii(rt(ql(t.path)),r,"TargetPurposeLimboResolution",dm.oe))}}function ki(n,e,t){return y(this,null,function*(){let r=j(n),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,h)=>{a.push(r.Ka(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let I=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,I?"current":"not-current")}if(d){i.push(d);let I=el.Wi(h.targetId,d);s.push(I)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(h,d){return y(this,null,function*(){let p=j(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>P.forEach(d,C=>P.forEach(C.$i,R=>p.persistence.referenceDelegate.addReference(I,C.targetId,R)).next(()=>P.forEach(C.Ui,R=>p.persistence.referenceDelegate.removeReference(I,C.targetId,R)))))}catch(I){if(!Pi(I))throw I;M("LocalStore","Failed to update sequence numbers: "+I)}for(let I of d){let C=I.targetId;if(!I.fromCache){let R=p.os.get(C),N=R.snapshotVersion,F=R.withLastLimboFreeSnapshotVersion(N);p.os=p.os.insert(C,F)}}})}(r.localStore,s))})}function bT(n,e){return y(this,null,function*(){let t=j(n);if(!t.currentUser.isEqual(e)){M("SyncEngine","User change. New user:",e.toKey());let r=yield $m(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(u=>{u.forEach(h=>{h.reject(new V(S.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ki(t,r.hs)}})}function AT(n,e){let t=j(n),r=t.Na.get(e);if(r&&r.va)return W().add(r.key);{let i=W(),s=t.Ma.get(e);if(!s)return i;for(let a of s){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function ng(n){let e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=AT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=IT.bind(null,e),e.Ca.d_=dT.bind(null,e.eventManager),e.Ca.$a=fT.bind(null,e.eventManager),e}function CT(n){let e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ET.bind(null,e),e}var yo=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=Do(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return zE(this.persistence,new nl,e.initialUser,this.serializer)}createPersistence(e){return new Yu(Zu.Zr,this.serializer)}createSharedClientState(e){return new sl}terminate(){return y(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var bl=class{initialize(e,t){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>nm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=bT.bind(null,this.syncEngine),yield uT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new gl}()}createDatastore(e){let t=Do(e.databaseInfo.databaseId),r=function(s){return new cl(s)}(e.databaseInfo);return function(s,a,u,h){return new hl(s,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,u){return new fl(r,i,s,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>nm(this.syncEngine,t,0),function(){return uo.D()?new uo:new ol}())}createSyncEngine(e,t){return function(i,s,a,u,h,d,p){let I=new El(i,s,a,u,h,d);return p&&(I.Qa=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return y(this,null,function*(){var e,t;yield function(i){return y(this,null,function*(){let s=j(i);M("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield Di(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};var Al=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):yt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var Cl=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=me.UNAUTHENTICATED,this.clientId=Qs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>y(this,null,function*(){M("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(M("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new V(S.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new _t;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Ql(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function eu(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield $m(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function im(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield RT(n);M("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Zp(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Zp(e.remoteStore,i)),n._onlineComponents=e})}function ST(n){return n.name==="FirebaseError"?n.code===S.FAILED_PRECONDITION||n.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function RT(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{yield eu(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!ST(t))throw t;rr("Error using user provided cache. Falling back to memory cache: "+t),yield eu(n,new yo)}}else M("FirestoreClient","Using default OfflineComponentProvider"),yield eu(n,new yo);return n._offlineComponents})}function rg(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),yield im(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),yield im(n,new bl))),n._onlineComponents})}function PT(n){return rg(n).then(e=>e.syncEngine)}function sm(n){return y(this,null,function*(){let e=yield rg(n),t=e.eventManager;return t.onListen=pT.bind(null,e.syncEngine),t.onUnlisten=_T.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=mT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=yT.bind(null,e.syncEngine),t})}function ig(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var om=new Map;function sg(n,e,t){if(!t)throw new V(S.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function DT(n,e,t,r){if(e===!0&&r===!0)throw new V(S.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function am(n){if(!L.isDocumentKey(n))throw new V(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function cm(n){if(L.isDocumentKey(n))throw new V(S.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Vo(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B()}function mi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Vo(n);throw new V(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var vo=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new V(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new V(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}DT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ig((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new V(S.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new V(S.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new V(S.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},fr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vo({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new V(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new V(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vo(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new tu;switch(r.type){case"firstParty":return new su(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=om.get(t);r&&(M("ComponentProvider","Removing Datastore"),om.delete(t),r.terminate())}(this),Promise.resolve()}};function og(n,e,t,r={}){var i;let s=(n=mi(n,fr))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&rr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=me.MOCK_USER;else{u=Ld(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new V(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new me(d)}n._authCredentials=new nu(new Ks(u,h))}}var Cn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Fe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},zt=class n extends Cn{constructor(e,t,r){super(e,t,ql(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Fe(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function ag(n,e,...t){if(n=ye(n),sg("collection","path",e),n instanceof fr){let r=oe.fromString(e,...t);return cm(r),new zt(n,null,r)}{if(!(n instanceof Fe||n instanceof zt))throw new V(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return cm(r),new zt(n.firestore,null,r)}}function cg(n,e,...t){if(n=ye(n),arguments.length===1&&(e=Qs.newId()),sg("doc","path",e),n instanceof fr){let r=oe.fromString(e,...t);return am(r),new Fe(n,null,new L(r))}{if(!(n instanceof Fe||n instanceof zt))throw new V(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return am(r),new Fe(n.firestore,n instanceof zt?n.converter:null,new L(r))}}var Sl=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new lo(this,"async_queue_retry"),this.Eu=()=>{let t=Zc();t&&M("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=Zc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=Zc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new _t;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return y(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!Pi(e))throw e;M("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw yt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=pl.createAndSchedule(this,e,t,r,s=>this.Vu(s));return this.lu.push(i),i}du(){this.hu&&B()}verifyOperationInProgress(){}mu(){return y(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function um(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var pr=class extends fr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new Sl}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||hg(this),this._firestoreClient.terminate()}};function ug(n,e){let t=typeof n=="object"?n:Un(),r=typeof n=="string"?n:e||"(default)",i=zr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Fd("firestore");s&&og(i,...s)}return i}function lg(n){return n._firestoreClient||hg(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function hg(n){var e,t,r;let i=n._freezeSettings(),s=function(u,h,d,p){return new lu(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,ig(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new Cl(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Ti=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ce.fromBase64String(e))}catch(t){throw new V(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ce.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var bi=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new V(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Me(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Io=class{constructor(e){this._methodName=e}};var Ai=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}};var Ci=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var kT=/^__.*__$/,Rl=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new wt(e,this.data,this.fieldMask,t,this.fieldTransforms):new An(e,this.data,t,this.fieldTransforms)}};function dg(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}var Pl=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.yu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return wo(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(dg(this.wu)&&kT.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},Dl=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Do(e)}Nu(e,t,r,i=!1){return new Pl({wu:e,methodName:t,Ou:r,path:Me.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function fg(n){let e=n._freezeSettings(),t=Do(n._databaseId);return new Dl(n._databaseId,!!e.ignoreUndefinedProperties,t)}function NT(n,e,t,r,i,s={}){let a=n.Nu(s.merge||s.mergeFields?2:0,e,t,i);gg("Data must be an object, but it was:",a,r);let u=pg(r,a),h,d;if(s.merge)h=new tt(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let I of s.mergeFields){let C=xT(e,I,t);if(!a.contains(C))throw new V(S.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);MT(p,C)||p.push(C)}h=new tt(p),d=a.fieldTransforms.filter(I=>h.covers(I.field))}else h=null,d=a.fieldTransforms;return new Rl(new He(u),h,d)}function VT(n,e,t,r=!1){return Xl(t,n.Nu(r?4:3,e))}function Xl(n,e){if(mg(n=ye(n)))return gg("Unsupported field value:",e,n),pg(n,e);if(n instanceof Io)return function(r,i){if(!dg(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let u of r){let h=Xl(u,i.Fu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vE(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ve.fromDate(r);return{timestampValue:oo(i.serializer,s)}}if(r instanceof ve){let s=new ve(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:oo(i.serializer,s)}}if(r instanceof Ai)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ti)return{bytesValue:Mm(i.serializer,r._byteString)};if(r instanceof Fe){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Gl(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ci)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Mu("VectorValues must only contain numeric values.");return $l(u.serializer,h)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Vo(r)}`)}(n,e)}function pg(n,e){let t={};return fm(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gr(n,(r,i)=>{let s=Xl(i,e.bu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function mg(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ve||n instanceof Ai||n instanceof Ti||n instanceof Fe||n instanceof Io||n instanceof Ci)}function gg(n,e,t){if(!mg(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Vo(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function xT(n,e,t){if((e=ye(e))instanceof bi)return e._internalPath;if(typeof e=="string")return _g(n,e);throw wo("Field path arguments must be of type string or ",n,!1,void 0,t)}var OT=new RegExp("[~\\*/\\[\\]]");function _g(n,e,t){if(e.search(OT)>=0)throw wo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bi(...e.split("."))._internalPath}catch{throw wo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function wo(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new V(S.INVALID_ARGUMENT,u+n+h)}function MT(n,e){return n.some(t=>t.isEqual(e))}var Eo=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Fe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new kl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(xo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},kl=class extends Eo{data(){return super.data()}};function xo(n,e){return typeof e=="string"?_g(n,e):e instanceof bi?e._internalPath:e._delegate._internalPath}function FT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new V(S.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Si=class{},To=class extends Si{};function yg(n,e,...t){let r=[];e instanceof Si&&r.push(e),r=r.concat(t),function(s){let a=s.filter(h=>h instanceof Nl).length,u=s.filter(h=>h instanceof bo).length;if(a>1||a>0&&u>0)throw new V(S.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var bo=class n extends To{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return wg(e._query,t),new Cn(e.firestore,e.converter,Tu(e._query,t))}_parse(e){let t=fg(e.firestore);return function(s,a,u,h,d,p,I){let C;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new V(S.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){hm(I,p);let R=[];for(let N of I)R.push(lm(h,s,N));C={arrayValue:{values:R}}}else C=lm(h,s,I)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||hm(I,p),C=VT(u,a,I,p==="in"||p==="not-in");return he.create(d,p,C)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function vg(n,e,t){let r=e,i=xo("where",n);return bo._create(i,r,t)}var Nl=class n extends Si{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Qe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i,u=s.getFlattenedFilters();for(let h of u)wg(a,h),a=Tu(a,h)}(e._query,t),new Cn(e.firestore,e.converter,Tu(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Vl=class n extends To{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,a){if(i.startAt!==null)throw new V(S.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new V(S.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new En(s,a)}(e._query,this._field,this._direction);return new Cn(e.firestore,e.converter,function(i,s){let a=i.explicitOrderBy.concat([s]);return new Ht(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function Ig(n,e="asc"){let t=e,r=xo("orderBy",n);return Vl._create(r,t)}function lm(n,e,t){if(typeof(t=ye(t))=="string"){if(t==="")throw new V(S.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Em(e)&&t.indexOf("/")!==-1)throw new V(S.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(oe.fromString(t));if(!L.isDocumentKey(r))throw new V(S.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Op(n,new L(r))}if(t instanceof Fe)return Op(n,t._key);throw new V(S.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vo(t)}.`)}function hm(n,e){if(!Array.isArray(n)||n.length===0)throw new V(S.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wg(n,e){let t=function(i,s){for(let a of i)for(let u of a.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new V(S.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new V(S.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var xl=class{convertValue(e,t="none"){switch(wn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return gr(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>se(a.doubleValue));return new Ci(s)}convertGeoPoint(e){return new Ai(se(e.latitude),se(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Ll(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(_i(e));default:return null}}convertTimestamp(e){let t=vt(e);return new ve(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=oe.fromString(e);ne(qm(r));let i=new Zs(r.get(1),r.get(3)),s=new L(r.popFirst(5));return i.isEqual(t)||yt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function LT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var _n=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ao=class extends Eo{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new nr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(xo("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},nr=class extends Ao{data(e={}){return super.data(e)}},Ol=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new _n(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new nr(this._firestore,this._userDataWriter,r.key,r,new _n(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new nr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new _n(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let h=new nr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new _n(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:UT(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function UT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B()}}var Co=class extends xl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ti(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,t)}};function Eg(n,e){let t=mi(n.firestore,pr),r=cg(n),i=LT(n.converter,e);return BT(t,[NT(fg(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,yn.exists(!1))]).then(()=>r)}function Zl(n,...e){var t,r,i;n=ye(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||um(e[a])||(s=e[a],a++);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(um(e[a])){let I=e[a];e[a]=(t=I.next)===null||t===void 0?void 0:t.bind(I),e[a+1]=(r=I.error)===null||r===void 0?void 0:r.bind(I),e[a+2]=(i=I.complete)===null||i===void 0?void 0:i.bind(I)}let h,d,p;if(n instanceof Fe)d=mi(n.firestore,pr),p=ql(n._key.path),h={next:I=>{e[a]&&e[a](jT(d,n,I))},error:e[a+1],complete:e[a+2]};else{let I=mi(n,Cn);d=mi(I.firestore,pr),p=I._query;let C=new Co(d);h={next:R=>{e[a]&&e[a](new Ol(d,C,I,R))},error:e[a+1],complete:e[a+2]},FT(n._query)}return function(C,R,N,F){let k=new Al(F),G=new yl(R,k,N);return C.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return lT(yield sm(C),G)})),()=>{k.za(),C.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return hT(yield sm(C),G)}))}}(lg(d),p,u,h)}function BT(n,e){return function(r,i){let s=new _t;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return vT(yield PT(r),i,s)})),s.promise}(lg(n),e)}function jT(n,e,t){let r=t.docs.get(e._key),i=new Co(n);return new Ao(n,i,e._key,r,new _n(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){mr=i})(Lt),Ft(new Ge("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),u=new pr(new ru(r.getProvider("auth-internal")),new au(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new V(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zs(d.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),fe(kp,"4.7.1",e),fe(kp,"4.7.1","esm2017")})();var Oo=function(){return Oo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Oo.apply(this,arguments)};var GT={includeMetadataChanges:!1};function Tg(n,e){return e===void 0&&(e=GT),new Lr(function(t){var r=Zl(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function bg(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Oo(Oo({},r),(t={},t[e.idField]=n.id,t))}function Ag(n){return Tg(n,{includeMetadataChanges:!0}).pipe(Ur(function(e){return e.docs}))}function Cg(n,e){return e===void 0&&(e={}),Ag(n).pipe(Ur(function(t){return t.map(function(r){return bg(r,e)})}))}var Rn=class{constructor(e){return e}},Sg="firestore",eh=class{constructor(){return Wr(Sg)}};var th=new Ue("angularfire2.firestore-instances");function zT(n,e){let t=ms(Sg,n,e);return t&&new Rn(t)}function WT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Rn(r)}}var HT={provide:eh,deps:[[new Be,th]]},KT={provide:Rn,useFactory:zT,deps:[[new Be,th],dt]};function Rg(n,...e){return fe("angularfire",cn.full,"fst"),Vn([KT,HT,{provide:th,useFactory:WT(n),multi:!0,deps:[Dt,nn,qn,un,[new Be,ti],[new Be,jn],...e]}])}var nh=De(Cg,!0);var rh=De(Eg,!0);var Ni=De(ag,!0);var Pg=De(ug,!0);var Dg=De(Ig,!0);var ih=De(yg,!0);var kg=De(vg,!0);var Jt=class n{constructor(e){this.firestore=e;this.GetChat()}loginsCollection=[];countLogins=0;sub;chatsSubject=new Yi([]);chats$=this.chatsSubject.asObservable();subChat;LoginReg(e){let t=Ni(this.firestore,"logins");rh(t,{fecha:new Date,user:e})}GetDataReg(){let e=Ni(this.firestore,"logins"),t=ih(e),r=nh(t);this.sub=r.subscribe(i=>{this.loginsCollection=i,this.countLogins=this.loginsCollection.length,console.log(i)})}escribirChat(e,t){let r=Ni(this.firestore,"chat");rh(r,{fecha:new Date,user:e,mensaje:t})}GetChat(){let e=Ni(this.firestore,"chat"),r=ih(e,kg("fecha",">=",new Date),Dg("fecha","desc")),i=nh(r);this.subChat=i.subscribe(s=>{this.chatsSubject.next(s)})}static \u0275fac=function(t){return new(t||n)(Zi(Rn))};static \u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"})};function JT(n,e){if(n&1&&(x(0,"div")(1,"strong",6),q(2),vd(3,"date"),O(),x(4,"p"),q(5),O()()),n&2){let t=e.$implicit;X(2),_d("",t.user," ( ",Id(3,3,t.fecha.seconds*1e3,"hh:mm a, dd-MM-yy")," ) dice:"),X(3),On('"',t.mensaje,'"')}}var Mo=class n{constructor(e,t){this.chat=e;this.auth=t}chats=[];user=null;mensaje="";ngOnInit(){this.user=this.auth.currentUser?.email,this.chat.chats$.subscribe(e=>{this.chats=e})}enviarMensaje(){this.chat.escribirChat(this.user,this.mensaje)}static \u0275fac=function(t){return new(t||n)(Z(Jt),Z(Oe))};static \u0275cmp=je({type:n,selectors:[["app-chat"]],standalone:!0,features:[$e],decls:7,vars:2,consts:[[1,"chat-container"],[1,"mensajes"],[4,"ngFor","ngForOf"],[1,"chat-input"],["placeholder","Escribe tu mensaje...",3,"ngModelChange","ngModel"],[3,"click"],[1,"text-success"]],template:function(t,r){t&1&&(x(0,"div",0)(1,"div",1),Je(2,JT,6,6,"div",2),O(),x(3,"div",3)(4,"input",4),Vt("ngModelChange",function(s){return Nt(r.mensaje,s)||(r.mensaje=s),s}),O(),x(5,"button",5),qe("click",function(){return r.enviarMensaje()}),q(6,"Enviar"),O()()()),t&2&&(X(2),_e("ngForOf",r.chats),X(2),kt("ngModel",r.mensaje))},dependencies:[Mn,Ad,Cd,Qn,$t,Kn,pn],styles:[".chat-container[_ngcontent-%COMP%]{height:calc(100vh - 80px);display:flex;flex-direction:column}.mensajes[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto;width:100%;padding:10px;border:1px solid #ccc;display:flex;flex-direction:column-reverse}.chat-input[_ngcontent-%COMP%]{width:100%;padding:10px;border-top:1px solid #ccc;display:flex;margin-top:auto}.chat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:5px}.chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;margin-left:5px}"]})};var Fo=class n{miDataSubject=new Yi("");miData$=this.miDataSubject.asObservable();setMiData(e){this.miDataSubject.next(e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"})};var XT=()=>["/home"];function ZT(n,e){n&1&&(x(0,"div")(1,"div",14)(2,"div")(3,"button",15),q(4,"Login"),O()(),x(5,"div")(6,"button",15),q(7,"Resgistrarse"),O()()()()),n&2&&(X(3),_e("routerLink","./login"),X(3),_e("routerLink","./registro"))}function e0(n,e){if(n&1){let t=ns();x(0,"div",14)(1,"p",16),q(2),O(),x(3,"button",17),qe("click",function(){Rt(t);let i=Ve();return Pt(i.CloseSession())}),q(4,"Logout"),O(),x(5,"button",17),qe("click",function(){Rt(t);let i=Ve();return Pt(i.abrirChat())}),q(6,"Chat"),O()()}if(n&2){let t=Ve();X(2),On("Usuario: ",t.auth.currentUser==null?null:t.auth.currentUser.email,"")}}function t0(n,e){n&1&&(x(0,"div",18)(1,"div",19)(2,"span",20),q(3,"Cargando..."),O()()())}function n0(n,e){n&1&&(x(0,"div"),de(1,"router-outlet"),O())}function r0(n,e){n&1&&(x(0,"div")(1,"div",21)(2,"div",22)(3,"div",9)(4,"div",23)(5,"div",24),de(6,"img",25),x(7,"div",26)(8,"h5",27),q(9,"El Ahorcado"),O(),x(10,"p",28),q(11,"Some quick example text to build on the card title and make up the bulk of the card's content."),O(),x(12,"button",15),q(13,"Cargar"),O()()()(),x(14,"div",23)(15,"div",24),de(16,"img",29),x(17,"div",26)(18,"h5",27),q(19,"Mayor o Menor"),O(),x(20,"p",28),q(21,"Some quick example text to build on the card title and make up the bulk of the card's content."),O(),x(22,"button",15),q(23,"Cargar"),O()()()(),x(24,"div",23)(25,"div",24),de(26,"img",30),x(27,"div",26)(28,"h5",27),q(29,"Preguntados"),O(),x(30,"p",28),q(31,"Some quick example text to build on the card title and make up the bulk of the card's content."),O(),x(32,"button",15),q(33,"Cargar"),O()()()(),x(34,"div",23)(35,"div",24),de(36,"img",31),x(37,"div",26)(38,"h5",27),q(39,"Chat-Room"),O(),x(40,"p",28),q(41,"Some quick example text to build on the card title and make up the bulk of the card's content."),O(),x(42,"button",15),q(43,"Cargar"),O()()()(),x(44,"div",23)(45,"div",24),de(46,"img",32),x(47,"div",26)(48,"h5",27),q(49,"Quien soy"),O(),x(50,"p",28),q(51,"Some quick example text to build on the card title and make up the bulk of the card's content."),O(),x(52,"button",15),q(53,"Cargar"),O()()()()()()()()),n&2&&(X(12),_e("routerLink","./juegos/ahorcado"),X(10),_e("routerLink","./juegos/mayoromenor"),X(10),_e("routerLink","./juegos/preguntados"),X(10),_e("routerLink","./juegos/chat"),X(10),_e("routerLink","./juegos/quiensoy"))}function i0(n,e){n&1&&(x(0,"div",13),de(1,"app-chat"),O())}var Lo=class n{constructor(e,t,r){this.dataService=e;this.auth=t;this.router=r;this.router.events.subscribe(i=>{i instanceof Pd?this.cargando=!0:(i instanceof Sa||i instanceof Dd||i instanceof kd)&&(this.cargando=!1)})}isUserLoggedIn=!0;usuario="";login="login";logout="logout";isChildActive=!1;chat=!1;cargando=!1;ngOnInit(){this.dataService.miData$.subscribe(e=>{this.usuario=e}),this.router.events.subscribe(e=>{e instanceof Sa&&(this.isChildActive=e.url!=="/home")})}CloseSession(){Os(this.auth).then(()=>{this.router.navigate(["/home"]),this.chat=!1})}abrirChat(){this.chat=!this.chat}toggleChat(){this.chat=!this.chat}static \u0275fac=function(t){return new(t||n)(Z(Fo),Z(Oe),Z(xt))};static \u0275cmp=je({type:n,selectors:[["app-home"]],standalone:!0,features:[$e],decls:19,vars:8,consts:[["elseBlock",""],[1,"navbar"],[1,"container"],[1,"d-flex"],["href","#",1,"navbar-brand"],["src","../../../assets/img/logo.png","alt","sala de juegos","width","30","height","24",1,"mt-2"],[1,"texto-blanco","silkscreen-regular",2,"cursor","pointer",3,"routerLink"],[4,"ngIf","ngIfElse"],[1,"container-fluid","overflow-hidden"],[1,"row"],[1,"col","mt-3"],["class","d-flex justify-content-center align-items-center","style","position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: rgba(255, 255, 255, 0.8); z-index: 1000;",4,"ngIf"],[4,"ngIf"],[1,"contenedor-chat","col-3"],[1,"div-botones","d-flex"],["type","button",1,"btn","btn-primary","texto-blanco","silkscreen-regular",3,"routerLink"],[1,"mt-2","text-center","texto-blanco"],[1,"boton","btn","texto-blanco","mx-2","mt-3",3,"click"],[1,"d-flex","justify-content-center","align-items-center",2,"position","fixed","top","0","left","0","width","100%","height","100vh","background","rgba(255, 255, 255, 0.8)","z-index","1000"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"container-fluid"],[1,"contenedor"],[1,"col","div-card"],[1,"card","contenedor-fijo"],["src","../../../assets/img/elahorcado.png","alt","...",1,"card-img-top"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["src","../../../assets/img/mayoromenor.jpg","alt","...",1,"card-img-top"],["src","../../../assets/img/preguntados.png","alt","...",1,"card-img-top"],["src","../../../assets/img/chatroom.jpg","alt","...",1,"card-img-top"],["src","../../../assets/img/usericon.jpg","alt","...",1,"card-img-top"]],template:function(t,r){if(t&1&&(x(0,"div")(1,"nav",1)(2,"div",2)(3,"div",3)(4,"a",4),de(5,"img",5),O(),x(6,"h1",6),q(7,"Sala de Juegos"),O()(),x(8,"div"),Je(9,ZT,8,2,"div",7)(10,e0,7,1,"ng-template",null,0,ss),O()()()(),x(12,"div",8)(13,"div",9)(14,"div",10),Je(15,t0,4,0,"div",11)(16,n0,2,0,"div",12)(17,r0,54,5,"div",12),O(),Je(18,i0,2,0,"div",13),O()()),t&2){let i=rs(11);X(6),_e("routerLink",yd(7,XT)),X(3),_e("ngIf",!(r.auth.currentUser!=null&&r.auth.currentUser.email))("ngIfElse",i),X(6),_e("ngIf",r.cargando),X(),_e("ngIf",r.isChildActive&&!r.cargando),X(),_e("ngIf",!r.isChildActive),X(),Br(r.chat?18:-1)}},dependencies:[Mn,as,cs,Nd,Mo],styles:["div[_ngcontent-%COMP%]{--fondo: #3F3F43;--colorBoton: rgb(112, 230, 112);--colorBotonHover:green}nav[_ngcontent-%COMP%]{background-color:var(--fondo);height:80px}.div-botones[_ngcontent-%COMP%]{width:250px;justify-content:space-between}.btn[_ngcontent-%COMP%]{background:var(--colorBoton);border:none;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus{background:var(--colorBotonHover)}.texto-blanco[_ngcontent-%COMP%]{color:#fff}.silkscreen-regular[_ngcontent-%COMP%]{font-family:Silkscreen,sans-serif;font-weight:400;font-style:normal}.boton[_ngcontent-%COMP%]{width:70px;height:40px}.div-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.card[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}.card-body[_ngcontent-%COMP%]{padding-bottom:50px}.contenedor-fijo[_ngcontent-%COMP%]{width:220px;height:450px;overflow:hidden;border:1px solid #ddd;position:relative}.contenedor-fijo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:60%}.contenedor-chat[_ngcontent-%COMP%]{width:300px;height:auto;background-color:var(--fondo);color:#fff}"]})};function s0(n,e){n&1&&(x(0,"div",9)(1,"div",10)(2,"span",11),q(3,"Cargando..."),O()()())}function o0(n,e){if(n&1){let t=ns();x(0,"div",12)(1,"div",13)(2,"div",14)(3,"div")(4,"div",15)(5,"h2",16),q(6,"Ingresar usuario"),O(),de(7,"img",17),O(),x(8,"div",18)(9,"div")(10,"input",19),Vt("ngModelChange",function(i){Rt(t);let s=Ve();return Nt(s.userMail,i)||(s.userMail=i),Pt(i)}),O()(),x(11,"div")(12,"input",20),Vt("ngModelChange",function(i){Rt(t);let s=Ve();return Nt(s.userPWD,i)||(s.userPWD=i),Pt(i)}),O()(),x(13,"div")(14,"button",21),qe("click",function(){Rt(t);let i=Ve();return Pt(i.Login())}),q(15,"Login"),O()(),x(16,"div")(17,"button",21),qe("click",function(){Rt(t);let i=Ve();return Pt(i.AccesoRapido())}),q(18,"Acceso Rapido"),O()()()()()()()}if(n&2){let t=Ve();X(10),kt("ngModel",t.userMail),X(2),kt("ngModel",t.userPWD)}}var Uo=class n{constructor(e,t,r){this.router=e;this.auth=t;this.loginsReg=r;setTimeout(()=>{this.cargando=!1},2e3)}title="Login";userMail="";userPWD="";loggedUser="";cargando=!0;ngOnInit(){setTimeout(()=>{this.cargando=!1},3e3)}Login(){cp(this.auth,this.userMail,this.userPWD).then(e=>{e.user.email!==null&&(this.loggedUser=e.user.email),this.loginsReg.LoginReg(this.loggedUser),this.loginsReg.GetDataReg(),this.router.navigate(["/home"])}).catch(e=>{switch(e.code){case"auth/invalid-credential":this.toastCredenciales();break;case"auth/email-already-in-use":break;case"auth/invalid-email":this.toastEmail();break;default:this.toastDefault();break}})}CloseSession(){Os(this.auth).then(()=>{this.router.navigate(["/home"])})}toastCredenciales(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="Email o contrase\xF1a incorrectos",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastEmail(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="El usuario debe ser de tipo e-mal",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastDefault(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="No fue posible logearse",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}AccesoRapido(){this.userMail="lolo@gmail.com",this.userPWD="123321"}static \u0275fac=function(t){return new(t||n)(Z(xt),Z(Oe),Z(Jt))};static \u0275cmp=je({type:n,selectors:[["app-login"]],standalone:!0,features:[$e],decls:12,vars:2,consts:[["elseBlock",""],[1,"contenedor","position-relative"],["class","spinner-overlay",4,"ngIf","ngIfElse"],["id","miTostada","role","alert","aria-live","assertive","aria-atomic","true",1,"toast",2,"position","absolute","top","20px","right","20px"],[1,"toast-header"],["src","../../../assets/img/admiracion.png","alt","...",1,"rounded","me-2"],[1,"me-auto"],["type","button","data-bs-dismiss","toast","aria-label","Close",1,"btn-close"],[1,"toast-body"],[1,"spinner-overlay"],["role","status",1,"spinner-border","text-succes"],[1,"visually-hidden"],[1,"d-flex","justify-content-center"],[1,"row","login","inner-content"],[1,"col"],[1,"container","d-flex","justify-content-between","mt-5","mb-4"],[1,"text-left","texto-blanco"],["src","assets/img/logo.png","alt","logo",1,"logo"],[1,"d-grid","gap-3"],["placeholder","Usuario - Email","type","email","required","",1,"form-control","my-2",3,"ngModelChange","ngModel"],["required","","placeholder","Contrase\xF1a","type","password",1,"form-control","my-2",3,"ngModelChange","ngModel"],[1,"btn","form-control","mb-5","texto-blanco",3,"click"]],template:function(t,r){if(t&1&&(x(0,"div",1),Je(1,s0,4,0,"div",2)(2,o0,19,2,"ng-template",null,0,ss),O(),x(4,"div",3)(5,"div",4),de(6,"img",5),x(7,"strong",6),q(8,"Atencion!"),O(),de(9,"button",7),O(),x(10,"div",8),q(11," Hello, world! This is a toast message. "),O()()),t&2){let i=rs(3);X(),_e("ngIf",r.cargando)("ngIfElse",i)}},dependencies:[Qn,$t,Kn,ai,pn,Mn,as],styles:["div[_ngcontent-%COMP%]{--fondo: #3F3F43;--colorBoton: rgb(112, 230, 112);--colorBotonHover:green}.texto-blanco[_ngcontent-%COMP%]{color:#fff;font-family:Gothic A1,sans-serif;font-weight:800;font-style:normal}.logo[_ngcontent-%COMP%]{height:30px;width:40px;margin-top:7px}.login[_ngcontent-%COMP%]{background-color:var(--fondo);border-radius:10px;box-shadow:0 0 10px #0000001a;margin-top:3rem;margin-bottom:3rem}.btn[_ngcontent-%COMP%]{background:var(--colorBoton);border:none;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus{background:var(--colorBotonHover)}input[_ngcontent-%COMP%]:focus{border-color:green;outline:none}.gothic-a1-extrabold[_ngcontent-%COMP%]{font-family:Gothic A1,sans-serif;font-weight:800;font-style:normal}.inner-content[_ngcontent-%COMP%]{max-width:450px;width:100%}.spinner-overlay[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1000;display:flex;justify-content:center;align-items:center;width:100%;height:100%}.contenedor[_ngcontent-%COMP%]{position:relative;width:100%;height:calc(100vh - 150px)}"]})};function a0(n,e){if(n&1&&(x(0,"h2",11),q(1),O()),n&2){let t=Ve();X(),On("Usuario registrado: ",t.loggedUser,"")}}function c0(n,e){if(n&1&&(x(0,"p",11),q(1),O()),n&2){let t=Ve();X(),gd(t.msjError)}}var Bo=class n{constructor(e,t,r){this.auth=e;this.router=t;this.loginsReg=r}newUserMail="";newUserPWD="";loggedUser="";flagError=!1;msjError="";small="";strong="";Register(){op(this.auth,this.newUserMail,this.newUserPWD).then(e=>{e.user.email!==null&&(this.loggedUser=e.user.email),this.flagError=!1,this.loginsReg.LoginReg(this.loggedUser),this.router.navigate(["/home"])}).catch(e=>{switch(this.flagError=!0,e.code){case"auth/invalid-email":this.toastEmailInvalido();break;case"auth/email-already-in-use":this.toastEmailYaEnUso();break;case"auth/weak-password":this.toastPassword();break;default:this.toastDefault();break}})}toastEmailYaEnUso(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="Email ya en uso",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastEmailInvalido(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="El usuario debe ser un Email",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastPassword(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="El password debe tener al menos 6 caracteres",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}toastDefault(){var e=document.getElementById("miTostada");if(e!=null){console.log(e);let r=e.querySelector(".toast-body");r.textContent="No fue posible registrar la cuenta",console.log(r.textContent);var t=new bootstrap.Toast(e);t.show()}}showToast(){var e=document.getElementById("miTostada"),t=new bootstrap.Toast(e);t.show()}static \u0275fac=function(t){return new(t||n)(Z(Oe),Z(xt),Z(Jt))};static \u0275cmp=je({type:n,selectors:[["app-registro"]],standalone:!0,features:[$e],decls:27,vars:4,consts:[[1,"d-flex","justify-content-center"],[1,"row","login","inner-content"],[1,"col"],[1,"container","d-flex","justify-content-between","mt-5","mb-4"],[1,"text-center","texto-blanco"],["src","assets/img/logo.png","alt","logo",1,"logo"],[1,"d-grid","gap-3"],["placeholder","Usuario - Email",1,"form-control","my-2",3,"ngModelChange","ngModel"],["required","","placeholder","Contrase\xF1a",1,"form-control","my-2",3,"ngModelChange","ngModel"],[1,"d-grid","gap-2"],[1,"btn","form-control","mb-5","texto-blanco",3,"click"],[1,"text-center","text-primary"],["id","miTostada","role","alert","aria-live","assertive","aria-atomic","true",1,"toast",2,"position","absolute","top","20px","right","20px"],[1,"toast-header"],["src","../../../assets/img/admiracion.png","alt","...",1,"rounded","me-2"],[1,"me-auto"],["type","button","data-bs-dismiss","toast","aria-label","Close",1,"btn-close"],[1,"toast-body"]],template:function(t,r){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"h2",4),q(6,"Registrar usuario"),O(),de(7,"img",5),O(),x(8,"div",6)(9,"div")(10,"input",7),Vt("ngModelChange",function(s){return Nt(r.newUserMail,s)||(r.newUserMail=s),s}),O()(),x(11,"div")(12,"input",8),Vt("ngModelChange",function(s){return Nt(r.newUserPWD,s)||(r.newUserPWD=s),s}),O()(),x(13,"div")(14,"div",9)(15,"button",10),qe("click",function(){return r.Register()}),q(16,"Registrarse"),O()(),Je(17,a0,2,1,"h2",11)(18,c0,2,1,"p",11),O()()()()()(),x(19,"div",12)(20,"div",13),de(21,"img",14),x(22,"strong",15),q(23,"Atencion!"),O(),de(24,"button",16),O(),x(25,"div",17),q(26," Hello, world! This is a toast message. "),O()()),t&2&&(X(10),kt("ngModel",r.newUserMail),X(2),kt("ngModel",r.newUserPWD),X(5),Br(r.loggedUser!=""?17:-1),X(),Br(r.flagError?18:-1))},dependencies:[Qn,$t,Kn,ai,pn],styles:["div[_ngcontent-%COMP%]{--fondo: #3F3F43;--colorBoton: rgb(112, 230, 112);--colorBotonHover:green}.texto-blanco[_ngcontent-%COMP%]{color:#fff;font-family:Gothic A1,sans-serif;font-weight:800;font-style:normal}.logo[_ngcontent-%COMP%]{height:30px;width:40px;margin-top:7px}.login[_ngcontent-%COMP%]{background-color:var(--fondo);border-radius:10px;box-shadow:0 0 10px #0000001a;margin-top:3rem;margin-bottom:3rem}.btn[_ngcontent-%COMP%]{background:var(--colorBoton);border:none;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus{background:var(--colorBotonHover)}input[_ngcontent-%COMP%]:focus{border-color:green;outline:none}.inner-content[_ngcontent-%COMP%]{max-width:450px;width:100%}.img-toas[_ngcontent-%COMP%]{width:10px;height:10px}"]})};var jo=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=je({type:n,selectors:[["app-page-not-found"]],standalone:!0,features:[$e],decls:2,vars:0,template:function(t,r){t&1&&(x(0,"p"),q(1,"page-not-found works!"),O())}})};var Vg=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home/juegos",redirectTo:"/home",pathMatch:"full"},{path:"home",component:Lo,children:[{path:"login",component:Uo},{path:"registro",component:Bo},{path:"juegos",loadChildren:()=>import("./chunk-LZS7MXRF.js").then(n=>n.JuegosModule)}]},{path:"**",component:jo}];var xg={projectId:"saladejuegos-f162c",appId:"1:427218264835:web:a5a676bfcd8bba0b83bf36",storageBucket:"saladejuegos-f162c.appspot.com",apiKey:"AIzaSyBUvgRVekAkiMeQF-S55lTfwjXw5JEkoeo",authDomain:"saladejuegos-f162c.firebaseapp.com",messagingSenderId:"427218264835"};var Og={providers:[Td({eventCoalescing:!0}),Vd(Vg),cf(()=>uf(xg)),sp(()=>ap()),Rg(()=>Pg()),Sd()]};var yr=class{nombre;clave;constructor(e,t){this.nombre=e,this.clave=t}};var qo=class n{constructor(e){this.router=e}title="Sala de Juegos";usuario1=new yr("juan","1234");usuario2=new yr("pedro","1234");usuario3=new yr("laura","1234");ngOnInit(){this.guardarUsuarios()}guardarUsuarios(){let e=[this.usuario1,this.usuario2,this.usuario3],t=JSON.stringify(e);localStorage.setItem("usuarios",t)}static \u0275fac=function(t){return new(t||n)(Z(xt))};static \u0275cmp=je({type:n,selectors:[["app-root"]],standalone:!0,features:[$e],decls:2,vars:0,template:function(t,r){t&1&&(x(0,"div"),de(1,"router-outlet"),O())},dependencies:[cs],styles:["[_nghost-%COMP%]{display:block;min-height:100vh;background-color:#bbb;margin:0;width:100%}[_ngcontent-%COMP%]:root{--colorFondo: rgb(187, 187, 187)}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100%}"]})};Rd(qo,Og).catch(n=>console.error(n));
